<!DOCTYPE html><!--  Professional Calendar Booking Page  -->
<html data-wf-page="686bac2b4d1341d4cca18e08" data-wf-site="686bac2b4d1341d4cca18daf" lang="en">
<head>
  <meta charset="utf-8">
  <title>Book Your Strategy Session - AI Automation Consultation</title>
  <meta content="Book your personalized 30-minute AI automation strategy session. Let's map your highest-impact automations together." name="description">
  <meta content="Book Your Strategy Session - AI Automation Consultation" property="og:title">
  <meta content="Book your personalized 30-minute AI automation strategy session. Let's map your highest-impact automations together." property="og:description">
  <meta content="Book Your Strategy Session - AI Automation Consultation" property="twitter:title">
  <meta content="Book your personalized 30-minute AI automation strategy session. Let's map your highest-impact automations together." property="twitter:description">
  <meta property="og:type" content="website">
  <meta content="summary_large_image" name="twitter:card">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/phuns-fresh-site.webflow.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="apple-touch-icon.png" rel="apple-touch-icon">
  <link rel="manifest" href="/manifest.json">
  <!-- Mobile Overflow Fixes -->
  <link href="css/mobile-fixes.css" rel="stylesheet" type="text/css">
  
  <!-- Custom Video Player Styles -->
  
  <!-- Removed iframe-resizer due to license requirements -->
  
  <!-- Performance: Preload Cal.com resources -->
  <link rel="preload" href="https://app.cal.com/embed/embed.js" as="script">
  <link rel="dns-prefetch" href="https://app.cal.com">
  <link rel="preconnect" href="https://app.cal.com">
  
  <!-- Video.js Professional Video Player -->
  <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
  <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
  
  <!-- Cal.com embed script with immediate setup -->
  <script type="text/javascript">
    (function (C, A, L) { let p = function (a, ar) { a.q.push(ar); }; let d = C.document; C.Cal = C.Cal || function () { let cal = C.Cal; let ar = arguments; if (!cal.loaded) { cal.ns = {}; cal.q = cal.q || []; d.head.appendChild(d.createElement("script")).src = A; cal.loaded = true; } if (ar[0] === L) { const api = function () { p(api, arguments); }; const namespace = ar[1]; api.q = api.q || []; if(typeof namespace === "string"){cal.ns[namespace] = cal.ns[namespace] || api;p(cal.ns[namespace], ar);p(cal, ["initNamespace", namespace]);} else p(cal, ar); return;} p(cal, ar); }; })(window, "https://app.cal.com/embed/embed.js", "init");
    
    // Cal.com loader ready - initialization happens in DOMContentLoaded for proper timing
  </script>
  
  <style>
    /* Calendar Page Design */
    :root {
      /* CORRECTED: Use actual main site background color #0f0f0f */
      --primary-black: #0f0f0f; /* Match main site dark grey background */
      --white: white;
      --border: #b4b4b414;
      --grey: #b4b4b4;
      --dark: #0f0f0f;
      --secondary-black: #0f0f0f;
    }
    
    * {
      box-sizing: border-box;
      -webkit-text-stroke: unset !important;
      text-stroke: unset !important;
    }

    /* Remove unwanted text effects globally */
    ::selection {
      background: rgba(59, 130, 246, 0.2) !important;
      color: inherit !important;
      -webkit-text-stroke: none !important;
    }

    ::-moz-selection {
      background: rgba(59, 130, 246, 0.2) !important;
      color: inherit !important;
    }
    
    /* PHONE INPUT CURSOR FIX: Force I-beam cursor consistently */
    #phoneInput,
    input[type="tel"]#phoneInput {
      cursor: text !important;
    }
    
    #phoneInput:hover,
    #phoneInput:focus,
    #phoneInput:active {
      cursor: text !important;
    }
    
    /* Ensure parent containers don't override cursor */
    #phoneFormContainer,
    #phoneComponentContainer {
      cursor: default !important;
    }
    
    /* DEFENSIVE PROGRAMMING: Ensure interactions work even if JS fails */
    #phoneComponentContainer.form-active,
    #phoneComponentContainer:hover,
    #phoneFormContainer[style*="opacity: 1"] {
      pointer-events: auto !important;
    }
    
    #phoneInput,
    #callButton {
      pointer-events: auto !important;
    }
    
    /* Enhanced button interaction states */
    #callButton:hover {
      cursor: pointer !important;
      opacity: 0.8 !important;
    }
    
    /* Form container activation states */
    #phoneFormContainer[style*="opacity: 1"] #phoneInput {
      cursor: text !important;
    }
    
    /* ENHANCED: Professional confirmation page reload persistence */
    body.confirmation-loading {
      /* Prevent flash of calendar content during confirmation restoration */
      overflow: hidden;
    }
    
    body.confirmation-loading #my-cal-inline-30min,
    body.confirmation-loading .calendar-container {
      /* Hide calendar content during restoration to prevent flash */
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.1s ease;
    }
    
    body.confirmation-loading::before {
      /* Professional loading overlay during restoration */
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--primary-black);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    body.confirmation-loading::after {
      /* Loading indicator */
      content: 'Restoring your session...';
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: var(--white);
      font-size: 1.1rem;
      font-weight: 500;
      z-index: 10000;
      opacity: 0;
      animation: fadeInLoading 0.3s ease 0.1s forwards;
    }
    
    @keyframes fadeInLoading {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) translateY(10px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) translateY(0);
      }
    }
    
    html {
      overflow-x: hidden;
      overflow-y: auto;
    }
    
    body {
      font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      background-color: var(--primary-black);
      color: var(--white);
      line-height: 1.5;
      overflow-x: hidden;
      overflow-y: auto;
    }
    
    .page-wrapper {
      min-height: 100vh;
      background-color: var(--primary-black);
      overflow: visible;
    }
    
    /* Header Section */
    .calendar-header {
      text-align: center;
      padding: 4rem 0 2rem 0;
      background-color: var(--primary-black); /* Match site background */
    }
    
    .calendar-header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin: 0 0 1rem 0;
      color: var(--white);
      letter-spacing: -0.02em;
    }
    
    .calendar-header p {
      font-size: 1.1rem;
      color: var(--grey);
      margin: 0;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    
    /* Progress Indicator */
    .progress-indicator {
      text-align: center;
      padding: 1rem 0 2rem 0;
    }
    
    .progress-steps {
      display: inline-flex;
      align-items: center;
      gap: 1rem;
    }
    
    .progress-step {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .step-circle {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      color: var(--grey);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
      border: 2px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
    }
    
    .step-circle.completed {
      background: var(--white) !important;
      color: var(--primary-black) !important;
      border: 2px solid var(--white) !important;
      box-shadow: 0 2px 8px rgba(255, 255, 255, 0.3);
      font-size: 0.9rem;
      font-weight: 700;
    }
    
    .step-circle:not(.completed) {
      background: rgba(255, 255, 255, 0.8);
      color: var(--primary-black);
      border: 2px solid rgba(255, 255, 255, 0.9);
    }
    
    /* Active progress step styling - fixed to show white circles */
    .progress-step.active .step-circle {
      background: var(--white) !important;
      color: var(--primary-black) !important;
      border: 2px solid var(--white) !important;
    }
    
    /* Progress step active state consistency */
    .progress-step.active .progress-step-circle {
      background: var(--white) !important;
      border-color: var(--white) !important;
      color: var(--primary-black) !important;
    }
    
    .step-text {
      font-size: 0.9rem;
      color: var(--grey);
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .progress-step:has(.step-circle.completed) .step-text {
      color: var(--white) !important;
      font-weight: 600;
    }
    
    .progress-step:has(.step-circle:not(.completed)) .step-text {
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
    }
    
    .step-divider {
      width: 40px;
      height: 2px;
      background: var(--grey); /* Match subtext color */
      border-radius: 1px;
      transition: all 0.2s ease;
    }
    
    .progress-steps:hover .step-divider {
      background: var(--grey); /* Keep consistent grey on hover */
    }
    
    /* Calendar Container - Professional Design */
    .calendar-container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      padding: 0 1rem 2rem 1rem;
      background-color: var(--primary-black); /* Match site background */
    }
    
    /* Personalized Message Section */
    .personalized-message {
      text-align: center;
      padding: 0.5rem 0 1rem 0; /* Reduced top padding */
    }
    
    .personalized-text {
      font-size: 1.1rem;
      color: var(--grey);
      margin: 0 0 1.5rem 0; /* Reduced bottom margin */
      font-weight: 400;
    }
    
    .calendar-divider {
      width: 100px;
      height: 1px;
      background: var(--border);
      margin: 0 auto 0.375rem auto; /* Tighter spacing between divider and calendar */
    }
    
    /* Modern Container-Free Cal.com Architecture - 2024 Best Practice */
    .cal-modern-embed {
      width: 100%;
      background: var(--primary-black);
    }
    
    /* Modern responsive iframe with CSS aspect-ratio */
    .cal-modern-embed iframe {
      width: 100%;
      border: none;
      background: var(--primary-black);
      display: block;
    }
    
    /* Mobile: 4:3 aspect ratio for optimal mobile viewing */
    @media (max-width: 767px) {
      .cal-modern-embed iframe {
        aspect-ratio: 4 / 3;
      }
      
      /* Mobile alignment fix */
      .calendar-container {
        padding: 0 0.5rem 2rem 0.5rem;
        max-width: 100%;
        overflow-x: hidden;
      }
      
      #my-cal-inline-30min {
        width: 100% !important;
        max-width: 100vw !important;
        margin: 0 auto !important;
        padding: 0 !important;
      }
      
      .cal-modern-embed {
        width: 100% !important;
        max-width: 100% !important;
        overflow: hidden;
      }
    }
    
    /* Tablet: 16:10 aspect ratio for tablet viewing */
    @media (min-width: 768px) and (max-width: 1023px) {
      .cal-modern-embed iframe {
        aspect-ratio: 16 / 10;
      }
    }
    
    /* Desktop: 16:9 aspect ratio for desktop viewing */
    @media (min-width: 1024px) {
      .cal-modern-embed iframe {
        aspect-ratio: 16 / 9;
      }
    }
    
    
    /* Aggressively hide ALL Cal.com branding */
    [data-cal-namespace] [class*="cal-com"],
    [data-cal-namespace] [class*="powered"],
    [data-cal-namespace] [class*="branding"],
    [data-cal-namespace] footer,
    [data-cal-namespace] [href*="cal.com"],
    #my-cal-inline-30min [class*="powered-by"],
    #my-cal-inline-30min [class*="branding"],
    #my-cal-inline-30min footer,
    .cal-powered-by,
    .cal-branding,
    a[href*="cal.com"]:not([href*="app.cal.com"]),
    /* Target specific confirmation page branding */
    [data-cal-namespace] [class*="create-your-own"],
    [data-cal-namespace] [class*="try-it-free"],
    [data-cal-namespace] [class*="promotional"],
    #my-cal-inline-30min [href*="cal.com/signup"],
    #my-cal-inline-30min [href*="cal.com"][target="_blank"],
    /* Target parent containers of Cal.com links */
    div:has(> a[href*="cal.com"]),
    p:has(> a[href*="cal.com"]),
    /* Target the specific text on confirmation */
    *:has-text("Create your own booking link"),
    *:has-text("Try it for free") {
      display: none !important;
      visibility: hidden !important;
      height: 0 !important;
      overflow: hidden !important;
      margin: 0 !important;
      padding: 0 !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    /* REMOVED: Let Cal.com handle color-scheme internally */
    
    /* Professional Cal.com Container - Consolidated Styling */
    #my-cal-inline-30min {
      width: 100% !important;
      max-width: 100% !important;
      font-family: inherit;
      border-radius: 8px;
      overflow: hidden;
      background-color: var(--primary-black) !important;
    }
    
    /* REMOVED AGGRESSIVE OVERRIDES: Let Cal.com handle its own internal styling */
    /* Only fixing the white container background issue with surgical approach */
    
    /* MINIMAL CAL.COM OVERRIDE - Using Official Theming */
    /* Only target container background for consistency */
    #my-cal-inline-30min {
      background-color: var(--primary-black) !important;
    }
    
    /* Ensure Cal.com container matches site background */
    #my-cal-inline-30min > div:first-child {
      background-color: var(--primary-black) !important;
    }
    
    /* CUSTOM LOADING SCREEN - Replaces Cal.com Blue Redirect */
    .custom-loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-black);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    .custom-loading-overlay.active {
      display: flex;
    }
    
    /* Professional Site-Matching Spinner */
    .custom-loading-spinner {
      width: 60px;
      height: 60px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-top: 2px solid var(--white);
      border-radius: 50%;
      animation: customSpin 1s linear infinite;
      margin-bottom: 2rem;
      position: relative;
    }
    
    .custom-loading-spinner::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 50%;
      animation: customPulse 2s ease-in-out infinite;
    }
    
    @keyframes customSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes customPulse {
      0%, 100% { 
        opacity: 0.3; 
        transform: scale(1); 
      }
      50% { 
        opacity: 1; 
        transform: scale(1.05); 
      }
    }
    
    .custom-loading-text {
      color: var(--white);
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      letter-spacing: -0.01em;
    }
    
    .custom-loading-subtitle {
      color: var(--grey);
      font-size: 1rem;
      font-weight: 400;
      text-align: center;
      max-width: 400px;
      line-height: 1.5;
    }
    
    /* Fade transitions for smooth UX */
    .custom-loading-overlay {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    
    .custom-loading-overlay.active {
      opacity: 1;
    }
    
    /* LEGACY: Keep original loading container for fallback */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 580px;
      width: 100%;
      color: var(--grey);
      background: var(--primary-black); /* Match main site black background */
      border-radius: 8px;
      position: relative;
      overflow: hidden;
    }
    
    /* Premium Loading Spinner */
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 3px solid var(--border);
      border-top: 3px solid var(--white);
      border-radius: 50%;
      animation: spin 1.2s linear infinite;
      margin-bottom: 2rem;
      position: relative;
    }
    
    .loading-spinner::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }
    
    /* Calendar Skeleton Placeholder */
    .calendar-skeleton {
      width: 100%;
      max-width: 800px;
      margin: 2rem auto;
      background: var(--primary-black);
      border-radius: 12px;
      padding: 2rem;
      display: none; /* Show after initial spinner */
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .skeleton-header {
      height: 40px;
      background: linear-gradient(90deg, #404040 25%, #505050 50%, #404040 75%);
      border-radius: 8px;
      margin-bottom: 2rem;
      animation: shimmer 2.5s infinite;
      position: relative;
    }
    
    .skeleton-header::after {
      content: '';
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      width: 30px;
      height: 20px;
      background: linear-gradient(90deg, #303030 25%, #404040 50%, #303030 75%);
      border-radius: 4px;
      animation: shimmer 2.5s infinite 0.2s;
    }
    
    .skeleton-calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 12px;
      margin-bottom: 3rem;
    }
    
    .skeleton-day {
      height: 45px;
      background: linear-gradient(90deg, #3a3a3a 25%, #4a4a4a 50%, #3a3a3a 75%);
      border-radius: 8px;
      animation: shimmer 2.5s infinite;
      position: relative;
    }
    
    .skeleton-day:nth-child(odd) { animation-delay: 0.1s; }
    .skeleton-day:nth-child(even) { animation-delay: 0.2s; }
    
    .skeleton-day.available {
      background: linear-gradient(90deg, #1a5f3a 25%, #2a7f4a 50%, #1a5f3a 75%);
      animation: shimmer 2.5s infinite 0.3s;
    }
    
    /* Professional Custom Video Player */
    .professional-video-container {
      position: relative;
      width: 100%;
      max-width: 900px; /* Professional laptop-friendly size */
      margin: 0 auto 3rem;
      /* Remove aspect-ratio to let child container control dimensions */
      background: transparent;
      border-radius: 12px;
      overflow: hidden;
    }
    
    .video-poster-wrapper {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      border-radius: 12px;
      overflow: hidden;
      background: transparent;
      border: 2px solid rgba(255, 255, 255, 0.15);
      box-shadow: 
        0 12px 40px rgba(0, 0, 0, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    .video-poster {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .video-poster:hover {
      /* Remove excessive scaling animation */
    }
    
    .video-poster-content {
      text-align: center;
      margin-bottom: 2rem;
      z-index: 2;
      position: relative;
    }
    
    .video-title {
      font-size: 2rem;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 0.5rem;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    .video-subtitle {
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.7);
      font-weight: 400;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    /* UPDATED: Lower specificity definition - should be overridden by high-specificity version */
    .video-play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.4);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    
    /* CONSOLIDATED: Professional Play Button - Apple/Vercel Style */
    .video-poster .professional-play-button {
      width: 80px !important;
      height: 80px !important;
      border-radius: 50% !important;
      background: rgba(255, 255, 255, 1) !important;
      border: none !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4), 0 0 0 0 rgba(255, 255, 255, 0.4) !important;
      position: relative !important;
      z-index: 10 !important;
      outline: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
    }
    
    .video-poster .professional-play-button:focus,
    .video-poster .professional-play-button:active {
      outline: none !important;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4) !important;
    }
    
    .video-poster .professional-play-button:hover {
      transform: scale(1.05) !important;
      background: rgba(255, 255, 255, 1) !important;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5), 0 0 0 4px rgba(255, 255, 255, 0.2) !important;
    }
    
    .video-poster .professional-play-button:active {
      transform: scale(1.02) !important;
    }
    
    /* Unicode Play Symbol - Bulletproof Rendering */
    .play-symbol {
      font-size: 24px !important;
      color: #2d2d2d !important;
      font-weight: normal !important;
      line-height: 1 !important;
      margin-left: 3px; /* Optical adjustment for play symbol */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
      -webkit-font-smoothing: antialiased !important;
      text-rendering: optimizeLegibility !important;
    }
    
    .hidden-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
      z-index: 5;
      display: none;
    }
    
    .hidden-video.playing {
      display: block;
    }
    
    /* Professional HTML5 Video Controls Styling */
    
    .replay-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.7);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 15;
    }
    
    .replay-overlay.visible {
      opacity: 1;
      pointer-events: auto;
    }
    
    .replay-button {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .replay-button:hover {
      transform: scale(1.1);
      background: rgba(255, 255, 255, 1);
    }
    
    .replay-icon {
      width: 32px;
      height: 32px;
      color: #333;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .video-title {
        font-size: 1.5rem;
      }
      
      .video-subtitle {
        font-size: 0.9rem;
      }
      
      .video-poster .professional-play-button {
        width: 80px !important;
        height: 80px !important;
      }
      
      .play-symbol {
        font-size: 20px !important;
      }
      
      .play-icon {
        width: 24px;
        height: 24px;
      }
    }
    
    /* Week Days Header */
    .skeleton-weekday {
      height: 20px;
      background: linear-gradient(90deg, #303030 25%, #404040 50%, #303030 75%);
      border-radius: 4px;
      animation: shimmer 2.5s infinite;
      margin-bottom: 10px;
    }
    
    .skeleton-times {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin-bottom: 2rem;
    }
    
    .skeleton-time {
      height: 44px;
      background: linear-gradient(90deg, #2a4a2a 25%, #3a5a3a 50%, #2a4a2a 75%);
      border-radius: 8px;
      animation: shimmer 2.5s infinite;
      position: relative;
    }
    
    .skeleton-time:nth-child(1) { animation-delay: 0.1s; }
    .skeleton-time:nth-child(2) { animation-delay: 0.2s; }
    .skeleton-time:nth-child(3) { animation-delay: 0.3s; }
    .skeleton-time:nth-child(4) { animation-delay: 0.4s; }
    .skeleton-time:nth-child(5) { animation-delay: 0.5s; }
    .skeleton-time:nth-child(6) { animation-delay: 0.6s; }
    
    @keyframes shimmer {
      0% {
        background-position: -200px 0;
      }
      100% {
        background-position: calc(200px + 100%) 0;
      }
    }
    
    /* Professional Confirmation Section - Matches Homepage Style */
    .confirmation-container {
      text-align: center;
      padding: 4rem 2rem; /* Reduced from 8rem for better top spacing */
      min-height: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f0f0f; /* Match site background */
      margin: 0;
    }
    
    .confirmation-success-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(74, 222, 128, 0.1);
      color: #4ade80;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 2rem;
      border: 1px solid rgba(74, 222, 128, 0.2);
    }
    
    .confirmation-heading {
      font-size: clamp(2.5rem, 5vw, 3.5rem);
      margin-bottom: 1.5rem;
      color: #ffffff;
      font-weight: 600;
      letter-spacing: -0.02em;
      line-height: 1.1;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
    }
    
    .confirmation-tagline {
      font-size: 1.25rem;
      color: #b4b4b4;
      margin-bottom: 3rem; /* Increased from 2rem for better spacing before step 1 */
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
      font-weight: 300;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .confirmation-message {
      font-size: 1.1rem;
      color: #ffffff;
      margin-bottom: 3rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
      font-weight: 400;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .confirmation-button {
      display: inline-block;
      padding: 1rem 3rem;
      background: var(--white);
      color: var(--primary-black);
      text-decoration: none;
      border: 2px solid var(--white);
      border-radius: 0;
      font-weight: 600;
      font-size: 14px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: all 0.3s ease;
      cursor: pointer;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    .confirmation-button:hover {
      background: transparent;
      color: var(--white);
    }
    
    /* Section Dividers */
    .section-divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      margin: 2.5rem auto;
      width: 100%;
      max-width: 600px;
    }
    
    /* Mobile spacing reduction */
    @media (max-width: 767px) {
      .section-divider {
        margin: 1.5rem auto;
      }
      
      /* Reduce spacing between confirmation sections on mobile */
      .confirmation-container {
        padding: 2.5rem 1.5rem; /* Reduced further for mobile proportions */
      }
      
      
      .ai-supporting-text {
        margin: 0.75rem 0 !important; /* Tighter mobile spacing */
        font-size: 0.85rem;
      }
    }
    
    @media (max-width: 479px) {
      .section-divider {
        margin: 1rem auto; /* Even tighter on very small screens */
      }
      
      .confirmation-container {
        padding: 2rem 1rem; /* Even more compact for very small screens */
      }
      
      .ai-supporting-text {
        margin: 0.5rem 0 !important; /* Very tight mobile spacing */
        font-size: 0.8rem;
      }
    }
    
    
    .confirmation-video h3 {
      font-size: 1.375rem;
      margin-bottom: 0;
      color: var(--white);
      font-weight: 600;
    }
    
    .video-wrapper {
      max-width: 900px; /* Professional laptop-friendly size */
      margin: 0 auto;
      position: relative;
      background: transparent;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      /* Use aspect-ratio instead of padding hack */
      aspect-ratio: 16 / 9;
    }
    
    /* Fallback for older browsers */
    @supports not (aspect-ratio: 16 / 9) {
      .video-wrapper {
        padding-bottom: 56.25%;
        height: 0;
      }
    }
    
    .video-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #202020;
      color: var(--grey);
      font-style: italic;
    }
    
    /* Video player styling - enhanced visibility and professional appearance */
    #confirmation-video-player {
      width: 100%;
      max-width: 900px; /* Professional laptop-friendly size */
      height: auto;
      min-height: 400px; /* More proportional minimum height */
      display: block;
      object-fit: cover;
      background: transparent;
      border-radius: 12px;
      margin: 0 auto; /* Center the video */
    }
    
    #confirmation-video-player:hover {
      filter: brightness(1.02);
    }
    
    /* Professional video thumbnail styling - ENHANCED */
    #confirmation-video-player[poster] {
      background-size: cover !important;
      background-position: center !important;
      background-repeat: no-repeat !important;
    }
    
    /* Force poster visibility while loading */
    #confirmation-video-player {
      background-color: #0f0f0f; /* Site background while loading */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    /* Ensure video shows poster immediately on load */
    #confirmation-video-player:not([src]) {
      background-color: #0f0f0f !important;
    }
    
    /* Clean video wrapper - minimalistic design */
    .video-wrapper {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      background: #202020;
    }
    
    /* UPDATED: Another lower specificity definition - should be overridden */
    .video-play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.4);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
      opacity: 1;
    }
    
    
    .video-play-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    /* Clean, simple play button */
    .video-play-button {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }
    
    
    /* Play triangle - Unicode Symbol (No Black Square Issues) */
    .video-play-button::after {
      content: 'â–¶';
      font-size: 24px;
      color: #2d2d2d;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin-left: 3px;
      line-height: 1;
      text-shadow: none;
      -webkit-text-stroke: none;
      text-stroke: none;
      display: inline-block;
      width: auto;
      height: auto;
      border: none;
    }
    
    /* ================================
       CLEAN VIDEO PLAYER STYLES
       ================================ */
    
    /* Parent Container Protection - Prevent Flex/Grid Interference */
    /* FIXED: Professional video container - Merge essential properties without breaking positioning */
    .professional-video-container {
      /* Core layout properties */
      position: relative !important;
      display: block !important;
      width: 100% !important;
      max-width: 1200px !important;
      margin: 0 auto 3rem !important;
      
      /* Background and visibility */
      background: transparent !important;
      background-color: transparent !important;
      opacity: 1 !important;
      visibility: visible !important;
      
      /* Shape and overflow */
      border-radius: 12px !important;
      overflow: hidden !important;
      
      /* Flex/grid protection */
      flex-shrink: 0 !important;
      flex-grow: 0 !important;
      align-self: stretch !important;
      justify-self: stretch !important;
    }
    
    /* Remove conflicting background styles - let the main definition handle it */
    
    /* FIXED: Allow video element to display poster properly */
    .main-video {
      /* Let browser handle video poster display naturally - no background override */
      object-fit: cover !important; /* Ensure video/poster fills container properly */
    }
    
    /* Don't add borders to text elements - but preserve overlay background */
    .professional-video-container p,
    .professional-video-container span,
    .professional-video-container button {
      border: none !important;
      box-shadow: none !important;
      background: transparent !important;
    }
    
    /* Allow video play overlay to maintain its dark background for visibility */
    .professional-video-container .video-play-overlay {
      border: none !important;
      box-shadow: none !important;
      /* Don't override background - let overlay styles handle it */
    }
    
    /* Professional Video Player Container - FIXED: High contrast background for visibility */
    .professional-video-player {
      position: relative !important;
      width: 100% !important;
      max-width: 1200px !important; /* Professional laptop-friendly size */
      height: 0 !important; /* Required for padding-top technique */
      padding-top: 56.25% !important; /* 16:9 aspect ratio (9/16 * 100) */
      margin: 0 auto !important;
      border-radius: 12px !important;
      overflow: hidden !important;
      /* FIXED: Use higher contrast background - more visible against page #0f0f0f */
      background: #2a2a2a !important;
      border: 1px solid rgba(255, 255, 255, 0.1) !important; /* Subtle border for definition */
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important;
      
      /* Force exact dimensions - no browser/extension override */
      max-height: none !important;
      min-height: unset !important;
      flex-grow: 0 !important;
      flex-shrink: 0 !important;
      /* NUCLEAR override for aspect ratio conflicts */
      aspect-ratio: unset !important;
      display: block !important;
      box-sizing: border-box !important;
    }
    
    /* Main Video Element - Force Fill Container Completely */
    .professional-video-player .main-video,
    .main-video {
      /* POSITIONING - Force absolute positioning */
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      
      /* DIMENSIONS - Force exact container fill */
      width: 100% !important;
      height: 100% !important;
      min-width: 100% !important;
      min-height: 100% !important;
      max-width: none !important;
      max-height: none !important;
      
      /* OBJECT FIT - Force video to fill completely */
      object-fit: cover !important;
      object-position: center center !important;
      
      /* DISPLAY - Force block display */
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      
      /* STYLING */
      border-radius: 12px !important;
      /* Let browser handle video poster display naturally - no background override */
      
      /* STEP 3: Professional Poster Image Styling */
      object-fit: cover !important; /* Ensures poster maintains aspect ratio */
      
      /* LAYERING */
      z-index: 1 !important;
      
      /* PREVENT SHRINKING */
      flex-shrink: 0 !important;
      flex-grow: 0 !important;
      
      /* FORCE DIMENSIONS */
      box-sizing: border-box !important;
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      outline: none !important;
    }
    
    /* FIXED: Maximum specificity permanent blur overlay */
    #professionalVideoPlayer .video-play-overlay,
    .professional-video-container .video-play-overlay,
    .video-play-overlay#videoPlayOverlay {
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100% !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
      background: rgba(0, 0, 0, 0.4) !important;
      /* Cross-browser backdrop-filter support */
      -webkit-backdrop-filter: blur(12px) !important;
      -moz-backdrop-filter: blur(12px) !important;
      -ms-backdrop-filter: blur(12px) !important;
      backdrop-filter: blur(12px) !important;
      transition: all 0.3s ease !important;
      cursor: pointer !important;
      border-radius: 12px !important;
      z-index: 20 !important;
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* CRITICAL: Override for hidden state - must hide overlay during video playback */
    #professionalVideoPlayer .video-play-overlay.hidden,
    .professional-video-container .video-play-overlay.hidden,
    .video-play-overlay#videoPlayOverlay.hidden,
    .video-play-overlay.hidden {
      opacity: 0 !important;
      visibility: hidden !important;
      pointer-events: none !important;
      display: none !important;
      z-index: -1 !important;
    }
    
    /* FALLBACK: For browsers that don't support backdrop-filter */
    @supports not (backdrop-filter: blur(12px)) {
      #professionalVideoPlayer .video-play-overlay::before,
      .professional-video-container .video-play-overlay::before,
      .video-play-overlay#videoPlayOverlay::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: inherit;
        background-size: cover;
        background-position: center;
        filter: blur(12px);
        z-index: -1;
      }
    }
    
    /* FIXED: Maximum specificity hover - maintain same appearance */
    #professionalVideoPlayer .video-play-overlay:hover,
    .professional-video-container .video-play-overlay:hover,
    .video-play-overlay#videoPlayOverlay:hover {
      background: rgba(0, 0, 0, 0.5) !important;
      -webkit-backdrop-filter: blur(12px) !important;
      -moz-backdrop-filter: blur(12px) !important;
      backdrop-filter: blur(12px) !important;
    }
    
    /* CRITICAL: Hidden state overrides hover - overlay must stay hidden during playback */
    #professionalVideoPlayer .video-play-overlay.hidden:hover,
    .professional-video-container .video-play-overlay.hidden:hover,
    .video-play-overlay#videoPlayOverlay.hidden:hover {
      opacity: 0 !important;
      visibility: hidden !important;
      pointer-events: none !important;
    }
    
    /* BULLETPROOF PLAY BUTTON - Simplified */
    .video-play-overlay .clean-play-button,
    .clean-play-button {
      /* DIMENSIONS - Force exact size */
      width: 72px !important;
      height: 72px !important;
      min-width: 72px !important;
      min-height: 72px !important;
      border-radius: 50% !important;
      
      /* BACKGROUND - Force white background */
      background: rgba(255, 255, 255, 0.95) !important;
      background-color: rgba(255, 255, 255, 0.95) !important;
      border: none !important;
      border-width: 0 !important;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2) !important;
      
      /* TEXT - Force dark text */
      font-size: 24px !important;
      color: #1a1a1a !important;
      font-weight: normal !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      line-height: 1 !important;
      
      /* LAYOUT - Force centering */
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      text-align: center !important;
      padding: 0 !important;
      padding-left: 3px !important; /* Optical centering for play symbol */
      margin: 0 !important;
      margin-bottom: 16px !important;
      
      /* INTERACTION */
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      
      /* ELIMINATE BLACK SQUARES - Nuclear option */
      text-shadow: none !important;
      -webkit-text-stroke: 0 !important;
      -moz-text-stroke: 0 !important;
      text-stroke: 0 !important;
      outline: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
      
      /* ADDITIONAL OVERRIDES */
      text-decoration: none !important;
      text-transform: none !important;
      letter-spacing: normal !important;
      word-spacing: normal !important;
      opacity: 1 !important;
      visibility: visible !important;
      display: flex !important;
      position: relative !important;
      z-index: 10 !important;
    }
    
    
    .video-play-overlay .clean-play-button:active,
    .clean-play-button:active {
      transform: scale(1.05) !important;
    }
    
    /* Video Info Caption */
    .video-info {
      text-align: center;
    }
    
    .video-caption {
      color: rgba(255, 255, 255, 0.9);
      font-size: 14px;
      font-weight: 500;
      margin: 0;
      padding: 8px 16px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 20px;
      background: rgba(0, 0, 0, 0.8);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    /* Hide overlay when video is playing */
    .video-play-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* REMOVED: Lower specificity hover effect - replaced with higher specificity version above */

    
    /* Professional video controls */
    .main-video::-webkit-media-controls {
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .main-video:hover::-webkit-media-controls {
      opacity: 1;
    }
    
    /* Mobile responsive styles for clean video player */
    @media screen and (max-width: 768px) {
      .professional-video-player {
        max-width: 100%;
        margin: 0;
      }
      
      .clean-play-button {
        width: 60px;
        height: 60px;
        font-size: 20px;
      }
      
      .video-caption {
        font-size: 12px;
        padding: 6px 12px;
      }
    }
    
    /* Custom video controls styling */
    video::-webkit-media-controls {
      width: 100%;
    }
    
    video::-webkit-media-controls-panel {
      background: rgba(0, 0, 0, 0.3);
      padding: 5px;
    }
    
    /* Show controls more readily */
    video::-webkit-media-controls-panel {
      opacity: 0.5;
      transition: opacity 0.3s ease;
    }
    
    video:hover::-webkit-media-controls-panel,
    video:focus::-webkit-media-controls-panel {
      opacity: 1;
    }
    
    /* Ensure play and mute buttons are white */
    video::-webkit-media-controls-play-button,
    video::-webkit-media-controls-mute-button {
      filter: brightness(2) contrast(2);
      -webkit-filter: brightness(2) contrast(2);
    }
    
    /* Hide time displays but show progress bar */
    video::-webkit-media-controls-current-time-display,
    video::-webkit-media-controls-time-remaining-display,
    video::-webkit-media-controls-fullscreen-button {
      display: none !important;
    }
    
    /* Style the timeline progress bar */
    video::-webkit-media-controls-timeline-container {
      filter: brightness(2) contrast(1.2);
      -webkit-filter: brightness(2) contrast(1.2);
    }
    
    video::-webkit-media-controls-timeline {
      filter: brightness(2) contrast(1.2);
      -webkit-filter: brightness(2) contrast(1.2);
    }
    
    /* Hide volume slider but keep mute button */
    video::-webkit-media-controls-volume-slider-container {
      display: none !important;
    }
    
    /* For Firefox */
    video::-moz-media-controls-panel {
      background: rgba(0, 0, 0, 0.3);
    }
    
    /* Hide time displays in Firefox but show progress bar */
    video::-moz-media-controls-current-time-display,
    video::-moz-media-controls-time-remaining-display {
      display: none !important;
    }
    
    /* Style Firefox progress bar */
    video::-moz-media-controls-progress-bar {
      filter: brightness(2) contrast(1.2);
    }
    
    /* General video element styling */
    video {
      /* Let browser handle video background/poster display naturally */
    }
    
    /* Loading spinner already defined earlier in the CSS */
    
    /* Calendar Section Styles */
    .calendar-section {
      margin: 3rem 0;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      border: 1px solid var(--border);
    }

    /* Cal.com Confirmation Section */
    .cal-confirmation-section {
      margin: 2rem 0;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
      border: 1px solid rgba(74, 222, 128, 0.2);
      text-align: center;
    }

    .confirmation-details {
      margin-top: 1.5rem;
    }

    .confirmation-icon {
      display: flex;
      justify-content: center;
      margin-bottom: 1.5rem;
    }

    .confirmation-icon svg {
      color: #4ade80;
      background: rgba(74, 222, 128, 0.1);
      padding: 12px;
      border-radius: 50%;
      width: 72px;
      height: 72px;
    }

    /* 2025 Minimal Typography Confirmation - Match Steps */
    .minimal-confirmation {
      text-align: center;
      padding: 1rem 0 2rem 0;
      font-family: General Sans, Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
    }

    /* Main Title - Match Step Headers */
    .minimal-title {
      color: var(--white);
      font-size: 2rem;
      font-weight: 600;
      margin: 0 0 1rem 0;
      line-height: 1.3;
      text-transform: uppercase;
      font-family: General Sans, Arial, sans-serif;
    }

    .minimal-subtitle {
      color: var(--grey);
      font-size: 1.1rem;
      font-weight: 400;
      margin: 0 0 2rem 0;
      line-height: 1.6;
      font-family: General Sans, Arial, sans-serif;
    }

    /* Clean Divider */
    .minimal-divider {
      width: 60px;
      height: 1px;
      background: var(--grey);
      margin: 0 auto 2rem auto;
      opacity: 0.3;
    }

    /* Professional Preparation Accordion - Based on FAQ Section */
    .prep-section {
      margin-top: 2rem;
      margin-bottom: 0;
      max-width: 900px; /* Desktop max-width */
      margin-left: auto;
      margin-right: auto;
      text-align: center;
      padding: 0; /* Remove padding - let mobile breakpoints handle their own spacing */
    }

    .prep-title {
      color: var(--white);
      font-size: 1rem;
      font-weight: 400;
      margin: 0 0 1.5rem 0;
      font-family: General Sans, Arial, sans-serif;
      text-align: center;
    }

    .prep-accordion {
      max-width: 100%;
      margin: 0 auto;
      text-align: left;
    }

    .prep-item {
      margin-bottom: 0;
      background: transparent;
      border: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
      transition: background-color 0.2s ease;
    }

    .prep-item:first-child {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .prep-question {
      padding: 1.5rem 0;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgba(255, 255, 255, 0.9);
      font-size: 1rem;
      font-weight: 400;
      letter-spacing: -0.02em;
      line-height: 1.3;
      transition: color 0.2s ease;
      font-family: General Sans, Arial, sans-serif;
    }

    .prep-question:hover {
      color: rgba(255, 255, 255, 1);
    }

    .prep-toggle {
      font-size: 1.2rem;
      color: rgba(255, 255, 255, 0.4);
      transition: transform 0.25s ease-out, color 0.2s ease;
      line-height: 1;
      font-weight: 300;
      transform-origin: center center;
      will-change: transform;
    }

    .prep-item:hover .prep-toggle {
      color: rgba(255, 255, 255, 0.6);
    }

    .prep-item.active .prep-question {
      color: #fff;
    }

    .prep-item.active .prep-toggle {
      color: #fff;
      transform: rotate(45deg);
    }

    .prep-answer {
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows 0.25s ease-out;
      color: rgba(255, 255, 255, 0.6);
      line-height: 1.6;
      font-size: 0.95rem;
      margin: 0;
      padding: 0;
    }

    .prep-answer-content {
      overflow: hidden;
      min-height: 0;
      padding: 0;
      margin: 0;
      opacity: 0;
      transform: scale(0.98);
      transition: opacity 0.25s ease-out, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .prep-item.active .prep-answer {
      grid-template-rows: 1fr;
    }

    .prep-item.active .prep-answer-content {
      padding: 0 0 1.5rem 0;
      opacity: 1;
      transform: scale(1);
    }

    .prep-answer p {
      margin: 0;
      font-family: General Sans, Arial, sans-serif;
    }

    /* Email Link - Match Footer Style */
    .minimal-contact {
      margin-top: 2rem;
      text-align: center;
    }
    
    .minimal-contact .link-button {
      display: inline-block !important;
      width: auto !important;
    }

    /* MAXIMUM SPECIFICITY: Show underline by default, animate to right and disappear on hover */
    body .minimal-contact .link-button .underline,
    body .minimal-contact .link-button .underline.is-nav,
    body .minimal-contact a.link-button .underline,
    body .minimal-contact a.link-button .underline.is-nav {
      background-color: rgba(255, 255, 255, 0.8) !important;
      width: 100% !important;
      height: 1px !important;
      margin-top: 3px !important;
      transform: scaleX(1) !important;
      transform-origin: left !important;
      transition: transform 0.3s ease !important;
      display: block !important;
      -webkit-transform: scaleX(1) !important;
      -moz-transform: scaleX(1) !important;
      -ms-transform: scaleX(1) !important;
    }
    
    body .minimal-contact .link-button .underline.is-nav,
    body .minimal-contact a.link-button .underline.is-nav {
      background-color: rgba(255, 255, 255, 0.8) !important;
    }
    
    body .minimal-contact .link-button:hover .underline,
    body .minimal-contact .link-button:hover .underline.is-nav,
    body .minimal-contact a.link-button:hover .underline,
    body .minimal-contact a.link-button:hover .underline.is-nav {
      transform: scaleX(0) !important;
      transform-origin: right !important;
      -webkit-transform: scaleX(0) !important;
      -moz-transform: scaleX(0) !important;
      -ms-transform: scaleX(0) !important;
    }


    /* Mobile Responsive - Match Steps */
    @media (max-width: 991px) {
      .minimal-confirmation {
        padding: 2rem 0 1.5rem 0;
      }

      .minimal-title {
        font-size: 1.8rem;
      }

      .minimal-subtitle {
        font-size: 1rem;
      }

      .minimal-section-title {
        font-size: 1.1rem;
      }
    }

    @media (max-width: 767px) {
      .minimal-confirmation {
        padding: 1.5rem 1rem;
        text-align: center;
      }
      
      /* FIXED: Make accordion inherit natural container width like title/subtitle */
      .prep-section {
        margin-top: 2rem;
        margin-bottom: 0;
        /* Remove width constraints - let it use full container width like title/subtitle */
      }

      .minimal-title {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
      }

      .minimal-subtitle {
        font-size: 1rem;
        margin-bottom: 1.5rem;
      }

      .prep-section {
        /* Basic mobile overrides, viewport breakout handled in specific breakpoints */
        max-width: none;
        margin-top: 2rem;
      }

      .prep-title {
        font-size: 0.95rem;
        margin-bottom: 1.125rem;
      }

      .prep-question {
        padding: 1.25rem 0; /* Balanced vertical spacing */
        font-size: 0.9rem; /* Slightly smaller for better text fitting */
        line-height: 1.35; /* Optimized for multi-line consistency */
        letter-spacing: -0.01em; /* Subtle tighter spacing for more text */
      }

      .prep-answer {
        font-size: 0.9rem;
        line-height: 1.5; /* Improved mobile readability */
      }

      .prep-item.active .prep-answer-content {
        padding: 0 0 1.25rem 0; /* Match question vertical spacing for visual balance */
      }

      .prep-list {
        max-width: 100%;
      }

      .minimal-divider {
        margin: 0 auto 1.5rem auto;
      }
    }

    @media (max-width: 479px) {
      .minimal-title {
        font-size: 1.3rem;
      }

      .minimal-subtitle {
        font-size: 0.95rem;
      }

      .prep-title {
        font-size: 0.9rem;
      }

      .prep-section {
        margin-top: 2rem;
        margin-bottom: 0;
        /* Remove width constraints - let it use full container width like title/subtitle */
      }

      .prep-question {
        padding: 1.125rem 0; /* Balanced vertical spacing */
        font-size: 0.85rem; /* Optimized for very small screens and text fitting */
        line-height: 1.32; /* Tight but readable for multi-line consistency */
        letter-spacing: -0.005em; /* Subtle spacing optimization */
      }

      .prep-answer {
        font-size: 0.85rem;
        line-height: 1.45; /* Better small screen readability */
      }

      .prep-item.active .prep-answer-content {
        padding: 0 0 1.125rem 0; /* Match question vertical spacing for visual balance */
      }
    }

    .confirmation-text {
      font-size: 1.1rem;
      color: var(--white);
      line-height: 1.6;
      margin-bottom: 2rem;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .next-steps {
      text-align: left;
      background: rgba(255, 255, 255, 0.02);
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      max-width: 400px;
      margin: 0 auto;
    }

    .next-steps h4 {
      color: var(--white);
      margin-bottom: 1rem;
      font-size: 1rem;
      font-weight: 600;
    }

    .next-steps ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .next-steps li {
      color: rgba(255, 255, 255, 0.8);
      padding: 0.5rem 0;
      font-size: 0.95rem;
      line-height: 1.4;
      position: relative;
      padding-left: 1.5rem;
    }

    .next-steps li:before {
      content: 'âœ“';
      position: absolute;
      left: 0;
      color: #4ade80;
      font-weight: bold;
    }
    
    .calendar-section h3 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--white);
      text-align: center;
    }
    
    .calendar-subtext {
      text-align: center;
      color: var(--grey);
      margin-bottom: 1.5rem;
      font-size: 0.95rem;
    }
    
    .calendar-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .calendar-button {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 1.75rem;
      background: var(--secondary-black);
      color: var(--white);
      text-decoration: none;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-weight: 500;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      cursor: pointer;
      font-family: 'General Sans', -apple-system, sans-serif;
      position: relative;
      overflow: hidden;
    }
    
    .calendar-button:before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent 0%, rgba(255, 255, 255, 0.05) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .calendar-button:hover:before {
      opacity: 1;
    }
    
    .calendar-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    
    .calendar-button svg {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
    }
    
    .google-cal:hover {
      border-color: #4285f4;
      box-shadow: 0 6px 20px rgba(66, 133, 244, 0.3);
    }
    
    .google-cal:hover svg {
      filter: drop-shadow(0 0 4px rgba(66, 133, 244, 0.5));
    }
    
    .outlook-cal:hover {
      border-color: #0078d4;
      box-shadow: 0 6px 20px rgba(0, 120, 212, 0.3);
    }
    
    .outlook-cal:hover svg {
      filter: drop-shadow(0 0 4px rgba(0, 120, 212, 0.5));
    }
    
    .apple-cal:hover {
      border-color: #555555;
      box-shadow: 0 6px 20px rgba(255, 255, 255, 0.1);
    }
    
    .apple-cal:hover svg {
      filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.3));
    }
    
    /* AI Assistant Section */
    .ai-assistant-section {
      margin: 3rem 0;
      padding: 2.5rem;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .ai-assistant-section::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
      animation: pulse 4s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }
    
    .ai-assistant-section h3 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      color: var(--white);
      position: relative;
      z-index: 1;
    }
    
    .ai-description {
      color: var(--grey);
      margin-bottom: 2rem;
      font-size: 1rem;
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }
    
    .ai-discovery-button {
      display: inline-block;
      padding: 1rem 2.5rem;
      background: var(--white);
      color: var(--primary-black);
      text-decoration: none;
      border: 2px solid var(--white);
      border-radius: 0;
      font-weight: 600;
      font-size: 0.95rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      z-index: 1;
      font-family: 'General Sans', -apple-system, sans-serif;
    }
    
    .ai-discovery-button:hover {
      background: transparent;
      color: var(--white);
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(255, 255, 255, 0.2);
    }
    
    /* Cal.com Calendar Section */
    .cal-calendar-section {
      margin: 0.5rem 0 1rem 0;
      text-align: center;
    }
    
    .cal-calendar-section h3 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--white);
    }
    
    /* Enhanced confirmation wrapper */
    .enhanced-confirmation {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }
    
    /* CRITICAL: Hide Cal.com embed when confirmation page is active */
    .enhanced-confirmation ~ #my-cal-inline-30min,
    .calendar-container:has(.enhanced-confirmation) #my-cal-inline-30min {
      display: none !important;
      visibility: hidden !important;
      height: 0 !important;
      overflow: hidden !important;
    }
    
    /* CSS hiding rules removed - we now replace content entirely instead of hiding it */
    
    /* SURGICAL CURSOR FIX - Maximum specificity for phone input */
    input#phoneInput[type="tel"],
    div#phoneComponentContainer input#phoneInput[type="tel"],
    div#phoneFormContainer input#phoneInput[type="tel"],
    .enhanced-confirmation input#phoneInput[type="tel"] {
      cursor: text !important;
    }
    
    input#phoneInput[type="tel"]:hover,
    div#phoneComponentContainer input#phoneInput[type="tel"]:hover,
    div#phoneFormContainer input#phoneInput[type="tel"]:hover,
    .enhanced-confirmation input#phoneInput[type="tel"]:hover,
    /* Remove ALL browser default styling for phone input */
    input#phoneInput[type="tel"] {
      outline: none !important;
      border: 1px solid rgba(255, 255, 255, 0.1) !important;
      background: rgba(255, 255, 255, 0.05) !important;
      box-shadow: none !important;
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
    }
    
    input#phoneInput[type="tel"]:focus,
    div#phoneComponentContainer input#phoneInput[type="tel"]:focus,
    div#phoneFormContainer input#phoneInput[type="tel"]:focus,
    .enhanced-confirmation input#phoneInput[type="tel"]:focus {
      cursor: text !important;
      outline: none !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      background: rgba(255, 255, 255, 0.08) !important;
      box-shadow: none !important;
    }
    
    /* Override for full-width confirmation display when created dynamically */
    .enhanced-confirmation[style*="max-width: none"] {
      max-width: none !important;
      width: 100% !important;
      margin: 0 !important;
    }
    
    /* Confirmation page-specific styles for seamless integration */
    .calendly-embed-container.confirmation-page {
      height: auto !important;
      min-height: 1200px !important;
      overflow: visible !important;
      background: transparent !important;
      border: none !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      padding: 0 !important;
      margin: 0 !important;
    }
    
    /* Professional container setup */
    .calendar-container {
      min-height: 100vh;
      height: auto;
      position: relative;
    }
    
    .calendly-embed-container.confirmation-page .calendly-inline-widget {
      width: 100%;
      height: auto;
      position: relative;
    }
    
    /* Ensure iframe can expand naturally */
    #my-cal-inline-30min.iframe-container {
      width: 100%;
      position: relative;
      overflow: visible;
    }
    
    /* Remove all scroll indicators on confirmation page */
    .calendly-embed-container.confirmation-page::before,
    .calendly-embed-container.confirmation-page::after {
      display: none !important;
      content: none !important;
    }
    
    /* Remove scrollbar styling on confirmation */
    .calendly-embed-container.confirmation-page::-webkit-scrollbar {
      display: none !important;
    }
    
    .calendly-embed-container.confirmation-page .calendly-inline-widget,
    .calendly-embed-container.confirmation-page #my-cal-inline-30min {
      height: auto !important;
      min-height: 600px !important;
      overflow: visible !important;
    }
    
    /* Simple confirmation page solution */
    .calendly-embed-container.confirmation-page {
      width: 100%;
      height: auto;
      min-height: 100vh;
      position: relative;
      background: transparent;
      border: none;
      overflow: visible;
    }
    
    /* Desktop/Laptop: Dynamic height based on content */
    @media screen and (min-width: 769px) {
      .calendly-embed-container.confirmation-page iframe {
        width: 100%;
        height: auto;
        min-height: 600px; /* Minimum while loading */
        border: none;
        display: block;
      }
    }
    
    /* Mobile: Fixed height to prevent excess space */
    @media screen and (max-width: 768px) {
      .calendly-embed-container.confirmation-page iframe {
        width: 100%;
        height: 1000px !important;
        min-height: 1000px !important;
        max-height: 1000px !important;
        border: none;
      }
    }
    
    /* iPad specific adjustment */
    @media screen and (min-width: 769px) and (max-width: 1024px) {
      .calendly-embed-container.confirmation-page iframe {
        height: auto;
        min-height: 600px; /* Minimum while loading */
      }
    }
    
    /* Mobile Responsive Styles */
    @media screen and (max-width: 768px) {
      /* Video wrapper already has 75% padding */
      
      .calendar-buttons {
        flex-direction: column;
        gap: 0.75rem;
      }
      
      .calendar-button {
        width: 100%;
        justify-content: center;
      }
      
      .ai-assistant-section {
        padding: 2rem 1.5rem;
      }
      
      .ai-description br {
        display: none;
      }
      
    }
    
    
    /* Tablet-specific styles (iPad Mini, etc) */
    @media screen and (min-width: 480px) and (max-width: 768px) {
      .calendar-header {
        padding: 2rem 0 1rem 0;
      }
      
      .calendar-header h1 {
        font-size: 2rem;
      }
      
      .calendar-container {
        padding: 0 1rem 2rem 1rem;
      }
      
      .personalized-message {
        padding: 0.75rem 0 1.5rem 0;
      }
      
      .personalized-text {
        font-size: 1rem;
      }
      
      .calendar-divider {
        width: 80px;
        margin-bottom: 0.375rem;
      }
      
      .progress-steps {
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .step-divider {
        width: 35px; /* Tablet-optimized size */
        height: 1px;
        background: var(--grey); /* Match subtext color */
      }
      
      /* Scrollable container for tablets - same as mobile */
      .calendly-embed-container {
        height: 800px; /* Fixed viewport height */
        padding: 0;
        margin: 0;
        overflow-y: auto;
        overflow-x: hidden;
        position: relative;
        background: rgba(15, 15, 15, 0.5);
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
        /* Container boundaries */
        border: 1px solid rgba(180, 180, 180, 0.15);
        border-radius: 8px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1), 
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }
      
      /* Scroll indicators for tablets */
      .calendly-embed-container::after {
        content: '';
        position: sticky;
        bottom: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to bottom, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 0 0 8px 8px;
      }
      
      .calendly-embed-container::before {
        content: '';
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to top, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 8px 8px 0 0;
      }
      
      .calendly-embed-container.has-scroll-bottom::after {
        opacity: 1;
      }
      
      .calendly-embed-container.has-scroll-top::before {
        opacity: 1;
      }
      
      /* Styled scrollbar for tablets */
      .calendly-embed-container::-webkit-scrollbar {
        width: 6px;
        background: transparent;
      }
      
      .calendly-embed-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
        transition: background 0.2s ease;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      
      .calendly-embed-container {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.05);
      }
      
      .calendly-inline-widget {
        height: auto;
        position: relative;
        overflow: visible;
      }
      
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        width: 100% !important;
        height: 2000px !important; /* Increased to accommodate full day schedules */
        border: 0 !important;
        display: block;
        position: relative;
        border-radius: 8px;
      }
      
      .loading-container {
        height: 580px;
      }
      
      #my-cal-inline-30min {
        height: auto;
        overflow: visible;
        position: relative;
      }
    }
    
    @media screen and (max-width: 479px) {
      /* Ensure page scrolling on mobile */
      html, body {
        overflow-x: hidden;
        overflow-y: auto;
        height: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      .page-wrapper {
        min-height: 100vh;
        height: auto;
        overflow: visible;
      }
      
      /* Reduce vertical spacing for more calendar room */
      .calendar-header {
        padding: 1.5rem 1.25rem 0.75rem 1.25rem; /* Less top/bottom padding */
      }
      
      .calendar-header h1 {
        font-size: 1.8rem;
      }
      
      .progress-indicator {
        padding: 0.5rem 0; /* Reduced vertical padding */
      }
      
      /* Smaller progress elements on mobile */
      .progress-steps {
        gap: 0.5rem; /* Tighter spacing */
        align-items: center;
        flex-direction: row; /* Keep horizontal on mobile */
      }
      
      .step-circle {
        width: 20px; /* Reduced from 24px */
        height: 20px;
        font-size: 0.7rem; /* Smaller font */
      }
      
      .step-text {
        font-size: 0.8rem; /* Reduced from 0.9rem */
      }
      
      .step-divider {
        width: 30px; /* Medium responsive size */
        height: 1px;
        background: var(--grey); /* Match subtext color */
      }
      
      .calendar-container {
        padding: 0 1rem 2rem 1rem; /* Add horizontal padding for proper spacing */
      }
      
      .personalized-message {
        padding: 0.5rem 1.25rem 1rem 1.25rem; /* Reduced vertical padding */
      }
      
      .personalized-text {
        font-size: 0.95rem;
      }
      
      .calendar-divider {
        width: 60px;
      }
      
      /* Refined scrollable container solution */
      .calendly-embed-container {
        height: 800px; /* Reasonable viewport height */
        padding: 0;
        margin: 0; /* Remove margin to prevent alignment issues */
        overflow-y: auto; /* Enable vertical scrolling */
        overflow-x: hidden;
        position: relative;
        background: rgba(15, 15, 15, 0.5); /* Subtle background */
        -webkit-overflow-scrolling: touch; /* Smooth iOS scrolling */
        scroll-behavior: smooth;
        /* Define container boundaries */
        border: 1px solid rgba(180, 180, 180, 0.15);
        border-radius: 8px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.1), 
                    inset 0 1px 0 rgba(255, 255, 255, 0.05);
      }
      
      /* Bottom scroll indicator gradient */
      .calendly-embed-container::after {
        content: '';
        position: sticky;
        bottom: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to bottom, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 0 0 8px 8px;
      }
      
      /* Top scroll indicator gradient */
      .calendly-embed-container::before {
        content: '';
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        height: 60px;
        background: linear-gradient(to top, transparent, rgba(15, 15, 15, 0.95));
        pointer-events: none;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 8px 8px 0 0;
      }
      
      /* Show gradients based on scroll position */
      .calendly-embed-container.has-scroll-bottom::after {
        opacity: 1;
      }
      
      .calendly-embed-container.has-scroll-top::before {
        opacity: 1;
      }
      
      /* End of content indicator */
      .scroll-end-indicator {
        display: none;
        text-align: center;
        padding: 1rem;
        color: rgba(180, 180, 180, 0.6);
        font-size: 0.85rem;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(to bottom, transparent, rgba(15, 15, 15, 0.9));
        pointer-events: none;
      }
      
      .calendly-embed-container.at-bottom .scroll-end-indicator {
        display: block;
      }
      
      .calendly-inline-widget {
        height: auto;
        position: relative;
        overflow: visible;
      }
      
      /* Keep iframe tall to show all content */
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        width: 100% !important;
        height: 1600px !important; /* Increased to accommodate full day schedules */
        border: 0 !important;
        display: block;
        position: relative;
        border-radius: 8px; /* Match container radius */
      }
      
      #my-cal-inline-30min {
        height: auto;
        overflow: visible;
        position: relative;
      }
      
      .loading-container {
        height: 600px;
      }
      
      /* Styled scrollbar for better UX */
      .calendly-embed-container::-webkit-scrollbar {
        width: 6px;
        background: transparent;
      }
      
      .calendly-embed-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
        transition: background 0.2s ease;
      }
      
      .calendly-embed-container::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      
      /* Firefox scrollbar styling */
      .calendly-embed-container {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.05);
      }
      
      /* Confirmation page mobile styles - Match homepage responsive */
      .confirmation-container {
        padding: 4rem 1.25rem;
      }
      
      .confirmation-success-badge {
        font-size: 0.8rem;
        padding: 0.625rem 1.25rem;
      }
      
      .confirmation-heading {
        font-size: clamp(2rem, 8vw, 2.5rem);
        line-height: 1.2;
      }
      
      .confirmation-tagline {
        font-size: 1.1rem;
      }
      
      .confirmation-message {
        font-size: 1rem;
      }
      
      .confirmation-button {
        font-size: 12px;
        padding: 0.875rem 2.5rem;
      }
    }
    
    
    /* Desktop styles */
    @media screen and (min-width: 769px) {
      /* Fix Cal.com embed height on desktop - show full content */
      #my-cal-inline-30min {
        min-height: 700px;
        height: auto;
      }
      
      .calendly-inline-widget {
        min-height: 700px;
        height: auto;
      }
      
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 700px !important; /* Taller height for desktop to show full calendar */
        min-height: 700px !important;
      }
      
      /* Ensure scrollable container doesn't add scrollbars on desktop */
      .calendly-embed-container {
        height: auto !important;
        overflow: visible !important;
      }
      
      /* Reduce spacing for single-screen view */
      
      .ai-assistant-section {
        margin: 2rem 0;
      }
      
      .cal-calendar-section {
        margin: 1.5rem 0 1rem 0;
      }
    }
    
    /* Laptop screens (smaller desktops) */
    @media screen and (min-width: 1024px) and (max-width: 1440px) {
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 650px !important; /* Slightly shorter for laptops */
        min-height: 650px !important;
      }
      
      #my-cal-inline-30min {
        min-height: 650px;
      }
      
      .calendly-inline-widget {
        min-height: 650px;
      }
    }
    
    /* Large desktop screens */
    @media screen and (min-width: 1441px) {
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 750px !important; /* Even taller for large screens */
        min-height: 750px !important;
      }
      
      #my-cal-inline-30min {
        min-height: 750px;
      }
      
      .calendly-inline-widget {
        min-height: 750px;
      }
    }
    
    /* For very small screens (iPhone SE, etc) */
    @media screen and (max-width: 375px) {
      .calendly-inline-widget iframe,
      #my-cal-inline-30min iframe {
        height: 1100px !important; /* Slightly less for smaller screens */
      }
      
      /* Restored progress indicator text */
      .step-text {
        font-size: 0.8rem;
        color: var(--grey);
      }
      
      .step-divider {
        width: 25px; /* Visible but mobile-optimized */
        height: 1px;
        background: var(--grey); /* Match subtext color */
      }
      
      .progress-steps {
        gap: 0.25rem; /* Minimal spacing */
      }
    }
    
    /* Mobile confirmation page overrides */
    @media screen and (max-width: 768px) {
      .calendly-embed-container.confirmation-page {
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
        border-radius: 0 !important;
      }
      
      .calendly-embed-container.confirmation-page::before,
      .calendly-embed-container.confirmation-page::after {
        display: none !important;
      }
      
      .calendly-embed-container.confirmation-page iframe {
        border-radius: 0 !important;
      }
    }
    
    /* Larger screens optimization */
    @media screen and (min-width: 1280px) {
      .calendly-embed-container {
        max-width: 100%;
      }
      
      .calendar-container {
        max-width: 1800px;
      }
    }
    
    /* AI Discovery Section Styles - Premium Dark Design */
    .ai-discovery-section {
      padding: 2.5rem 2rem; /* Reduced from 4rem for better step spacing */
      background-color: var(--primary-black);
      position: relative;
      overflow: hidden;
      display: block;
      visibility: visible;
      opacity: 1;
      min-height: 200px;
    }
    
    
    .ai-discovery-container {
      max-width: 1000px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }
    
    .ai-discovery-heading {
      font-size: 2rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0.75rem;
      line-height: 1.2;
      letter-spacing: -0.02em;
      text-align: center;
      display: block;
      visibility: visible;
    }
    
    .ai-discovery-subheading {
      font-size: 1.125rem;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 2.5rem;
      line-height: 1.4;
      max-width: 600px;
      text-align: center !important;
      margin-left: auto !important;
      margin-right: auto !important;
      display: block !important;
      width: 100% !important;
    }
    
    
    /* 3-Step Progress Indicator - Vercel/Apple Style */
    .progress-steps {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 2rem 0 3rem 0;
      padding: 0 1rem;
    }
    
    .progress-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      opacity: 0.4;
      transition: opacity 0.3s ease;
    }
    
    .progress-step.active {
      opacity: 1;
    }
    
    .progress-step-circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.6);
      transition: all 0.3s ease;
    }
    
    .progress-step.active .progress-step-circle {
      background: var(--white);
      border-color: var(--white);
      color: var(--primary-black);
    }
    
    .progress-step-label {
      font-size: 0.75rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.6);
      text-align: center;
      white-space: nowrap;
    }
    
    .progress-step.active .progress-step-label {
      color: rgba(255, 255, 255, 0.9);
    }
    
    .progress-step-connector {
      width: 60px;
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
      margin: 0 1rem;
    }
    
    @media (max-width: 768px) {
      .progress-steps {
        margin: 1.5rem 0 2rem 0;
      }
      
      .progress-step-connector {
        width: 40px;
        margin: 0 0.5rem;
      }
      
      .progress-step-label {
        font-size: 0.7rem;
      }
      
      .progress-step-circle {
        width: 28px;
        height: 28px;
        font-size: 0.8rem;
      }
    }

    /* Step Indicators for Visual Hierarchy */
    .step-indicator {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 2rem;
      justify-content: center;
    }
    
    .step-number-badge {
      width: 32px;
      height: 32px;
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.8);
      flex-shrink: 0;
    }
    
    .step-indicator h2,
    .step-indicator h3 {
      margin: 0;
      font-size: 1.375rem !important;
      font-weight: 600;
      color: var(--white);
      letter-spacing: -0.01em;
    }
    
    /* Recommended Label */
    .recommended-label {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 1rem;
      text-align: center;
    }
    
    /* MAXIMUM SPECIFICITY: Phone Button - Bulletproof White Button */
    body .phone-form-container .ai-discovery-cta,
    body .phone-form-container button.ai-discovery-cta,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta,
    body .phone-form-container #submitPhoneButton,
    body button#submitPhoneButton.ai-discovery-cta,
    body #submitPhoneButton {
      display: inline-block !important;
      visibility: visible !important;
      margin: 1.5rem auto 0 !important;
      padding: 1.25rem 2rem !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
      color: #1a1a1a !important;
      text-decoration: none !important;
      border: 2px solid rgba(255, 255, 255, 0.3) !important;
      border-radius: 12px !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-family: 'General Sans', -apple-system, sans-serif !important;
      text-transform: none !important;
      letter-spacing: -0.01em !important;
      cursor: pointer !important;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
      opacity: 1 !important;
      transform: translateY(0) scale(1) !important;
      position: relative !important;
      text-align: center !important;
      backdrop-filter: none !important;
      width: auto !important;
      min-width: 280px !important;
      max-width: 400px !important;
      outline: none !important;
      -webkit-appearance: none !important;
      appearance: none !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
      line-height: 1 !important;
      white-space: nowrap !important;
      overflow: visible !important;
      outline: none !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
      min-width: auto !important;
    }
    
    /* MAXIMUM SPECIFICITY: Phone Button States */
    body .phone-form-container .ai-discovery-cta:hover,
    body .phone-form-container button.ai-discovery-cta:hover,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta:hover,
    body .phone-form-container .ai-discovery-cta:focus,
    body .phone-form-container button.ai-discovery-cta:focus,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta:focus,
    body .phone-form-container .ai-discovery-cta:active,
    body .phone-form-container button.ai-discovery-cta:active,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta:active,
    body #submitPhoneButton:hover,
    body #submitPhoneButton:focus,
    body #submitPhoneButton:active {
      color: #1a1a1a !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
      border-color: rgba(255, 255, 255, 0.5) !important;
      transform: translateY(-1px) scale(1) !important;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
      outline: none !important;
      -webkit-text-stroke: none !important;
      text-stroke: none !important;
    }
    
    /* Progressive Disclosure States */
    .ai-discovery-cta.transitioning {
      transform: translateY(-10px) scale(0.9) !important;
      opacity: 0.7 !important;
      pointer-events: none !important;
    }
    
    .ai-discovery-cta.hidden-smooth {
      transform: translateY(-20px) scale(0.8) !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
    
    .ai-discovery-cta .button-content {
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 3px !important;
      color: inherit !important;
      width: 100% !important;
      height: auto !important;
    }

    /* MAXIMUM SPECIFICITY: Phone Button Text - Force Dark Text */
    body .phone-form-container .ai-discovery-cta .button-content span,
    body .phone-form-container button.ai-discovery-cta .button-content span,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta .button-content span,
    body .phone-form-container .ai-discovery-cta span,
    body .phone-form-container button.ai-discovery-cta span,
    body .phone-form-container #submitPhoneButton.ai-discovery-cta span,
    body .phone-form-container #submitPhoneButton span,
    body .phone-form-container #submitPhoneButton .button-content span,
    body #submitPhoneButton span,
    body #submitPhoneButton .button-content span,
    body button#submitPhoneButton span,
    html body .phone-form-container #submitPhoneButton,
    html body #submitPhoneButton,
    html body button#submitPhoneButton {
      color: #1a1a1a !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      text-transform: none !important;
      letter-spacing: -0.01em !important;
      opacity: 1 !important;
      display: inline-block !important;
      visibility: visible !important;
      text-shadow: none !important;
      white-space: nowrap !important;
      line-height: 1.2 !important;
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      outline: none !important;
      user-select: none !important;
      -webkit-user-select: none !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
      border: 1px solid rgba(255, 255, 255, 0.3) !important;
      text-decoration: none !important;
    }
    
    /* Hide underline effect for professional button */
    .ai-discovery-cta .button-underline {
      display: none !important;
    }
    
    .ai-discovery-cta .phone-icon {
      display: none !important; /* Hide icon for clean main site aesthetic */
    }
    
    /* Supporting text styling - Clean minimal design */
    .ai-supporting-text {
      color: var(--grey);
      font-size: 0.95rem;
      line-height: 1.6;
      margin: 1rem auto; /* Center with auto margins for professional desktop width */
      max-width: 600px; /* Professional width constraint for desktop */
      padding: 0; /* Remove padding for cleaner look */
      background: transparent; /* Remove background */
      border: none; /* Remove left border */
      position: relative;
      text-align: center; /* Center align for better mobile balance */
    }
    
    .ai-supporting-text strong {
      color: var(--white);
      font-weight: 600;
    }
    
    .button-text-block.bigger {
      height: 1.4rem;
    }
    
    /* Professional Phone Form - Progressive Disclosure */
    /* AI CTA Container for In-Place Transformation */
    .ai-cta-container {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80px;
      width: 100%;
      max-width: 420px;
      margin: 1.5rem auto;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .phone-form-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 2rem;
      text-align: center;
      opacity: 0;
      transform: translateY(20px) scale(0.95);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      visibility: hidden;
      pointer-events: none;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      z-index: 2;
    }
    
    .phone-form-container.active {
      opacity: 1;
      transform: translateY(0) scale(1);
      visibility: visible;
      pointer-events: auto;
    }
    
    .phone-form-container.entering {
      opacity: 0.5;
      transform: translateY(10px) scale(0.98);
    }
    
    /* Enhanced Phone Form Header */
    .phone-form-header {
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .phone-form-title {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0.5rem;
      line-height: 1.3;
      letter-spacing: -0.02em;
    }
    
    .phone-form-subtitle {
      font-size: 0.95rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.5;
      margin-bottom: 0;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
    }
    
    /* Enhanced Phone Input Wrapper */
    .phone-input-wrapper {
      position: relative;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
    }
    
    .enhanced-phone-wrapper {
      margin-bottom: 2rem;
    }
    
    .phone-input-label {
      display: block;
      font-size: 0.9rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 0.5rem;
      text-align: left;
    }
    
    .phone-input-container {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .phone-input-hint {
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.5);
      margin-top: 0.5rem;
      text-align: center;
      font-style: italic;
    }
    
    .phone-input {
      width: 100%;
      padding: 1.4rem 1.2rem 1.4rem 3.5rem;
      background: rgba(255, 255, 255, 0.04) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 12px !important;
      color: #ffffff !important;
      font-size: 16px !important;
      font-family: 'General Sans', -apple-system, sans-serif !important;
      font-weight: 400;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      outline: none !important;
      box-sizing: border-box;
      text-align: center;
      backdrop-filter: blur(5px);
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .phone-input:focus {
      border-color: rgba(255, 255, 255, 0.4) !important;
      background: rgba(255, 255, 255, 0.06) !important;
      box-shadow: 
        inset 0 1px 3px rgba(0, 0, 0, 0.1),
        0 0 0 3px rgba(255, 255, 255, 0.1),
        0 2px 8px rgba(0, 0, 0, 0.15);
      transform: translateY(-1px) scale(1.01);
    }
    
    /* Professional Input Validation States */
    .phone-input-wrapper.valid .phone-input {
      border-color: rgba(74, 222, 128, 0.6) !important;
      background: rgba(74, 222, 128, 0.05) !important;
      box-shadow: 
        inset 0 1px 3px rgba(0, 0, 0, 0.1),
        0 0 0 3px rgba(74, 222, 128, 0.15);
    }
    
    .phone-input-wrapper.valid .phone-input-icon {
      color: #4ade80 !important;
    }
    
    .phone-input-wrapper.error .phone-input {
      border-color: rgba(255, 255, 255, 0.2) !important;
      background: rgba(255, 255, 255, 0.05) !important;
      box-shadow: 
        inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .phone-input-wrapper.error .phone-input-icon {
      color: #ef4444 !important;
    }
    
    /* Professional input states with micro-animations */
    .phone-input-wrapper.valid {
      animation: validPulse 0.3s ease;
    }
    
    .phone-input-wrapper.error {
      /* Subtle error state without distracting animation */
    }
    
    @keyframes validPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.02); }
      100% { transform: scale(1); }
    }
    
    @keyframes errorShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      75% { transform: translateX(2px); }
    }

    /* ============================================
       PROFESSIONAL POLISH & MICRO-INTERACTIONS
       ============================================ */

    /* Enhanced Button Hover States */
    .btn, .cta-button, .ai-cta-button, .phone-submit-btn, .back-button {
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }

    .btn::before, .cta-button::before, .ai-cta-button::before, .phone-submit-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s ease;
      z-index: 1;
    }

    .btn:hover::before, .cta-button:hover::before, .ai-cta-button:hover::before, .phone-submit-btn:hover::before {
      left: 100%;
    }

    /* Professional Button Hover Effects */
    .btn:hover, .cta-button:hover, .ai-cta-button:hover, .phone-submit-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 25px rgba(255, 255, 255, 0.15);
    }

    .btn:active, .cta-button:active, .ai-cta-button:active, .phone-submit-btn:active {
      transform: translateY(0px);
      transition: transform 0.1s ease;
    }

    /* Enhanced Focus States for Accessibility */
    .btn:focus-visible, .cta-button:focus-visible, .ai-cta-button:focus-visible, .phone-input:focus-visible {
      outline: 2px solid rgba(255, 255, 255, 0.6);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.1);
    }

    /* Professional Loading States */
    .loading-state {
      position: relative;
      color: transparent !important;
      pointer-events: none;
    }

    .loading-state::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: loadingSpin 1s linear infinite;
    }

    @keyframes loadingSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Subtle Animations for State Changes */
    .confirmation-section, .ai-phone-form-container, .calendar-embed-container {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Professional Typography Enhancement */
    h1, h2, h3, .section-title {
      font-weight: 600;
      letter-spacing: -0.02em;
      line-height: 1.2;
    }

    /* Enhanced Card Hover Effects */
    .confirmation-section, .calendar-section {
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .confirmation-section:hover, .calendar-section:hover {
      border-color: rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }

    /* Professional Form Enhancements */
    .phone-input-wrapper {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .phone-input:focus {
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    /* Enhanced Video Player Professional Touch */
    .professional-video-container {
      position: relative;
      transition: all 0.3s ease;
    }


    /* Duplicate definition removed - consolidated above */

    /* Smooth Scrolling Enhancement */
    html {
      scroll-behavior: smooth;
    }

    /* Professional Mobile Optimizations */
    @media (max-width: 768px) {
      .btn:hover, .cta-button:hover, .ai-cta-button:hover {
        transform: none;
        box-shadow: none;
      }
      
      .confirmation-section:hover, .calendar-section:hover {
        transform: none;
      }
      
      .professional-video-container:hover {
        transform: none;
      }
    }

    /* Enhanced Status Indicators */
    .status-indicator {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .status-indicator.success {
      background: rgba(34, 197, 94, 0.1);
      color: #22c55e;
      border: 1px solid rgba(34, 197, 94, 0.2);
    }

    .status-indicator.processing {
      background: rgba(59, 130, 246, 0.1);
      color: #3b82f6;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    /* Professional Skeleton Loaders */
    .skeleton {
      background: linear-gradient(90deg, 
        rgba(255, 255, 255, 0.1) 0%, 
        rgba(255, 255, 255, 0.2) 50%, 
        rgba(255, 255, 255, 0.1) 100%);
      background-size: 200% 100%;
      animation: skeletonLoading 1.5s ease-in-out infinite;
      border-radius: 4px;
    }

    @keyframes skeletonLoading {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    .phone-input::placeholder {
      color: rgba(255, 255, 255, 0.6) !important;
      font-weight: 400;
      text-align: center;
    }
    
    .phone-input-icon {
      position: absolute;
      left: 1.2rem;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.6) !important;
      width: 18px;
      height: 18px;
      stroke-width: 2;
      transition: color 0.3s ease;
      z-index: 2;
      pointer-events: none;
    }
    
    /* Professional AI Discovery CTA Button */
    .professional-ai-cta {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      padding: 1rem 2rem;
      background: #ffffff;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      color: var(--primary-black) !important;
      font-size: 1rem;
      font-weight: 600;
      font-family: 'General Sans', -apple-system, sans-serif;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-decoration: none;
      background: rgba(0, 0, 0, 0.8);
      margin: 1.5rem auto;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
      text-shadow: none;
      min-width: 280px;
    }
    
    
    .professional-ai-cta:hover {
      background: #ffffff;
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      border-color: rgba(255, 255, 255, 0.4);
    }
    
    
    .professional-ai-cta:active {
      transform: translateY(0px);
      transition: transform 0.1s ease;
    }
    
    .professional-ai-cta.fading-out {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }
    
    .professional-ai-cta .button-content {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      position: relative;
      z-index: 1;
    }
    
    .professional-ai-cta .button-text {
      font-weight: 400; /* Change from 600 to 400 for normal weight */
      letter-spacing: -0.01em;
      color: var(--primary-black) !important;
      text-shadow: none !important;
      background: transparent !important;
      -webkit-text-stroke: 0 !important;
    }
    
    .professional-ai-cta .button-arrow {
      width: 1.1rem;
      height: 1.1rem;
      transition: transform 0.3s ease;
    }
    
    .professional-ai-cta:hover .button-arrow {
      transform: translateX(2px);
    }

    /* Smart Phone CTA with Inline Transformation - NUCLEAR PRIORITY */
    .smart-phone-cta {
      position: relative;
      height: 64px;
      width: 100%;
      max-width: 520px;
      margin: 0 auto;
      overflow: hidden;
      background: #ffffff !important;
      background-color: #ffffff !important;
      border: 2px solid #e5e5e5 !important;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    }

    .smart-phone-cta:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
      background: #ffffff !important;
      background-color: #ffffff !important;
    }

    /* Button and Phone States */
    .button-state,
    .phone-state {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      padding: 0 1.5rem;
      box-sizing: border-box;
    }

    /* Initial Button State - MAXIMUM VISIBILITY */
    .button-state {
      background: #ffffff !important;
      background-color: #ffffff !important;
      transform: translateX(0);
      z-index: 2;
    }

    .button-state .button-text {
      font-weight: 600 !important;
      font-size: 1rem !important;
      color: #1a1a1a !important;
      margin-right: 0.75rem;
      white-space: nowrap;
      text-shadow: none !important;
      -webkit-text-stroke: 0 !important;
      opacity: 1 !important;
      visibility: visible !important;
    }

    .button-state .button-arrow {
      width: 1.1rem;
      height: 1.1rem;
      color: #1a1a1a !important;
      fill: #1a1a1a !important;
      stroke: #1a1a1a !important;
      transition: transform 0.3s ease;
      opacity: 1 !important;
    }

    /* Phone Input State */
    .phone-state {
      background: #ffffff;
      transform: translateX(100%);
      z-index: 1;
      gap: 1rem;
    }

    .phone-state.active {
      transform: translateX(0);
      z-index: 3;
    }

    .button-state.sliding-out {
      transform: translateX(-100%);
    }

    /* Phone Icon */
    .phone-icon {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      color: var(--primary-black);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .phone-icon svg {
      width: 100%;
      height: 100%;
    }

    /* Digit Input Form */
    .digit-input-form {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex: 1;
    }

    .digit-input-group {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      flex: 1;
    }

    /* Format Characters */
    .format-char {
      font-weight: 600;
      color: var(--primary-black);
      font-size: 1rem;
      user-select: none;
    }

    /* Individual Digit Boxes */
    .digit-box {
      width: 2.8rem;
      height: 2.8rem;
      text-align: center;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary-black);
      background: rgba(0, 0, 0, 0.03);
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      transition: all 0.2s ease;
      outline: none;
      font-family: 'General Sans', -apple-system, sans-serif;
    }

    .digit-box:focus {
      background: rgba(255, 255, 255, 0.05);
      border-color: var(--white);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
      transform: scale(1.05);
    }

    .digit-box.filled {
      background: rgba(74, 222, 128, 0.05);
      border-color: #10b981;
    }

    .digit-box.error {
      background: rgba(239, 68, 68, 0.05);
      border-color: #ef4444;
      animation: shake 0.3s ease;
    }

    /* Confirm Button */
    .confirm-btn {
      flex-shrink: 0;
      padding: 0.75rem 1.5rem;
      background: var(--primary-black);
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'General Sans', -apple-system, sans-serif;
    }

    .confirm-btn:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }

    .confirm-btn:disabled {
      background: rgba(0, 0, 0, 0.1);
      color: rgba(0, 0, 0, 0.4);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Animations */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-2px); }
      75% { transform: translateX(2px); }
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .smart-phone-cta {
        max-width: 100%;
        height: 60px;
      }
      
      .digit-box {
        width: 2.4rem;
        height: 2.4rem;
        font-size: 1rem;
      }
      
      .format-char {
        font-size: 0.9rem;
      }
      
      .confirm-btn {
        padding: 0.6rem 1.2rem;
        font-size: 0.85rem;
      }
    }

    /* APPLE-STYLE BUTTON - ABSOLUTE POSITIONED */
    html body .ai-cta-container button.emergency-phone-button,
    html body button.emergency-phone-button,
    html body .emergency-phone-button,
    body .emergency-phone-button {
      /* Reset and rebuild for absolute positioning */
      all: initial !important;
      
      /* Absolute positioning within container */
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100% !important;
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      box-sizing: border-box !important;
      
      /* SOPHISTICATED BACKGROUND - matches site design */
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
      
      /* Sophisticated typography */
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-style: normal !important;
      line-height: 60px !important;
      color: #1f2937 !important;
      text-align: center !important;
      text-decoration: none !important;
      text-transform: none !important;
      letter-spacing: -0.01em !important;
      white-space: nowrap !important;
      
      /* Apple-style transitions */
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      
      /* Default visible state */
      opacity: 1 !important;
      visibility: visible !important;
      z-index: 2 !important;
      transform: translateY(0) scale(1) !important;
      pointer-events: auto !important;
      
      /* Sophisticated shadow */
      outline: none !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
      -webkit-appearance: none !important;
      appearance: none !important;
      
      /* Remove any potential conflicts */
      text-shadow: none !important;
      -webkit-text-stroke: none !important;
      filter: none !important;
      mask: none !important;
      -webkit-mask: none !important;
    }
    
    /* Apple-style button fade out is handled by .hidden class in the main system above */
    
    /* Sophisticated hover - matches site aesthetic */
    html body .ai-cta-container button.emergency-phone-button:hover,
    html body button.emergency-phone-button:hover,
    html body .emergency-phone-button:hover,
    body .emergency-phone-button:hover,
    .emergency-phone-button:hover {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      color: #111827 !important;
      transform: translateY(-2px) !important;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Sophisticated active state */
    html body .ai-cta-container button.emergency-phone-button:active,
    html body button.emergency-phone-button:active,
    html body .emergency-phone-button:active,
    body .emergency-phone-button:active,
    .emergency-phone-button:active {
      background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%) !important;
      border-color: rgba(255, 255, 255, 0.2) !important;
      color: #111827 !important;
      transform: translateY(0) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Focus state for accessibility */
    .emergency-phone-button:focus {
      outline: 2px solid #93c5fd !important;
      outline-offset: 2px !important;
    }
    
    /* VERCEL-STYLE CLEAN PHONE COMPONENT */
    .phone-component-container {
      position: relative !important;
      width: 100% !important;
      max-width: 400px !important;
      height: 80px !important; /* Accommodate input + status message */
      margin: 2rem auto !important;
    }
    
    /* Shared transition for all elements */
    .transition-element {
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out !important;
    }
    
    /* Visible state */
    .fade-in {
      opacity: 1 !important;
      transform: translateY(0) !important;
      pointer-events: auto !important;
    }
    
    /* Hidden state */
    .fade-out {
      opacity: 0 !important;
      transform: translateY(5px) !important;
      pointer-events: none !important;
    }
    
    /* PROFESSIONAL BUTTON - MATCHES YOUR SITE DESIGN */
    .cta-button {
      width: 100% !important;
      height: 48px !important;
      padding: 0 24px !important;
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
      color: #1f2937 !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      cursor: pointer !important;
      transition: all 0.2s ease-in-out !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 10px !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
      outline: none !important;
      letter-spacing: -0.01em !important;
    }
    
    .cta-button:hover {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* ULTRA-NUCLEAR OVERRIDES - ELIMINATE BLACK SQUARES/BARS IN CTA BUTTON */
    /* Maximum specificity overrides */
    .cta-button,
    .cta-button *,
    .cta-button span,
    .cta-button svg,
    .cta-button path,
    .phone-icon,
    .phone-icon * {
      /* ELIMINATE TEXT STROKE ISSUES */
      text-shadow: none !important;
      -webkit-text-stroke: 0 !important;
      -moz-text-stroke: 0 !important;
      text-stroke: 0 !important;
      -webkit-text-stroke-width: 0 !important;
      -webkit-text-stroke-color: transparent !important;
      
      /* FORCE PROPER FONT RENDERING */
      font-smooth: always !important;
      -webkit-font-smoothing: antialiased !important;
      -moz-osx-font-smoothing: grayscale !important;
      text-rendering: optimizeLegibility !important;
      
      /* ELIMINATE WEIRD APPEARANCE ISSUES */
      -webkit-appearance: none !important;
      -moz-appearance: none !important;
      appearance: none !important;
      
      /* FORCE VISIBILITY */
      opacity: 1 !important;
      visibility: visible !important;
      display: inherit !important;
      
      /* PREVENT BACKGROUND BLEEDING */
      background-clip: padding-box !important;
      -webkit-background-clip: padding-box !important;
      
      /* FORCE PROPER COLORS */
      color: inherit !important;
      fill: currentColor !important;
      stroke: currentColor !important;
    }
    
    /* ULTRA-SPECIFIC OVERRIDES - HIGHEST PRIORITY */
    #phoneComponentContainer #buttonContainer #ctaButton,
    #phoneComponentContainer #buttonContainer #ctaButton *,
    #phoneComponentContainer #buttonContainer #ctaButton span,
    #phoneComponentContainer #buttonContainer #ctaButton svg,
    #phoneComponentContainer #buttonContainer #ctaButton path,
    div.phone-component-container div.transition-element.fade-in button.cta-button,
    div.phone-component-container div.transition-element.fade-in button.cta-button *,
    div.phone-component-container div.transition-element.fade-in button.cta-button span,
    div.phone-component-container div.transition-element.fade-in button.cta-button svg {
      -webkit-text-stroke: 0 !important;
      -moz-text-stroke: 0 !important;
      text-stroke: 0 !important;
      -webkit-text-stroke-width: 0 !important;
      -webkit-text-stroke-color: transparent !important;
      text-shadow: none !important;
      color: inherit !important;
      fill: currentColor !important;
      stroke: currentColor !important;
      background-clip: padding-box !important;
      -webkit-background-clip: padding-box !important;
      pointer-events: auto !important;
      cursor: pointer !important;
      opacity: 1 !important;
      visibility: visible !important;
    }
    
    /* ENSURE CONTAINERS DON'T BLOCK CLICKS */
    #phoneComponentContainer,
    #buttonContainer,
    .phone-component-container,
    .transition-element.fade-in {
      pointer-events: auto !important;
      cursor: pointer !important;
      z-index: 10 !important;
      position: relative !important;
    }

    /* SPECIFIC SVG ICON FIXES */
    .phone-icon {
      width: 20px !important;
      height: 20px !important;
      color: #6b7280 !important;
    }
    
    /* DARK-THEMED FORM - MATCHES YOUR SITE */
    .phone-input-wrapper {
      position: relative !important;
      display: flex !important;
      align-items: center !important;
      width: 100% !important;
      height: 48px !important;
    }
    
    .phone-input {
      width: 100% !important;
      height: 48px !important;
      padding: 0 120px 0 20px !important; /* Space for Call Me button */
      background: #1f2937 !important;
      border: 1px solid #374151 !important;
      border-radius: 8px !important;
      color: #ffffff !important;
      font-size: 16px !important;
      font-weight: 500 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      outline: none !important;
      transition: all 0.2s ease-in-out !important;
      box-sizing: border-box !important;
    }
    
    .phone-input::placeholder {
      color: #9ca3af !important;
      font-weight: 400 !important;
    }
    
    .phone-input:focus {
      border-color: #3b82f6 !important;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1) !important;
    }
    
    .call-button {
      position: absolute !important;
      right: 6px !important;
      top: 50% !important;
      transform: translateY(-50%) !important;
      height: 36px !important;
      padding: 0 16px !important;
      background: #3b82f6 !important;
      color: #ffffff !important;
      border: none !important;
      border-radius: 6px !important;
      font-size: 14px !important;
      font-weight: 600 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      cursor: pointer !important;
      transition: all 0.2s ease-in-out !important;
      outline: none !important;
      white-space: nowrap !important;
    }
    
    .call-button:hover {
      background: var(--primary-black) !important;
    }
    
    .call-button:disabled {
      background: #6b7280 !important;
      cursor: not-allowed !important;
    }
    
    .status-message {
      position: absolute !important;
      top: 56px !important;
      left: 0 !important;
      right: 0 !important;
      font-size: 12px !important;
      text-align: center !important;
      height: 16px !important;
      transition: color 0.2s ease !important;
      color: #6b7280 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
    }
    
    .status-success {
      color: #22c55e !important;
    }
    
    .status-error {
      color: #ef4444 !important;
    }
    
    /* Professional phone form container - matches button position */
    .smart-phone-cta .phone-state {
      display: none;
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      margin: 0 !important;
    }
    
    .smart-phone-cta .phone-state.active {
      display: block !important;
    }
    
    /* Professional phone form layout */
    .professional-phone-form {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* PROFESSIONAL FORM - MATCHES BUTTON AESTHETIC */
    .phone-input-container {
      display: flex !important;
      align-items: center !important;
      gap: 12px !important;
      width: 100% !important;
      height: 60px !important;
      /* Match button's sophisticated gradient background */
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
      padding: 0 16px !important;
      box-sizing: border-box !important;
      /* Match button's professional shadow */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Professional phone input field */
    .professional-phone-input {
      flex: 1 !important;
      height: 44px !important;
      border: none !important;
      outline: none !important;
      font-size: 16px !important;
      font-weight: 500 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      color: #1f2937 !important;
      background: transparent !important;
      padding: 0 !important;
      letter-spacing: -0.01em !important;
    }
    
    .professional-phone-input::placeholder {
      color: #6b7280 !important;
      font-weight: 400 !important;
    }
    
    .professional-phone-input:focus {
      outline: none !important;
    }
    
    /* Sophisticated focus state */
    .phone-input-container:focus-within {
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%) !important;
      border-color: rgba(255, 255, 255, 0.3) !important;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2), 0 2px 6px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Professional call button - matches button style */
    .professional-call-btn {
      height: 44px !important;
      padding: 0 20px !important;
      /* Sophisticated dark button to contrast with light form */
      background: #374151 !important;
      color: #ffffff !important;
      border: none !important;
      border-radius: 6px !important;
      font-size: 14px !important;
      font-weight: 600 !important;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      white-space: nowrap !important;
      outline: none !important;
      letter-spacing: -0.01em !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    }
    
    .professional-call-btn:hover {
      background: #1f2937 !important;
      transform: translateY(-0.5px) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2) !important;
    }
    
    .professional-call-btn:active {
      background: #111827 !important;
      transform: translateY(0) !important;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    }

    /* Enhanced Professional Back Button */
    .professional-back-button, .back-button {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.9rem;
      font-weight: 500;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 2rem;
      background: rgba(0, 0, 0, 0.7);
    }
    
    .professional-back-button:hover, .back-button:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.3);
      color: rgba(255, 255, 255, 0.95);
      transform: translateX(-2px);
    }
    
    .back-icon {
      width: 1rem;
      height: 1rem;
      transition: transform 0.3s ease;
    }
    
    .professional-back-button:hover .back-icon, 
    .back-button:hover .back-icon {
      transform: translateX(-2px);
    }
    
    /* NUCLEAR OPTION: Global Text-Stroke Elimination */
    *, *::before, *::after {
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      text-shadow: none !important;
    }
    
    /* Force disable text-stroke on buttons specifically */
    button, .button, [type="submit"], .ai-discovery-cta, #submitPhoneButton {
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      text-shadow: none !important;
      outline: none !important;
    }
    
    /* Ultimate phone button fix - Maximum Nuclear Specificity */
    html body div .phone-form-container #submitPhoneButton {
      background: #ffffff !important;
      background-color: #ffffff !important;
      color: #1a1a1a !important;
      border: 1px solid rgba(0, 0, 0, 0.15) !important;
      padding: 1rem 2rem !important;
      font-size: 16px !important;
      font-weight: 600 !important;
      font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif !important;
      border-radius: 8px !important;
      -webkit-text-stroke: 0px transparent !important;
      text-stroke: 0px transparent !important;
      text-shadow: none !important;
      display: inline-block !important;
      visibility: visible !important;
      opacity: 1 !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
      text-decoration: none !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    }
    
    html body div .phone-form-container #submitPhoneButton:hover {
      background: #f8f8f8 !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    }

    /* Professional Back Button */
    .back-button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: transparent;
      border: none;
      color: rgba(255, 255, 255, 0.6);
      font-size: 14px;
      font-weight: 400;
      font-family: 'General Sans', -apple-system, sans-serif;
      cursor: pointer;
      padding: 0.5rem 0;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .back-button:hover {
      color: rgba(255, 255, 255, 0.9);
      transform: translateX(-2px);
    }
    
    .back-icon {
      width: 16px;
      height: 16px;
      transition: transform 0.3s ease;
    }
    
    .back-button:hover .back-icon {
      transform: translateX(-2px);
    }

    /* AI Success Message Styling - Mobile-First Responsive Design */
    .ai-success-message {
      display: none;
      /* Match button container dimensions for perfect alignment */
      width: calc(100% - 16px);
      max-width: 390px;
      margin: 1.5rem auto 0 auto; /* Perfect horizontal centering like button */
      animation: fadeIn 0.4s ease;
    }

    .ai-success-message.active {
      display: block;
    }

    /* Success Message Container - Professional Perfect Centering */
    .success-message-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0.75rem 0; /* Remove side padding for perfect text centering */
      background: var(--secondary-black);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 100%;
      box-sizing: border-box;
      margin: 0 auto; /* Ensure perfect centering */
      width: 100%; /* Force full width utilization */
    }

    /* Success Emoji - Responsive Sizing */
    .success-emoji {
      color: #4CAF50;
      font-size: 2rem; /* Mobile: smaller emoji */
      margin-bottom: 0.75rem;
      line-height: 1;
    }

    /* Success Heading - Clean Centering */
    .success-heading {
      color: var(--white);
      margin-bottom: 0.75rem;
      font-size: 1.25rem; /* Mobile: smaller heading */
      font-weight: 600;
      line-height: 1.3;
      text-align: center;
      display: block;
      width: 100%;
      margin-left: 0;
      margin-right: 0;
    }

    /* Success Text - Clean Simple Centering */
    .success-text {
      color: var(--grey);
      margin: 0 auto;
      font-size: 0.85rem;
      line-height: 1.3;
      text-align: center;
      display: block;
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      white-space: nowrap; /* Prevent line breaks for professional appearance */
    }

    /* Extra Small Mobile Optimization (320px-375px) */
    @media screen and (max-width: 375px) {
      .success-message-container {
        padding: 0.5rem; /* Consistent padding all around */
      }
      
      .success-text {
        font-size: 0.8rem; /* Even smaller text */
        line-height: 1.2;
        text-align: center;
        margin: 0 auto;
        display: block;
        width: 100%;
      }
      
      .success-heading {
        font-size: 1.1rem; /* Smaller heading for tiny screens */
        text-align: center;
        margin: 0 auto 0.75rem auto;
      }
      
      .success-emoji {
        font-size: 1.75rem; /* Smaller emoji */
        margin-bottom: 0.5rem;
        text-align: center;
      }
    }

    /* Tablet Responsive Design (768px+) */
    @media screen and (min-width: 768px) {
      .ai-success-message {
        max-width: 400px; /* Match button container max-width on tablet+ */
        margin: 1.5rem auto 0 auto; /* Maintain perfect centering */
      }
      
      .success-message-container {
        padding: 1rem 1.5rem 0.75rem 1.5rem; /* Tablet: moderate padding */
      }
      
      .success-emoji {
        font-size: 2.5rem; /* Tablet: medium emoji */
        margin-bottom: 1rem;
      }
      
      .success-heading {
        font-size: 1.375rem; /* Tablet: medium heading */
        margin-bottom: 1rem;
      }
      
      .success-text {
        font-size: 0.95rem; /* Tablet: medium text */
        text-align: center; /* Maintain centering on tablet */
      }
    }

    /* Desktop Responsive Design (1024px+) */
    @media screen and (min-width: 1024px) {
      .success-message-container {
        padding: 1rem 2rem 0.75rem 2rem; /* Desktop: original generous padding */
      }
      
      .success-emoji {
        font-size: 3rem; /* Desktop: large emoji */
      }
      
      .success-heading {
        font-size: 1.5rem; /* Desktop: large heading */
      }
      
      .success-text {
        font-size: 1rem; /* Desktop: standard text */
        text-align: center; /* Maintain centering on desktop */
      }
    }
    
    .submit-phone-button {
      width: 100%;
      padding: 1rem 2rem;
      background: var(--white);
      color: var(--primary-black);
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .submit-phone-button:hover {
      background: var(--grey);
      transform: translateY(-1px);
    }
    
    .submit-phone-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .ai-supporting-text {
      font-size: 0.875rem;
      color: var(--grey);
      margin-top: 1rem !important; /* Clean balanced spacing */
      margin-bottom: 1rem !important; /* Clean balanced spacing */
      line-height: 1.5;
    }
    
    /* Success State */
    .success-message {
      display: none;
      background: var(--secondary-black);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 1.5rem;
      margin-top: 1rem;
      text-align: center;
    }
    
    /* Premium Calendar Section */
    .cal-calendar-section {
      padding: 0.5rem 2rem 1.5rem 2rem;
      background-color: var(--primary-black);
      text-align: center;
      margin-top: 0;
    }
    
    .cal-calendar-section h3 {
      font-size: 1.375rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0;
      letter-spacing: -0.01em;
    }
    
    .calendar-subtext {
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 0.5rem;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.5;
    }
    
    .success-message.active {
      display: block;
      animation: slideUp 0.4s ease;
    }
    
    .success-icon {
      color: var(--white);
      width: 32px;
      height: 32px;
      margin: 0 auto 1rem;
    }
    
    .success-title {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--white);
      margin-bottom: 0.5rem;
    }
    
    .success-text {
      color: var(--grey);
      font-size: 0.875rem;
    }
    
    /* Footer Section - Premium Dark - Hidden by default, shown only on confirmation */
    .confirmation-footer {
      display: none; /* Hidden by default during calendar view */
      padding: 1.5rem 1.5rem 0.75rem 1.5rem; /* Balanced: 1.5rem top, 0.75rem bottom */
      background: var(--primary-black); /* Match site background */
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      text-align: center;
      margin-bottom: 0; /* Ensure no extra margin */
    }
    
    .footer-links {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      flex-wrap: wrap;
    }
    
    /* Import button styles from main site */
    .link-button {
      grid-column-gap: 3px;
      grid-row-gap: 3px;
      flex-flow: column;
      justify-content: flex-start;
      align-items: center;
      text-decoration: none;
      display: flex;
      overflow: hidden;
    }
    
    .button-link-wrapper {
      grid-column-gap: 5px;
      grid-row-gap: 5px;
      flex-flow: row;
      justify-content: flex-start;
      align-items: center;
      display: flex;
      position: relative;
    }
    
    .button-text-block {
      flex-flow: column;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 1rem;
      display: flex;
      position: relative;
      overflow: hidden;
    }
    
    .button-text {
      color: rgba(255, 255, 255, 0.6);
      text-transform: uppercase;
      white-space: nowrap;
      font-size: 12px;
      font-weight: 500;
      line-height: 1rem;
      transition: transform .3s cubic-bezier(.165, .84, .44, 1);
      display: flex;
      align-items: center;
      height: 1rem;
    }
    
    .button-text.is-hover {
      color: rgba(255, 255, 255, 0.8);
      position: absolute;
      top: 1rem;
    }
    
    .link-button:hover .button-text {
      transform: translateY(-100%);
    }
    
    .link-button:hover .button-text.is-hover {
      transform: translateY(-100%);
    }
    
    .arrow-button-block {
      justify-content: center;
      align-items: center;
      width: 1rem;
      height: 1rem;
      display: flex;
      position: relative;
      overflow: hidden;
    }
    
    .arrow-button {
      color: rgba(255, 255, 255, 0.6);
      width: 1rem;
      height: 1rem;
      display: block;
      position: absolute;
      inset: 0%;
      transition: transform .3s cubic-bezier(.165, .84, .44, 1);
    }
    
    .arrow-button._02 {
      color: rgba(255, 255, 255, 0.8);
      transform: translateX(-100%);
    }
    
    .link-button:hover .arrow-button._01 {
      transform: translateX(100%);
    }
    
    .link-button:hover .arrow-button._02 {
      transform: translateX(0);
    }
    
    .underline {
      background-color: rgba(255, 255, 255, 0.6);
      width: 100%;
      height: 1px;
      margin-top: 3px;
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
    }

    .underline.is-nav {
      background-color: rgba(255, 255, 255, 0.8);
    }
    
    .link-button:hover .underline {
      background-color: rgba(255, 255, 255, 0.8);
      transform: scaleX(1);
    }
    
    .footer-divider {
      width: 1px;
      height: 14px;
      background: rgba(255, 255, 255, 0.1);
      display: inline-block;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Responsive Styles */
    @media (max-width: 768px) {
      /* Stack step indicators vertically on mobile */
      .step-indicator {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
      }
      
      .step-indicator h2,
      .step-indicator h3 {
        text-align: center;
      }
      
      .ai-discovery-section {
        padding: 2rem 1.5rem; /* Reduced from 5rem for better mobile step spacing */
      }
      
      .ai-discovery-heading {
        font-size: 1.5rem;
      }
      
      .ai-discovery-subheading {
        font-size: 1rem;
      }
      
      .link-button.ai-discovery-cta,
      body .phone-form-container .ai-discovery-cta,
      body .phone-form-container button.ai-discovery-cta,
      body .phone-form-container #submitPhoneButton.ai-discovery-cta,
      body #submitPhoneButton {
        transform: scale(1) !important;
        display: inline-block !important;
        visibility: visible !important;
        background: #ffffff !important;
        background-color: #ffffff !important;
        color: #1a1a1a !important;
      }
      
      .footer-links {
        flex-direction: column;
        gap: 1rem;
      }
      
      .footer-divider {
        display: none;
      }
      
      .link-button {
        transform: scale(1);
        margin: 0.5rem 0;
      }
    }
    
    /* COMPREHENSIVE Background Fix - Zero White Backgrounds */
    html, body {
      background-color: var(--primary-black) !important; /* #0f0f0f */
      min-height: 100vh;
    }
    
    .page-wrapper {
      background-color: var(--primary-black) !important;
      min-height: 100vh;
    }
    
    /* Universal background enforcement for all containers */
    .page-wrapper *,
    main,
    section,
    header,
    footer {
      background-color: var(--primary-black) !important;
    }
    
    /* SURGICAL Cal.com Container Targeting - Fix ONLY White Background */
    /* Container styling consolidated above - targeting only wrapper divs */
    
    /* Target only the immediate wrapper divs, preserve Cal.com's internal styling */
    #my-cal-inline-30min > div:first-child {
      background-color: var(--primary-black) !important;
    }
    
    /* âœ… REMOVED SURGICAL TEXT OVERRIDES: 
     * User's original config with cal-brand: "#fafafa" handles text colors properly
     * No manual color overrides needed with month_view layout
     */
    
    /* âœ… REMOVED DESKTOP OVERLAY OVERRIDES:
     * month_view layout behaves differently than column_view
     * User's original configuration should handle overlays properly
     */
    
    /* PROFESSIONAL Cal.com Integration Best Practices 2024 */
    /* Professional loading states and error handling */
    
    /* Professional loading states */
    #my-cal-inline-30min[data-cal-loading="true"] {
      opacity: 0.8;
      pointer-events: none;
    }
    
    /* Enhanced Responsive Design for Professional Presentation */
    @media (max-width: 768px) {
      #my-cal-inline-30min {
        margin: 0;
        border-radius: 4px;
        padding: 0;
      }
    }
    
    @media (max-width: 480px) {
      #my-cal-inline-30min {
        border-radius: 0;
        margin: 0 -1rem; /* Extend to screen edges on small devices */
      }
    }
    
    /* Professional error handling */
    #my-cal-inline-30min .cal-error {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #f87171;
      padding: 1rem;
      border-radius: 6px;
      text-align: center;
    }
    
    /* Catch any remaining transparent backgrounds */
    *[style*="background: transparent"],
    *[style*="background-color: transparent"] {
      background-color: var(--primary-black) !important;
    }
    
    /* Target specific Cal.com generated containers */
    [data-cal-namespace],
    [data-cal-namespace] *,
    [class*="cal-"],
    [id*="cal-"] {
      background-color: var(--primary-black) !important;
    }
    
    /* Modern CSS eliminates the need for complex height overrides */
    
    /* ðŸŽ¯ PROFESSIONAL: Metadata-only approach - no customer-facing technical data */
  </style>
  <!-- Cookie Consent Styles -->
  <link href="css/cookie-consent.css" rel="stylesheet" type="text/css">
</head>

<body>

  <!-- Custom Loading Overlay - Replaces Cal.com Blue Redirect -->
  <div id="customLoadingOverlay" class="custom-loading-overlay">
    <div class="custom-loading-spinner"></div>
    <div class="custom-loading-text">Preparing Your Session</div>
    <div class="custom-loading-subtitle">Setting up your personalized automation strategy session...</div>
  </div>

  <div class="page-wrapper">
    <!-- Header Section -->
    <header class="calendar-header">
      <div class="padding-global">
        <div class="container-large">
          <h1>Book Your Strategy Session</h1>
          <p>Let's map your highest-impact automations together in this personalized 30-minute consultation.</p>
        </div>
      </div>
    </header>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
      <div class="progress-steps">
        <div class="progress-step">
          <div class="step-circle completed">âœ“</div>
          <span class="step-text">Assessment Complete</span>
        </div>
        <div class="step-divider"></div>
        <div class="progress-step active">
          <div class="step-circle">2</div>
          <span class="step-text">Book Your Session</span>
        </div>
      </div>
    </div>

    <!-- Personalized Message Section -->
    <div class="personalized-message" id="personalized-message" style="display: none;">
      <p class="personalized-text" id="personalized-text">
        <!-- Personalized message will be populated via JavaScript -->
      </p>
      <div class="calendar-divider"></div>
    </div>
    

    <!-- Calendar Section - Official Cal.com Inline Embed -->
    <main class="calendar-container">
      <!-- Cal inline embed code begins -->
      <div style="width:100%;height:100%;overflow:scroll" id="my-cal-inline-30min"></div>
      <script type="text/javascript">
        // Initialize Cal.com with questionnaire data (using Cal loader from header)
        document.addEventListener('DOMContentLoaded', function() {
          // CRITICAL: Initialize Cal.com (this was missing!)
          console.log('ðŸš€ Initializing Cal.com...');
          Cal("init");
          
          // CRITICAL FIX: Check schedule_another parameter FIRST (from current URL)
          const currentUrl = new URL(window.location.href);
          const isSchedulingAnother = currentUrl.searchParams.get('schedule_another') === 'true';
          
          if (isSchedulingAnother) {
            console.log('ðŸ”„ SCHEDULE ANOTHER SESSION detected - Clearing ALL confirmation state');
            
            // Clear ALL confirmation state (comprehensive cleanup)
            localStorage.removeItem('confirmationViewed');
            localStorage.removeItem('bookingConfirmed');
            localStorage.removeItem('bookingTimestamp');
            localStorage.removeItem('bookingEventType');
            localStorage.removeItem('latestBookingData');
            
            sessionStorage.removeItem('confirmationPageActive');
            sessionStorage.removeItem('confirmationTimestamp');
            sessionStorage.removeItem('confirmationSource');
            
            // Clean the URL parameter
            const cleanUrl = new URL(window.location);
            cleanUrl.searchParams.delete('schedule_another');
            history.replaceState(null, null, cleanUrl.toString());
            
            console.log('âœ… All confirmation state cleared - User will see fresh Cal.com widget');
          }
          
          // CRITICAL FIX: Clear old booking states for form users BEFORE persistence check
          const referrer = document.referrer;
          const isFromForm = referrer && (referrer.includes('contact') || referrer.includes('index'));
          const isReload = !referrer || referrer === window.location.href;
          
          // PROFESSIONAL FIX: Only clear STALE booking state, preserve RECENT bookings
          if (isFromForm && !isSchedulingAnother && !isReload) {
            console.log('ðŸ§¹ FORM USER DETECTED - Checking if booking state is stale...');
            
            const bookingTimestamp = localStorage.getItem('bookingTimestamp');
            const now = Date.now();
            const oneHour = 60 * 60 * 1000; // 1 hour in milliseconds
            
            // Parse timestamp (handle both number strings and ISO strings)
            let timestamp = 0;
            if (bookingTimestamp) {
              const parsed = parseInt(bookingTimestamp);
              if (isNaN(parsed)) {
                // Fallback to ISO string parsing
                timestamp = new Date(bookingTimestamp).getTime();
              } else {
                timestamp = parsed;
              }
            }
            
            // Only clear if booking is old or doesn't exist
            if (!bookingTimestamp || (now - timestamp) > oneHour) {
              console.log('ðŸ§¹ Clearing STALE booking state (older than 1 hour)');
              
              // Clear ALL confirmation state (same as schedule_another cleanup)
              localStorage.removeItem('confirmationViewed');
              localStorage.removeItem('bookingConfirmed');
              localStorage.removeItem('bookingTimestamp');
              localStorage.removeItem('bookingEventType');
              localStorage.removeItem('latestBookingData');
              
              sessionStorage.removeItem('confirmationPageActive');
              sessionStorage.removeItem('confirmationTimestamp');
              sessionStorage.removeItem('confirmationSource');
              sessionStorage.removeItem('confirmationPriority');
              
              console.log('âœ… Stale booking state cleared - Fresh Cal.com widget will be shown');
            } else {
              console.log('âœ… RECENT booking detected - Preserving state for persistence');
            }
          }
          
          // SIMPLIFIED PERSISTENCE CHECK: Just check if we have confirmation flags
          const confirmationViewed = localStorage.getItem('confirmationViewed');
          const bookingConfirmed = localStorage.getItem('bookingConfirmed');
          
          // Enhanced debugging
          console.log('ðŸ” PERSISTENCE DEBUG:');
          console.log('  - isSchedulingAnother:', isSchedulingAnother);
          console.log('  - confirmationViewed:', confirmationViewed);
          console.log('  - bookingConfirmed:', bookingConfirmed);
          console.log('  - currentUrl:', window.location.href);
          console.log('  - referrer:', document.referrer || 'empty');
          
          // Simple logic: If we have confirmation flags and NOT scheduling another session, restore the page
          if (!isSchedulingAnother && (confirmationViewed === 'true' || bookingConfirmed === 'true')) {
            console.log('ðŸ”„ RELOAD PERSISTENCE: Confirmation page should be restored');
            console.log('ðŸ” Evidence: confirmationViewed =', confirmationViewed, 'bookingConfirmed =', bookingConfirmed);
            
            // Reset flags to ensure fresh creation
            window.confirmationPageCreated = false;
            window.bookingHandled = false;
            
            // Hide Cal.com elements immediately to prevent flash
            const calcomContainer = document.getElementById('my-cal-inline-30min');
            if (calcomContainer) {
              calcomContainer.style.display = 'none';
            }
            
            // Create confirmation page immediately with enhanced debugging
            console.log('ðŸ”„ Creating confirmation page for reload persistence...');
            try {
              window.createConfirmationPage({
                detail: {
                  source: 'reload_persistence',
                  isReload: true,
                  timestamp: localStorage.getItem('bookingTimestamp')
                }
              });
              console.log('âœ… Reload persistence: Confirmation page creation initiated');
              
              // Double-check that it was created successfully
              setTimeout(() => {
                const confirmationElement = document.querySelector('.enhanced-confirmation');
                if (confirmationElement) {
                  console.log('âœ… Reload persistence: Confirmation page verified');
                } else {
                  console.error('âŒ Reload persistence: Confirmation page not found after creation attempt');
                  // Retry once more
                  window.createConfirmationPage({
                    detail: {
                      source: 'reload_persistence_retry',
                      isReload: true,
                      timestamp: localStorage.getItem('bookingTimestamp')
                    }
                  });
                }
              }, 200);
              
              return; // Exit early - don't initialize Cal.com widget
            } catch (error) {
              console.error('âŒ Reload persistence failed:', error);
              // Clear failed state and continue to Cal.com initialization
              localStorage.removeItem('confirmationViewed');
              localStorage.removeItem('bookingConfirmed');
              console.log('ðŸ§¹ Cleared failed persistence state, proceeding to Cal.com...');
            }
            return; // Exit early for persistence
          }
          
          // Collect questionnaire data from localStorage (persistent) with sessionStorage fallback
          let questionnaireData = {};
          try {
            // Try localStorage first (survives page refresh)
            let storedData = localStorage.getItem('questionnaireData');
            if (!storedData) {
              // Fallback to sessionStorage for compatibility
              storedData = sessionStorage.getItem('questionnaireData');
              console.log('ðŸ“Š Using sessionStorage fallback (data may not persist on refresh)');
            } else {
              console.log('ðŸ“Š Using localStorage data (persistent across refresh)');
            }
            
            if (storedData) {
              questionnaireData = JSON.parse(storedData);
              console.log('ðŸ“Š Questionnaire data found:', questionnaireData);
            } else {
              console.log('âš ï¸ No questionnaire data found in localStorage or sessionStorage');
            }
          } catch (err) {
            console.log('âŒ Error loading questionnaire data:', err);
            console.log('Using defaults');
          }

          // REMOVED: Duplicate schedule_another handling - now handled at the beginning of DOMContentLoaded

          
          console.log('ðŸ“… âœ… PROCEEDING WITH CAL.COM INITIALIZATION');
          console.log('ðŸ“… âœ… Reason: Fresh form submission or no existing booking detected');
          
          // Prepare metadata for Cal.com
          const calMetadata = {
            name: questionnaireData.name || '',
            email: questionnaireData.email || '',
            company: questionnaireData.company || '',
            role: questionnaireData.role || '',
            teamSize: questionnaireData.teamSize || '',
            challenge: questionnaireData.challenge || '',
            budget: questionnaireData.budget || '',
            original_source: questionnaireData.original_source || 'direct',
            original_medium: questionnaireData.original_medium || 'none',
            original_campaign: questionnaireData.original_campaign || 'none',
            original_term: questionnaireData.original_term || '',
            original_content: questionnaireData.original_content || ''
          };
          
          console.log('ðŸ“Š Cal metadata prepared:', calMetadata);
          
          // Build prefill URL parameters  
          const prefillParams = new URLSearchParams();
          
          if (calMetadata.company) {
            prefillParams.append('Company', calMetadata.company);
          }
          if (calMetadata.role) {
            prefillParams.append('Your Role', calMetadata.role);
          }
          if (calMetadata.teamSize) {
            prefillParams.append('Team Size', calMetadata.teamSize);
          }
          if (calMetadata.challenge) {
            prefillParams.append('Primary Challenge', calMetadata.challenge);
          }
          if (calMetadata.budget) {
            prefillParams.append('Budget Range', calMetadata.budget);
          }
          
          // Add UTM parameters
          if (calMetadata.original_source !== 'direct') {
            prefillParams.append('utm_source', calMetadata.original_source);
          }
          if (calMetadata.original_medium !== 'none') {
            prefillParams.append('utm_medium', calMetadata.original_medium);
          }
          if (calMetadata.original_campaign !== 'none') {
            prefillParams.append('utm_campaign', calMetadata.original_campaign);
          }
          
          const calLinkWithPrefill = `nithichote/30min?${prefillParams.toString()}`;
          console.log('ðŸ”— Cal.com link with prefill:', calLinkWithPrefill);
          
          // Initialize Cal.com embed with proper error handling
          console.log('ðŸ”§ Checking Cal.com availability...');
          if (typeof Cal === 'undefined') {
            console.error('âŒ Cal is not defined - Cal.com script not loaded');
            return;
          }
          
          console.log('âœ… Cal.com script loaded, proceeding with initialization...');
          
          // OFFICIAL CAL.COM INITIALIZATION (Fixed with namespace and origin)
          // Note: Cal.ns becomes available AFTER this init call
          Cal("init", "30min", {origin:"https://app.cal.com"});
          
          console.log('ðŸŽ¯ Cal.com initialized, checking namespace availability...');
          
          // Wait a moment for namespace to be ready, then proceed
          setTimeout(() => {
            if (!Cal.ns || !Cal.ns["30min"]) {
              console.error('âŒ Cal.ns["30min"] not available after initialization');
              return;
            }
            
            console.log('âœ… Cal.ns["30min"] is ready, creating inline embed...');
            console.log('ðŸ“Š Metadata being passed to Cal.com:', calMetadata);
            console.log('ðŸ”— Cal link with prefill:', calLinkWithPrefill);
            
            // PROFESSIONAL CONFIG OBJECT - The metadata[key] syntax is critical
            const calConfig = {
              "layout":"month_view",
              // PROFESSIONAL METADATA APPROACH - Form data for webhook
              "metadata[company]": calMetadata.company || '',
              "metadata[role]": calMetadata.role || '',
              "metadata[teamSize]": calMetadata.teamSize || '',
              "metadata[challenge]": calMetadata.challenge || '',
              "metadata[budget]": calMetadata.budget || '',
              "metadata[original_source]": calMetadata.original_source || 'direct',
              "metadata[original_medium]": calMetadata.original_medium || 'none',
              "metadata[original_campaign]": calMetadata.original_campaign || 'none',
              "metadata[original_term]": calMetadata.original_term || '',
              "metadata[original_content]": calMetadata.original_content || '',
              // PREFILL FORM FIELDS for better UX
              "name": calMetadata.name || '',
              "email": calMetadata.email || ''
            };
            
            console.log('ðŸ”§ Cal.com config object:', calConfig);
            
            Cal.ns["30min"]("inline", {
              elementOrSelector:"#my-cal-inline-30min",
              config: calConfig,
              calLink: calLinkWithPrefill
            });
            
            // Apply theming after inline embed is created
            Cal.ns["30min"]("ui", {
              "cssVarsPerTheme": {
                "light": {
                  "cal-brand": "#292929"
                }
              },
              "hideEventTypeDetails": false,
              "layout": "month_view"
            });
            console.log('âœ… Cal.com theming applied');
            
          }, 100); // Small delay to allow namespace setup

          // CRITICAL FIX: Define handleBookingSuccess BEFORE Cal.com event listeners
          console.log('ðŸ”§ Defining booking success handler...');
          
          // ENHANCED: Unified booking success handler with comprehensive debugging
          window.handleBookingSuccess = function(e, eventType) {
            console.log('ðŸš¨ === BOOKING SUCCESS HANDLER TRIGGERED ===');
            console.log('ðŸ” Called with eventType:', eventType);
            console.log('ðŸ” Event object:', e);
            console.log('ðŸ” Current booking state:', {
              bookingHandled: window.bookingHandled,
              confirmationPageCreated: window.confirmationPageCreated,
              currentTimestamp: new Date().toISOString()
            });
            
            if (window.bookingHandled) {
              console.log('âš ï¸ Booking already handled, skipping duplicate');
              return;
            }
            
            console.log(`ðŸŽ¯ Processing booking completion via ${eventType}`);
            window.bookingHandled = true;
            
            // Set booking flags for homepage redirect detection
            const bookingTimestamp = Date.now().toString();
            localStorage.setItem('bookingConfirmed', 'true');
            localStorage.setItem('bookingTimestamp', bookingTimestamp);
            localStorage.setItem('bookingEventType', eventType);
            
            console.log('ðŸ’¾ Booking state saved to localStorage:', {
              bookingConfirmed: 'true',
              bookingTimestamp: bookingTimestamp,
              bookingEventType: eventType
            });
            
            // Store booking data if available
            if (e.detail?.data) {
              localStorage.setItem('latestBookingData', JSON.stringify(e.detail.data));
            }
            
            // ENHANCED: Extract and store attendee details for webhook correlation
            let attendeeData = {};
            
            // DEBUG: Log event structure for PostMessage events
            if (eventType === 'POSTMESSAGE') {
              console.log('ðŸ” POSTMESSAGE EVENT STRUCTURE:', {
                'e.data': e.data,
                'e.data.data': e.data?.data,
                'e.data.payload': e.data?.payload,
                'fullEvent': e
              });
              
              // DEEP DEBUG: Show exactly what's in the data
              console.log('ðŸ” DEEP DEBUG e.data:', JSON.stringify(e.data, null, 2));
              if (e.data?.data) {
                console.log('ðŸ” DEEP DEBUG e.data.data:', JSON.stringify(e.data.data, null, 2));
              }
            }
            
            // Try to extract from different event structures
            if (e.detail?.data?.attendees && e.detail.data.attendees.length > 0) {
              const attendee = e.detail.data.attendees[0];
              attendeeData = {
                email: attendee.email,
                name: attendee.name || `${attendee.firstName || ''} ${attendee.lastName || ''}`.trim(),
                bookingId: e.detail.data.bookingId || e.detail.data.id
              };
            } else if (e.detail?.attendees && e.detail.attendees.length > 0) {
              const attendee = e.detail.attendees[0];
              attendeeData = {
                email: attendee.email,
                name: attendee.name || `${attendee.firstName || ''} ${attendee.lastName || ''}`.trim(),
                bookingId: e.detail.bookingId || e.detail.id
              };
            } else if (e.data?.attendees && e.data.attendees.length > 0) {
              // FIXED: PostMessage event structure (e.data directly)
              const attendee = e.data.attendees[0];
              attendeeData = {
                email: attendee.email,
                name: attendee.name || `${attendee.firstName || ''} ${attendee.lastName || ''}`.trim(),
                bookingId: e.data.bookingId || e.data.id
              };
            } else if (eventType === 'POSTMESSAGE' && e.data?.data?.booking) {
              // FIXED: Cal.com PostMessage structure - data is in booking object
              const booking = e.data.data.booking;
              const name = booking.responses?.name ? 
                `${booking.responses.name.firstName || ''} ${booking.responses.name.lastName || ''}`.trim() :
                '';
              
              attendeeData = {
                email: booking.responses?.email || '',
                name: name,
                bookingId: booking.id
              };
              
              console.log('ðŸŽ¯ POSTMESSAGE: Extracted attendee data:', attendeeData);
            }
            
            // Store attendee data for webhook correlation
            if (attendeeData.email) {
              const calMetadata = {
                email: attendeeData.email,
                name: attendeeData.name,
                bookingId: attendeeData.bookingId,
                timestamp: bookingTimestamp
              };
              
              localStorage.setItem('cal_metadata', JSON.stringify(calMetadata));
              console.log('ðŸ’¾ Attendee data stored for webhook correlation:', calMetadata);
            } else {
              console.warn('âš ï¸ Could not extract attendee email from booking event:', e);
            }
            
            // Create dynamic confirmation page - IMMEDIATE RESPONSE
            console.log('ðŸ”„ IMMEDIATE: Creating dynamic confirmation page...');
            try {
              window.createConfirmationPage(e);
              console.log('âœ… createConfirmationPage called successfully');
            } catch (error) {
              console.error('âŒ Error calling createConfirmationPage:', error);
            }
          };
          
          // Set up Cal.com event listeners with proper API
          console.log('ðŸ”§ Setting up Cal.com event listeners...');
          
          // Set up Cal.com event listeners with error handling
          if (typeof Cal === 'function') {
            Cal("on", {
              action: "*", 
              callback: (e) => {
              console.log('ðŸŽ¯ === CAL.COM EVENT DETECTED ===');
              console.log('ðŸ” Event type:', e.type);
              console.log('ðŸ” Event detail:', e.detail);
              
              if (e.type === 'booking_successful' || e.type === 'bookingSuccessful') {
                if (!window.bookingHandled) {
                  console.log('ðŸŽ¯ BOOKING SUCCESS detected via Cal universal API');
                  window.handleBookingSuccess(e, 'CAL_UNIVERSAL_API');
                }
              }
            }
          });
          } else {
            console.error('âŒ Cal function not available for event listeners');
          }
          
          // Define booking observers function
          function setupBookingObservers() {
            console.log('ðŸ”§ Setting up additional booking detection methods...');
            
            // Activate text-based confirmation detection
            if (typeof setupConfirmationDetection === 'function') {
              setupConfirmationDetection();
              console.log('âœ… Text observer confirmation detection activated');
            } else {
              console.log('âš ï¸ setupConfirmationDetection not available');
            }
            
            // Add PostMessage listener for iframe communication
            window.addEventListener('message', function(event) {
              if (event.origin === 'https://app.cal.com' || event.origin === 'https://cal.com') {
                console.log('ðŸŽ¯ PostMessage from Cal.com:', event.data);
                if (event.data && (event.data.type === 'bookingSuccessful' || 
                    event.data.type === 'bookingSuccessfulV2' ||
                    event.data.type === 'booking_successful' ||
                    event.data.action === 'booking_confirmed')) {
                  console.log('ðŸŽ¯ BOOKING SUCCESS via PostMessage');
                  if (!window.bookingHandled) {
                    window.handleBookingSuccess(event, 'POSTMESSAGE');
                  }
                }
              }
            });
            
            console.log('âœ… Additional booking observers set up');
          }
          
          // Set up additional observers when Cal.com is ready
          setupBookingObservers();
          
          // Initialize form functionality on page load
          if (typeof initializeSmartPhoneCta === 'function') {
            initializeSmartPhoneCta();
          } else {
            console.log('âš ï¸ initializeSmartPhoneCta function not available yet');
          }
        });
        </script>
        
        <!-- ENHANCED: Professional confirmation page with dynamic video system -->
        <script type="text/javascript">
        // RESTORED: Function definition to fix syntax error
        // EARLY LOAD: Accordion function must be available immediately
        window.togglePrepItem = function(question, event) {
          console.log('ðŸŽ¯ Accordion clicked! Function is working!');
          
          // Prevent event bubbling and default behavior
          if (event) {
            event.preventDefault();
            event.stopPropagation();
          }
          
          try {
            const clickedItem = question.parentElement;
            const wasActive = clickedItem.classList.contains('active');
            
            console.log('ðŸ” Clicked item classes before:', clickedItem.className);
            console.log('ðŸ” Was active before:', wasActive);
            
            // Close ALL accordion items
            document.querySelectorAll('.prep-item').forEach(function(item) {
              item.classList.remove('active');
            });
            
            // Open clicked item if it wasn't active
            if (!wasActive) {
              clickedItem.classList.add('active');
              console.log('ðŸ” Clicked item classes after:', clickedItem.className);
              console.log('ðŸŽ¯ Accordion item opened successfully!');
              
              // Check if the answer div exists and its styles
              const answerDiv = clickedItem.querySelector('.prep-answer');
              if (answerDiv) {
                const computedStyle = window.getComputedStyle(answerDiv);
                console.log('ðŸ” Answer div found, grid-template-rows:', computedStyle.gridTemplateRows);
                console.log('ðŸ” Answer div display:', computedStyle.display);
              } else {
                console.log('âŒ No .prep-answer found in clicked item!');
              }
            } else {
              console.log('ðŸŽ¯ Accordion item closed!');
            }
          } catch (error) {
            console.error('âŒ Accordion error:', error);
          }
        };
        
        // CRITICAL FIX: Clean accordion state on page load
        window.cleanAccordionState = function() {
          console.log('ðŸ§¹ Cleaning accordion state - removing all active classes');
          const prepItems = document.querySelectorAll('.prep-item');
          prepItems.forEach(function(item) {
            item.classList.remove('active');
          });
          console.log('âœ… All accordion items reset to closed state');
        };
        
        // CRITICAL FIX: Define video function early to fix ordering issue
        window.initializeCustomVideoPlayer = function(userData) {
          console.log('ðŸŽ¬ === EARLY VIDEO INITIALIZATION ===');
          
          const videoPlayer = document.getElementById('professionalVideoPlayer');
          const mainVideo = document.getElementById('mainVideo');
          const videoSource = document.getElementById('videoSource');
          
          if (!videoPlayer || !mainVideo || !videoSource) {
            console.log('âŒ Video elements not found');
            return;
          }
          
          // Simple video path mapping
          const videoMapping = {
            'slow-processes': 'videos/strategy-blueprint.mp4',
            'missed-opportunities': 'videos/lead-saving-blueprint.mp4',
            'team-scaling': 'videos/team-automation-blueprint.mp4',
            'data-chaos': 'videos/data-organization-blueprint.mp4'
          };
          
          const challenge = userData?.challenge || 'missed-opportunities';
          const videoPath = videoMapping[challenge] || videoMapping['missed-opportunities'];
          
          console.log(`ðŸŽ¥ Setting video: ${videoPath} for challenge: ${challenge}`);
          
          // Set video source with proper MIME type and loading
          videoSource.src = videoPath;
          videoSource.type = 'video/mp4';
          mainVideo.src = videoPath;
          mainVideo.preload = 'metadata';
          
          // Professional iOS Video Player - Clean Implementation
          const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
          const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
          
          if (isIOS) {
            console.log('ðŸ“± iOS detected - applying clean video optimizations');
            
            // Essential iOS attributes for inline playback (NO native controls)
            mainVideo.setAttribute('playsinline', 'playsinline');
            mainVideo.setAttribute('webkit-playsinline', 'webkit-playsinline'); 
            mainVideo.setAttribute('muted', 'muted');
            // NOTE: NO controls attribute - we use custom overlay only
            
            // Prevent all iOS native behaviors
            mainVideo.style.webkitTouchCallout = 'none';
            mainVideo.style.webkitUserSelect = 'none';
            mainVideo.style.touchAction = 'manipulation';
            
            // Force hardware acceleration
            mainVideo.style.webkitTransform = 'translate3d(0, 0, 0)';
            mainVideo.style.webkitBackfaceVisibility = 'hidden';
            
            // Comprehensive fullscreen prevention
            mainVideo.addEventListener('webkitbeginfullscreen', function(e) {
              console.log('ðŸ“± iOS: Blocking fullscreen attempt');
              e.preventDefault();
              e.stopPropagation();
              return false;
            });
            
            mainVideo.addEventListener('webkitfullscreenchange', function(e) {
              if (mainVideo.webkitDisplayingFullscreen) {
                console.log('ðŸ“± iOS: Force exiting fullscreen');
                if (mainVideo.webkitExitFullscreen) {
                  mainVideo.webkitExitFullscreen();
                }
              }
            });
          } else {
            // Non-iOS devices get minimal controls for better compatibility
            mainVideo.removeAttribute('controls');
          }
          
          // YOUTUBE-STYLE SOLUTION: Extract first frame with blur effect
          console.log('ðŸŽ¬ Implementing YouTube-style first frame preview...');
          
          // Remove any existing poster to start fresh
          mainVideo.poster = '';
          
          // YouTube-style first frame extraction
          const extractFirstFrame = () => {
            return new Promise((resolve, reject) => {
              const canvas = document.createElement('canvas');
              const ctx = canvas.getContext('2d');
              
              const onCanPlay = () => {
                console.log('ðŸ“¹ Video can play - extracting first frame');
                
                // Set canvas dimensions to match video
                canvas.width = mainVideo.videoWidth || 640;
                canvas.height = mainVideo.videoHeight || 360;
                
                // Seek to a specific time to get a good frame (not black)
                mainVideo.currentTime = 0.5;
                
                const onSeeked = () => {
                  try {
                    // Draw the current frame to canvas
                    ctx.drawImage(mainVideo, 0, 0, canvas.width, canvas.height);
                    
                    // Apply YouTube-style blur effect for preview
                    ctx.filter = 'blur(3px)';
                    ctx.globalAlpha = 0.8;
                    ctx.drawImage(canvas, 0, 0);
                    
                    // Reset for overlay effects
                    ctx.filter = 'none';
                    ctx.globalAlpha = 1;
                    
                    // Add subtle dark overlay for play button visibility
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Convert to data URL and set as poster
                    const posterDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                    mainVideo.poster = posterDataUrl;
                    
                    console.log('âœ… YouTube-style first frame extracted and blurred');
                    resolve(posterDataUrl);
                    
                    // Reset video to beginning
                    mainVideo.currentTime = 0;
                    
                  } catch (error) {
                    console.log('âŒ Frame extraction failed:', error);
                    reject(error);
                  }
                  
                  mainVideo.removeEventListener('seeked', onSeeked);
                };
                
                mainVideo.addEventListener('seeked', onSeeked);
                mainVideo.removeEventListener('canplay', onCanPlay);
              };
              
              mainVideo.addEventListener('canplay', onCanPlay);
            });
          };
          
          // Try to extract first frame, fallback to minimal poster if video is corrupted
          extractFirstFrame().catch(() => {
            console.log('ðŸ”„ Video corrupted - using minimal fallback poster');
            
            // Minimal fallback for corrupted videos
            const canvas = document.createElement('canvas');
            canvas.width = 640;
            canvas.height = 360;
            const ctx = canvas.getContext('2d');
            
            // Simple dark background (like video loading state)
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, 640, 360);
            
            // Just a subtle loading indicator
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.fillRect(0, 0, 640, 360);
            
            const posterDataUrl = canvas.toDataURL('image/png');
            mainVideo.poster = posterDataUrl;
            
            console.log('ðŸ”„ Minimal fallback poster applied');
          });
          
          // Force reload to recognize new source
          mainVideo.load();
          
          // Add loading event handlers for better debugging
          mainVideo.addEventListener('loadstart', () => {
            console.log('ðŸ“¥ Video load started');
          });
          
          mainVideo.addEventListener('loadedmetadata', () => {
            console.log('ðŸ“Š Video metadata loaded - ready to play');
          });
          
          mainVideo.addEventListener('canplay', () => {
            console.log('â–¶ï¸ Video can start playing');
          });
          
          mainVideo.addEventListener('error', (e) => {
            console.error('âŒ Video error:', e);
            if (mainVideo.error) {
              console.error('Error details:', {
                code: mainVideo.error.code,
                message: mainVideo.error.message
              });
              
              // Provide professional fallback for corrupted video files
              console.log('ðŸ”„ Video file incompatible - showing professional placeholder');
              
              // Hide video and show informative message
              const videoPlayer = document.getElementById('professionalVideoPlayer');
              if (videoPlayer) {
                videoPlayer.innerHTML = `
                  <div style="
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    height: 100%;
                    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
                    border-radius: 12px;
                    color: white;
                    text-align: center;
                    padding: 2rem;
                  ">
                    <div>
                      <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸŽ¥</div>
                      <h3 style="margin: 0 0 0.5rem 0; font-size: 1.25rem;">Strategy Blueprint Video</h3>
                      <p style="margin: 0; color: #b4b4b4; font-size: 0.875rem;">
                        Video content will be available after our call<br/>
                        Your personalized strategy awaits!
                      </p>
                    </div>
                  </div>
                `;
              }
            }
          });
          
          console.log('âœ… YouTube-style video preview system initialized:', mainVideo.src);
          console.log('ðŸŽ¬ First frame extraction setup for challenge:', challenge);
        };
        
        window.createConfirmationPage = function(e) {
          console.log('ðŸš¨ === createConfirmationPage CALLED ===');
          console.log('ðŸ” Called from:', e?.detail?.source || 'unknown');
          console.log('ðŸ” Call stack:', new Error().stack);
          console.log('ðŸ” Event data:', e);
          console.log('ðŸŽ¯ Creating confirmation page...');
          
          // CRITICAL FIX: Check if already created, but allow retry for failed attempts
          if (window.confirmationPageCreated && document.querySelector('.enhanced-confirmation')) {
            console.log('âš ï¸ Confirmation page already created and visible, skipping...');
            return;
          }
          
          // Set flag early but will reset on error for retry capability
          const attemptStartTime = Date.now();
          console.log('ðŸ”„ Starting confirmation page creation attempt...');
          
          // Get page wrapper element for content replacement
          const pageWrapper = document.querySelector('.page-wrapper');
          if (!pageWrapper) {
            console.error('âŒ pageWrapper element not found');
            return;
          }
          console.log('âœ… pageWrapper element found');
          
          // Get stored user data for personalization
          let userData = {};
          try {
            // Try localStorage first (persistent), then sessionStorage (temporary)
            let storedData = localStorage.getItem('questionnaireData');
            if (!storedData) {
              storedData = sessionStorage.getItem('questionnaireData');
              console.log('ðŸ“Š Using sessionStorage fallback for confirmation');
            } else {
              console.log('ðŸ“Š Using localStorage data for confirmation');
            }
            
            if (storedData) {
              userData = JSON.parse(storedData);
              console.log('ðŸ“Š User data loaded for personalization:', userData);
            } else {
              console.log('âš ï¸ No user data found for personalization');
            }
          } catch (err) {
            console.log('âŒ Error loading user data for confirmation:', err);
          }

          // Video mapping for challenge-specific content
          const videoMap = {
            'manual-tasks': 'videos/manual-tasks-blueprint.mp4',
            'slow-processes': 'videos/strategy-blueprint.mp4', 
            'scaling-issues': 'videos/scaling-blueprint.mp4',
            'missed-opportunities': 'videos/lead-saving-blueprint.mp4'
          };
          const challengeType = userData.challenge || 'manual-tasks';
          const videoPath = videoMap[challengeType] || videoMap['manual-tasks'];
          console.log('ðŸŽ¥ Using video path:', videoPath, 'for challenge:', challengeType);
          
          // Create split messaging for better visual hierarchy
          const problemStatement = userData.challenge ? 
            `Ready to solve ${userData.challengeLabel || userData.challenge}?` : 
            'Ready for your strategy session?';
          const actionStatement = 'Complete the steps below:';
          
          // Create enhanced confirmation content with proper structure
          const enhancedContent = document.createElement('div');
          enhancedContent.className = 'enhanced-confirmation';
          enhancedContent.style.cssText = `
            width: 100% !important;
            margin: 0 auto !important;
            padding: 0 !important;
            box-sizing: border-box !important;
          `;
          
          // Create the PROPER dynamic confirmation page with all 3 steps
          enhancedContent.innerHTML = `
            <div class="confirmation-container">
              <div class="confirmation-success-badge">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22,4 12,14.01 9,11.01"></polyline>
                </svg>
                Strategy Session Confirmed
              </div>
              <h1 class="confirmation-heading">
                Your AI automation strategy session is confirmed
              </h1>
              <div class="confirmation-tagline">
                <span class="tagline-problem">${problemStatement}</span>
                <span class="tagline-action">${actionStatement}</span>
              </div>
              
              <!-- Step 1: Video Section -->
              <div class="confirmation-video">
                <div class="step-indicator">
                  <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">1</span>
                  <h3>Watch My Quick Message</h3>
                </div>
                <div class="professional-video-container">
                  <!-- Professional Cross-Device Video Player -->
                  <div class="professional-video-player" id="professionalVideoPlayer">
                    <!-- Universal Video Element with Device-Optimized Attributes -->
                    <video 
                      id="mainVideo"
                      class="main-video"
                      preload="metadata"
                      playsinline
                      webkit-playsinline
                      muted
                      poster="images/video-poster.jpg"
                      data-src-slow="videos/strategy-blueprint.mp4"
                      data-src-missed="videos/lead-saving-blueprint.mp4"
                      data-src-team="videos/team-automation-blueprint.mp4" 
                      data-src-data="videos/data-organization-blueprint.mp4"
                      style="width: 100%; height: auto; background: #000; aspect-ratio: 16/9;"
                    >
                      <source src="" type="video/mp4" id="videoSource">
                      Your browser does not support the video tag.
                    </video>
                    
                    <!-- Professional Overlay - Hidden on iOS via CSS -->
                    <div class="video-play-overlay" id="videoPlayOverlay" style="display: none;">
                      <button class="clean-play-button" id="cleanPlayButton" aria-label="Play personalized video">
                        â–¶
                      </button>
                      <div class="video-info">
                        <p class="video-caption">Click to play personalized video</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Divider -->
              <div class="section-divider"></div>
              
              <!-- Step 2: AI Discovery Section -->
              <div class="ai-discovery-section">
                <div class="ai-discovery-container">
                  <div class="step-indicator">
                    <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">2</span>
                    <h2 class="ai-discovery-heading">Start Your AI Discovery Call</h2>
                  </div>
                  
                  <p class="ai-discovery-subheading">
                    Spend 5 minutes with my AI assistant to identify your top automation opportunities before our call.
                  </p>
                  
                  <!-- Success Message (initially hidden) -->
                  <div class="ai-success-message" id="aiSuccessMessage">
                    <div class="success-message-container">
                      <div class="success-emoji">âœ…</div>
                      <h3 class="success-heading">AI Discovery Call Starting!</h3>
                      <p class="success-text">Call in 60 seconds!</p>
                    </div>
                  </div>
                  
                  <!-- Phone Component -->
                  <div id="phoneComponentContainer" style="position: relative; width: 100%; max-width: 400px; height: 84px; margin: 2.25rem auto 0.5rem auto; pointer-events: auto;">
                    <div id="buttonContainer" style="position: absolute; top: 0; left: 0; width: 100%; opacity: 1; transform: translateY(0); pointer-events: auto; transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out; z-index: 3;">
                      <button id="ctaButton" style="all: initial; display: flex; align-items: center; justify-content: center; gap: 4px; width: 100%; height: 48px; background: white; border: 1px solid #e5e5e5; border-radius: 8px; color: #333333; font-size: 13px; font-weight: 500; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; text-align: center; cursor: pointer; pointer-events: auto; -webkit-appearance: none; -moz-appearance: none; appearance: none; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; -webkit-text-stroke-width: 0; -webkit-text-stroke-color: transparent; text-shadow: none; outline: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.2s ease; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility; padding: 0 8px;">
                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: #333333;">
                          <path d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59533 1.99522 8.06814 2.16708 8.43999 2.48353C8.81184 2.79999 9.06334 3.23945 9.14999 3.72C9.31071 4.68007 9.58887 5.61273 9.97999 6.5C10.1018 6.80258 10.1445 7.13162 10.1044 7.45606C10.0642 7.78049 9.94218 8.09014 9.74999 8.35L8.52999 9.57C9.85999 12.0756 11.9544 14.17 14.46 15.5L15.68 14.28C15.9399 14.0878 16.2495 13.9658 16.574 13.9256C16.8984 13.8855 17.2274 13.9282 17.53 14.05C18.4173 14.4411 19.3499 14.7193 20.31 14.88C20.7955 14.9685 21.2387 15.2239 21.5547 15.5997C21.8707 15.9755 22.0397 16.4499 22.03 16.94L22 16.92Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Get AI Strategy Call in 60 Seconds
                      </button>
                    </div>
                    <div id="phoneFormContainer" style="position: absolute; top: 0; left: 0; width: 100%; height: 84px; opacity: 0; transform: translateY(5px); pointer-events: none; transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out; z-index: 5;">
                      <div style="position: relative; display: flex; align-items: stretch; width: 100%; height: 48px; gap: 8px;">
                        <input type="tel" id="phoneInput" placeholder="(555) 123-4567" maxlength="14" autocomplete="tel" pattern="[0-9\\s\\(\\)\\-]*" inputmode="numeric" style="flex: 1; height: 48px; padding: 0 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px 0 0 8px; color: white; font-size: 16px; font-weight: normal; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; cursor: text; pointer-events: auto; outline: none; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; text-shadow: none; box-sizing: border-box; z-index: 100;" />
                        <button type="button" id="callButton" style="height: 48px; background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.5); font-weight: 600; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; cursor: not-allowed; pointer-events: auto; display: flex; align-items: center; justify-content: center; -webkit-appearance: none; -moz-appearance: none; appearance: none; outline: none; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-sizing: border-box; z-index: 101; opacity: 0.6;"><span class="call-button-text">Call Me</span></button>
                      </div>
                      <p id="statusMessage" style="all: initial; color: rgba(255, 255, 255, 0.6); font-size: 12px; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; margin: 12px 0 0 0; text-align: center; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; text-shadow: none; line-height: 1.4; min-height: 24px; box-sizing: border-box;"></p>
                    </div>
                  </div>
                  
                  <p class="ai-supporting-text">
                    <strong>Why this matters:</strong> 73% of my most successful implementations started with this AI discovery call. You'll arrive to your strategy session with clarity, not confusion.
                  </p>
                </div>
              </div>
              
              <!-- Section Divider -->
              <div class="section-divider"></div>

              <!-- Step 3: Meeting Details & Preparation -->
              <div class="ai-discovery-section">
                <div class="ai-discovery-container">
                  <div class="step-indicator">
                    <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">3</span>
                    <h2 class="ai-discovery-heading">Meeting Confirmed</h2>
                  </div>
                  
                  <p class="ai-discovery-subheading">
                    You'll receive a calendar invitation and meeting details at your email shortly.
                  </p>
                  
                  <!-- Professional Preparation Accordion -->
                  <div class="prep-section">
                    <h3 class="prep-title">How to Prepare</h3>
                    <div class="prep-accordion">
                      <div class="prep-item">
                        <div class="prep-question">
                          <span>Review your current software tools</span>
                          <span class="prep-toggle">+</span>
                        </div>
                        <div class="prep-answer">
                          <div class="prep-answer-content">
                            <p>Make a note of the 3-5 software tools or platforms you use daily in your business. This could include your CRM, email platform, project management tool, accounting software, or communication apps. Knowing your current tech stack helps me design automations that work seamlessly with what you already use.</p>
                          </div>
                        </div>
                      </div>
                      <div class="prep-item">
                        <div class="prep-question">
                          <span>Identify what takes up most of your time</span>
                          <span class="prep-toggle">+</span>
                        </div>
                        <div class="prep-answer">
                          <div class="prep-answer-content">
                            <p>Think about what tasks eat up most of your time each week. Consider things like responding to emails, updating spreadsheets, scheduling meetings, following up with leads, or preparing reports. These time drains are often the highest-impact automation opportunities.</p>
                          </div>
                        </div>
                      </div>
                      <div class="prep-item">
                        <div class="prep-question">
                          <span>Think about tasks you do the same way repeatedly</span>
                          <span class="prep-toggle">+</span>
                        </div>
                        <div class="prep-answer">
                          <div class="prep-answer-content">
                            <p>Consider 2-3 tasks you do the exact same way every time. Examples: sending welcome emails to new clients, creating invoices, updating project status, or organizing files. These predictable workflows are perfect candidates for complete automation.</p>
                          </div>
                        </div>
                      </div>
                      <div class="prep-item">
                        <div class="prep-question">
                          <span>Consider what you wish happened automatically</span>
                          <span class="prep-toggle">+</span>
                        </div>
                        <div class="prep-answer">
                          <div class="prep-answer-content">
                            <p>Come ready with 2-3 things you wish happened automatically in your business. Maybe it's instant lead follow-up, automatic data backup, or notifications when important events happen. Having specific wishes helps me prioritize which automations will make the biggest impact for you.</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Email Button -->
                  <div class="minimal-contact">
                    <a href="mailto:hi@nithichote.com?subject=Meeting Question" class="link-button w-inline-block">
                      <div class="button-link-wrapper">
                        <div class="button-text-block">
                          <div class="button-text">Questions? Email Me</div>
                          <div class="button-text is-hover">QUESTIONS? EMAIL ME</div>
                        </div>
                      </div>
                      <div class="underline is-nav"></div>
                    </a>
                  </div>
                </div>
              </div>
              
              <!-- Bottom Navigation Bar -->
              <footer class="confirmation-footer" style="display: block !important; padding: 1.5rem 1.5rem 0.75rem 1.5rem; background: var(--primary-black); border-top: 1px solid rgba(255, 255, 255, 0.05); text-align: center;">
                <div class="footer-links">
                  <a href="/" class="link-button w-inline-block">
                    <div class="button-link-wrapper">
                      <div class="button-text-block">
                        <div class="button-text is-hover">BACK TO HOMEPAGE</div>
                        <div class="button-text">BACK TO HOMEPAGE</div>
                      </div>
                      <div class="arrow-button-block">
                        <div class="arrow-button _01 w-embed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                          </svg></div>
                        <div class="arrow-button _02 w-embed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                          </svg></div>
                      </div>
                    </div>
                    <div class="underline is-nav"></div>
                  </a>
                </div>
              </footer>
            </div>
          `;
          
          // Insert the confirmation page
          pageWrapper.innerHTML = '';
          pageWrapper.appendChild(enhancedContent);
          
          // CRITICAL: Inject comprehensive CSS styles for dynamic confirmation page
          const confirmationCSS = document.createElement('style');
          confirmationCSS.id = 'dynamic-confirmation-styles';
          confirmationCSS.textContent = `
            /* RESTORED ORIGINAL: Professional Booking Confirmation - Dynamic Page Styles */
            .enhanced-confirmation {
              min-height: 100vh;
              background: var(--primary-black, #0f0f0f);
              color: var(--white, white);
              font-family: 'General Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              line-height: 1.6;
              position: relative;
              display: block;
              visibility: visible;
              opacity: 1;
            }

            /* Confirmation Page Structure - Original Professional Spacing */
            .confirmation-container {
              max-width: 1000px;
              width: 100%;
              padding: 4rem 2rem 2rem 2rem;
              text-align: center;
              margin: 0 auto;
              position: relative;
            }

            .confirmation-success-badge {
              display: inline-flex;
              align-items: center;
              gap: 0.5rem;
              background: rgba(74, 222, 128, 0.1);
              color: #4ade80;
              padding: 0.75rem 1.5rem;
              border-radius: 50px;
              font-size: 0.875rem;
              font-weight: 500;
              margin: 0 auto 2rem auto;
            }

            .confirmation-heading {
              font-size: clamp(2.5rem, 5vw, 3rem);
              font-weight: 700;
              margin: 0 0 1rem 0;
              letter-spacing: -0.02em;
              color: var(--white, white);
              line-height: 1.2;
            }

            .confirmation-tagline {
              font-size: 1.25rem;
              margin: 0 0 3rem 0;
              max-width: 800px;
              margin-left: auto;
              margin-right: auto;
              line-height: 1.4;
              text-align: center;
            }

            .tagline-problem {
              color: rgba(255, 255, 255, 0.9);
              font-weight: 500;
              letter-spacing: -0.01em;
              display: block;
              margin-bottom: 0.5rem;
            }

            .tagline-action {
              color: rgba(255, 255, 255, 0.6);
              font-weight: 400;
              font-size: 1.125rem;
              letter-spacing: 0;
            }

            /* Step Structure - Original Clean Design */
            .step-indicator {
              display: flex;
              align-items: center;
              gap: 0.75rem;
              margin-bottom: 1rem;
              justify-content: center;
            }

            .step-number-badge {
              width: 32px;
              height: 32px;
              background: transparent;
              border: 1px solid rgba(255, 255, 255, 0.3);
              border-radius: 50%;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1rem;
              font-weight: 600;
              color: rgba(255, 255, 255, 0.8);
              flex-shrink: 0;
            }

            .step-indicator h2, .step-indicator h3 {
              margin: 0;
              font-size: 1.375rem !important;
              font-weight: 600;
              color: var(--white);
              letter-spacing: -0.01em;
            }

            /* Video Player Styles - Perfect Balance */
            .confirmation-video {
              margin: 2rem 0 2rem 0 !important; /* 2rem above and below for proper spacing */
            }
            
            /* iPad specific video sizing */
            @media (min-width: 768px) and (max-width: 1024px) {
              .professional-video-player {
                max-width: 1024px !important;
              }
            }
            
            /* Universal Cross-Device Video System - Netflix/YouTube 2025 Standard */
            .professional-video-player {
              position: relative;
              max-width: min(100vw - 2rem, 1200px);
              margin: 0 auto;
              aspect-ratio: 16/9;
              background: #000;
              border-radius: 12px;
              overflow: hidden;
              transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            }
            
            /* Professional video element styling */
            .professional-video-player video {
              width: 100% !important;
              height: 100% !important;
              object-fit: cover;
              background: #000;
              border-radius: inherit;
            }
            
            /* Device-Specific Optimizations */
            
            /* Large Desktop (>1400px) */
            @media (min-width: 1400px) {
              .professional-video-player {
                max-width: 1200px;
              }
            }
            
            /* Desktop (1024px - 1400px) */ 
            @media (min-width: 1024px) and (max-width: 1400px) {
              .professional-video-player {
                max-width: min(90vw, 1000px);
              }
            }
            
            /* Tablet Landscape (768px - 1024px) */
            @media (min-width: 768px) and (max-width: 1024px) {
              .professional-video-player {
                max-width: min(95vw, 800px);
                border-radius: 10px;
              }
            }
            
            /* Tablet Portrait & Large Mobile (480px - 768px) */
            @media (min-width: 480px) and (max-width: 768px) {
              .professional-video-player {
                max-width: calc(100vw - 1rem);
                margin: 0 0.5rem;
                border-radius: 8px;
                box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
              }
            }
            
            /* Small Mobile (<480px) */
            @media (max-width: 480px) {
              .professional-video-player {
                max-width: 100vw;
                margin: 0;
                border-radius: 6px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
              }
            }
            
            /* iOS Safari Detection via CSS - Hide overlay immediately */
            @supports (-webkit-touch-callout: none) {
              .video-play-overlay {
                display: none !important;
              }
              
              #mainVideo {
                controls: initial !important;
              }
            }
            
            /* Performance & Accessibility Optimizations */
            
            /* Reduce motion for users who prefer it */
            @media (prefers-reduced-motion: reduce) {
              .professional-video-player {
                transition: none;
              }
              
              .video-play-overlay {
                animation: none;
              }
            }
            
            /* High contrast mode support */
            @media (prefers-contrast: high) {
              .professional-video-player {
                border: 2px solid white;
              }
              
              .video-play-overlay {
                background: rgba(0, 0, 0, 0.9);
                border: 1px solid white;
              }
            }
            
            /* Touch device optimizations */
            @media (hover: none) and (pointer: coarse) {
              .professional-video-player {
                /* Larger touch targets for mobile */
              }
              
              .clean-play-button {
                min-width: 44px;
                min-height: 44px;
                padding: 12px;
              }
            }
            
            /* Professional loading states */
            .professional-video-player[data-loading="true"] {
              opacity: 0.7;
            }
            
            .professional-video-player[data-loading="true"]::after {
              content: '';
              position: absolute;
              top: 50%;
              left: 50%;
              width: 24px;
              height: 24px;
              margin: -12px 0 0 -12px;
              border: 2px solid rgba(255, 255, 255, 0.3);
              border-top: 2px solid white;
              border-radius: 50%;
              animation: spin 1s linear infinite;
            }
            
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }

            .professional-video-container {
              max-width: 700px;
              margin: 0 auto;
              position: relative;
            }

            .professional-video-player {
              position: relative;
              background: #000; /* Pure black for professional video player look */
              border: 1px solid var(--border, #b4b4b414);
              border-radius: 8px; /* Subtle rounding for modern feel */
              overflow: hidden;
              aspect-ratio: 16/9;
              /* Prevent iOS touch behaviors */
              -webkit-touch-callout: none;
              -webkit-user-select: none;
              touch-action: manipulation;
              /* Smooth performance */
              will-change: transform;
            }

            .main-video {
              width: 100%;
              height: 100%;
              object-fit: cover;
              display: block;
            }

            .video-play-overlay {
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              background: rgba(0, 0, 0, 0.3);
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              cursor: pointer;
              transition: all 0.3s ease;
            }

            .video-play-overlay:hover {
              background: rgba(0, 0, 0, 0.5);
            }

            .clean-play-button {
              width: 4rem;
              height: 4rem;
              border-radius: 50%;
              background: var(--white, white);
              border: none;
              color: var(--primary-black, #0f0f0f);
              font-size: 1.5rem;
              display: flex;
              align-items: center;
              justify-content: center;
              cursor: pointer;
              transition: all 0.3s ease;
              margin-bottom: 1rem;
            }

            .clean-play-button:hover {
              transform: scale(1.1);
            }

            .video-info {
              text-align: center;
            }

            .video-caption {
              color: var(--white, white);
              font-size: 0.875rem;
              margin: 0;
            }

            /* Professional iOS Video Solution - Embrace Native Controls */
            @supports (-webkit-touch-callout: none) {
              /* Enable smooth iOS video performance */
              .main-video {
                -webkit-transform: translate3d(0, 0, 0);
                -webkit-backface-visibility: hidden;
              }
              
              /* Style custom overlay for non-iOS devices */
              .video-play-overlay {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
              }
              
              .clean-play-button {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
              }
              
              /* Professional video container */
              .professional-video-player {
                -webkit-touch-callout: none;
                -webkit-user-select: none;
              }
            }

            /* Mobile responsive spacing adjustments */
            @media (max-width: 767px) {
              .confirmation-video {
                margin: 1.5rem 0 1.5rem 0 !important; /* Balanced mobile spacing */
              }
              
              .section-divider {
                margin: 0.75rem auto;
              }
              
              .step-indicator {
                margin-bottom: 0.75rem; /* Consistent mobile spacing */
              }
              
              .professional-video-player {
                border-radius: 6px; /* Slightly less rounding on mobile */
              }
            }

            @media (max-width: 479px) {
              .confirmation-video {
                margin: 1rem 0 1rem 0 !important; /* Even tighter on very small screens */
              }
              
              .section-divider {
                margin: 0.5rem auto;
              }
              
              .step-indicator {
                margin-bottom: 0.5rem;
              }
            }

            /* AI Discovery Section - Original Spacing */
            .ai-discovery-section {
              padding: 4rem 2rem;
              background-color: var(--primary-black);
              position: relative;
              overflow: hidden;
              display: block;
              visibility: visible;
              opacity: 1;
              min-height: 200px;
            }

            .ai-discovery-container {
              max-width: 1000px;
              margin: 0 auto;
              position: relative;
              z-index: 1;
            }

            .ai-discovery-heading {
              font-size: 2rem;
              font-weight: 600;
              color: var(--white);
              margin-bottom: 0.75rem;
              line-height: 1.2;
              letter-spacing: -0.02em;
              text-align: center;
              display: block;
              visibility: visible;
            }

            .ai-discovery-subheading {
              font-size: 1.125rem;
              color: rgba(255, 255, 255, 0.6);
              margin-bottom: 2.5rem;
              line-height: 1.4;
              max-width: 600px;
              margin-left: auto;
              margin-right: auto;
              text-align: center;
            }

            .ai-supporting-text {
              font-size: 0.875rem;
              color: var(--grey, #b4b4b4);
              margin: 1.5rem 0 0 0;
              text-align: center;
            }

            /* Section Dividers - Original Style */
            .section-divider {
              height: 1px;
              background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
              width: 80%;
              margin: 1rem auto; /* Reduced for perfect balance */
            }

            /* Accordion Styles - Original Professional Design */
            .prep-section {
              margin: 2rem 0;
              text-align: left;
            }

            .prep-title {
              font-size: 1.125rem;
              font-weight: 600;
              color: var(--white, white);
              margin: 0 0 1.5rem 0;
              text-align: center;
            }

            .prep-accordion {
              max-width: 100%;
              margin: 0 auto;
              text-align: left;
            }

            .prep-item {
              margin-bottom: 0;
              background: transparent;
              border: none;
              border-bottom: 1px solid rgba(255, 255, 255, 0.1);
              overflow: hidden;
              transition: background-color 0.2s ease;
            }

            .prep-item:first-child {
              border-top: 1px solid rgba(255, 255, 255, 0.1);
            }

            .prep-question {
              padding: 1.5rem 0;
              cursor: pointer;
              display: flex;
              justify-content: space-between;
              align-items: center;
              color: rgba(255, 255, 255, 0.9);
              font-size: 1rem;
              font-weight: 400;
              letter-spacing: -0.02em;
              line-height: 1.3;
              transition: color 0.2s ease;
              font-family: General Sans, Arial, sans-serif;
            }

            .prep-question:hover {
              color: rgba(255, 255, 255, 1);
            }

            .prep-toggle {
              font-size: 1.2rem;
              color: rgba(255, 255, 255, 0.4);
              transition: transform 0.25s ease-out, color 0.2s ease;
              line-height: 1;
              font-weight: 300;
              transform-origin: center center;
              will-change: transform;
            }

            .prep-item:hover .prep-toggle {
              color: rgba(255, 255, 255, 0.6);
            }

            .prep-item.active .prep-question {
              color: #fff;
            }

            .prep-item.active .prep-toggle {
              color: #fff;
              transform: rotate(45deg);
            }

            .prep-answer {
              display: grid;
              grid-template-rows: 0fr;
              transition: grid-template-rows 0.25s ease-out;
              color: rgba(255, 255, 255, 0.6);
              line-height: 1.6;
              font-size: 0.95rem;
              margin: 0;
              padding: 0;
            }

            .prep-answer-content {
              overflow: hidden;
              min-height: 0;
              padding: 0;
              margin: 0;
              opacity: 0;
              transform: scale(0.98);
              transition: opacity 0.25s ease-out, transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .prep-item.active .prep-answer {
              grid-template-rows: 1fr;
            }

            .prep-item.active .prep-answer-content {
              padding: 0 0 1.5rem 0;
              opacity: 1;
              transform: scale(1);
            }

            .prep-answer p {
              margin: 0;
              font-family: General Sans, Arial, sans-serif;
            }

            /* Button Styles - Original Professional Design */
            .minimal-contact {
              margin: 2rem 0;
              text-align: center;
            }

            .link-button {
              grid-column-gap: 3px;
              grid-row-gap: 3px;
              flex-flow: column;
              justify-content: flex-start;
              align-items: center;
              text-decoration: none;
              display: flex;
              overflow: hidden;
              cursor: pointer;
            }

            .button-link-wrapper {
              grid-column-gap: 5px;
              grid-row-gap: 5px;
              flex-flow: row;
              justify-content: flex-start;
              align-items: center;
              display: flex;
              position: relative;
            }

            .button-text-block {
              flex-flow: column;
              justify-content: flex-start;
              align-items: center;
              height: 14px;
              display: flex;
              position: relative;
              overflow: hidden;
            }

            .button-text {
              color: var(--grey, #b4b4b4);
              text-transform: uppercase;
              white-space: nowrap;
              font-size: 14px;
              font-weight: 500;
              line-height: 1;
              transition: transform 0.3s ease;
              transform: translateY(0);
            }

            .button-text.is-hover {
              color: var(--grey, #b4b4b4);
              transition: transform 0.3s ease;
              transform: translateY(-100%);
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
            }

            .underline {
              background-color: var(--grey, #b4b4b4);
              width: 100%;
              height: 1px;
              margin-top: 1px;
              transform: scaleX(1);
              transform-origin: right;
              transition: transform 0.3s ease;
            }

            .underline.is-nav {
              background-color: var(--grey, #b4b4b4);
            }

            .link-button:hover .underline {
              transform: scaleX(0);
              transform-origin: right;
            }

            .link-button:hover .button-text {
              transform: translateY(100%);
            }

            .link-button:hover .button-text.is-hover {
              transform: translateY(0);
            }

            /* Confirmation Footer */
            .confirmation-footer {
              padding: 1.5rem 1.5rem 0.75rem 1.5rem;
              background: var(--primary-black);
              border-top: 1px solid rgba(255, 255, 255, 0.05);
              text-align: center;
              display: block !important;
            }

            /* Mobile Responsive - Original Design */
            @media (max-width: 768px) {
              .step-indicator {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem;
              }
              
              .step-indicator h2,
              .step-indicator h3 {
                text-align: center;
              }
              
              .ai-discovery-section {
                padding: 3rem 1.5rem;
              }
              
              .ai-discovery-heading {
                font-size: 1.5rem;
              }
              
              .confirmation-container {
                padding: 3rem 1.5rem 1.5rem 1.5rem;
              }
              
              .confirmation-heading {
                font-size: clamp(2rem, 6vw, 2.5rem);
                margin: 0 0 0.75rem 0;
              }
              
              .confirmation-tagline {
                font-size: 1.1rem;
                margin: 0 0 2rem 0;
              }
            }

            @media (max-width: 479px) {
              .confirmation-container {
                padding: 2rem 1rem 1rem 1rem;
              }
              
              .confirmation-heading {
                font-size: clamp(1.5rem, 7vw, 2rem);
                margin: 0 0 0.5rem 0;
              }
              
              .confirmation-tagline {
                font-size: 1rem;
                margin: 0 0 1.5rem 0;
              }
              
              .ai-discovery-section {
                padding: 2rem 1rem;
              }
              
              .ai-discovery-heading {
                font-size: 1.25rem;
              }
              
              .button-text {
                font-size: 12px;
              }
            }
          `;
          document.head.appendChild(confirmationCSS);
          console.log('âœ… Dynamic confirmation CSS styles injected');
          
          // Set session storage for persistence
          sessionStorage.setItem('confirmationPageActive', 'true');
          sessionStorage.setItem('confirmationTimestamp', Date.now().toString());
          sessionStorage.setItem('confirmationSource', e?.detail?.source || 'unknown');
          
          console.log('âœ… Enhanced confirmation page created successfully');
          window.confirmationPageCreated = true;
          
          // CRITICAL FIX: Remove loading state to show confirmation page
          document.body.classList.remove('confirmation-loading');
          console.log('ðŸ”„ Loading state removed - confirmation page now visible');
          
          // CRITICAL: Add missing JavaScript functions for confirmation page interactivity
          window.initializeConfirmationPageInteractivity = function() {
            console.log('ðŸš€ Initializing confirmation page interactivity...');
            
            // 1. Initialize Video Player
            const videoPlayer = document.getElementById('mainVideo');
            const playButton = document.getElementById('cleanPlayButton');
            const playOverlay = document.getElementById('videoPlayOverlay');
            
            if (videoPlayer) {
              console.log('âœ… Universal video player found, initializing cross-device system...');
              
              // PROFESSIONAL: Universal Video Architecture (Netflix/YouTube 2025 Standard)
              const VideoArchitecture = {
                // Device Detection with Capabilities
                detectDevice() {
                  const ua = navigator.userAgent;
                  const isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;
                  const isAndroid = /Android/i.test(ua);
                  const isMobile = /Mobi|Android/i.test(ua);
                  const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                  
                  return { isIOS, isAndroid, isMobile, isTouch, ua };
                },
                
                // Video Configuration by Device
                getConfig(device) {
                  if (device.isIOS) {
                    return {
                      strategy: 'native_only',
                      controls: true,
                      overlay: false,
                      autoplay: false, // Prevent iOS autoplay issues
                      events: ['volumechange', 'pause', 'play'] // Monitor iOS-specific events
                    };
                  } else if (device.isAndroid || device.isMobile) {
                    return {
                      strategy: 'hybrid',
                      controls: true,
                      overlay: 'minimal',
                      autoplay: false,
                      events: ['play', 'pause', 'ended']
                    };
                  } else {
                    return {
                      strategy: 'custom',
                      controls: false,
                      overlay: true,
                      autoplay: false,
                      events: ['play', 'pause', 'ended', 'loadstart']
                    };
                  }
                },
                
                // Initialize Video Source
                initializeSource() {
                  const userData = { challenge: window.userChallenge || 'missed-opportunities' };
                  const videoMapping = {
                    'slow-processes': 'videos/strategy-blueprint.mp4',
                    'missed-opportunities': 'videos/lead-saving-blueprint.mp4', 
                    'team-scaling': 'videos/team-automation-blueprint.mp4',
                    'data-chaos': 'videos/data-organization-blueprint.mp4'
                  };
                  
                  const videoPath = videoMapping[userData.challenge] || 'videos/lead-saving-blueprint.mp4';
                  const finalPath = videoPath + '#t=0.001'; // iOS first frame fix
                  
                  videoPlayer.src = finalPath;
                  console.log('ðŸŽ¬ Universal video source set:', finalPath);
                  return { userData, videoPath: finalPath };
                },
                
                // iOS Mute/Unmute Recovery System (Fixes iOS Safari Bug)
                setupIOSRecovery(video) {
                  console.log('ðŸ”§ Setting up iOS recovery system...');
                  
                  let lastVolume = video.volume;
                  let wasPlaying = false;
                  
                  // Monitor volume changes that break iOS video
                  video.addEventListener('volumechange', (e) => {
                    console.log('ðŸ”Š iOS Volume change detected');
                    
                    // Check if video stopped due to volume change
                    setTimeout(() => {
                      if (video.paused && wasPlaying && video.currentTime > 0) {
                        console.log('ðŸš¨ iOS video paused due to volume change - attempting recovery');
                        
                        // Recovery attempt
                        video.play().then(() => {
                          console.log('âœ… iOS video recovery successful');
                        }).catch((err) => {
                          console.log('âŒ iOS video recovery failed:', err);
                          // Show user feedback
                          VideoArchitecture.showIOSRecoveryMessage();
                        });
                      }
                    }, 100);
                  });
                  
                  // Track playing state
                  video.addEventListener('play', () => {
                    wasPlaying = true;
                    console.log('ðŸ“± iOS video playing');
                  });
                  
                  video.addEventListener('pause', () => {
                    wasPlaying = false;
                    console.log('ðŸ“± iOS video paused');
                  });
                  
                  console.log('âœ… iOS recovery system active');
                },
                
                // Show iOS Recovery Message
                showIOSRecoveryMessage() {
                  const message = document.createElement('div');
                  message.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(0,0,0,0.8);
                    color: white;
                    padding: 12px 16px;
                    border-radius: 8px;
                    font-size: 14px;
                    z-index: 100;
                    text-align: center;
                  `;
                  message.textContent = 'Tap to resume video';
                  
                  const container = document.querySelector('.professional-video-player');
                  if (container) {
                    container.appendChild(message);
                    
                    // Auto-remove after 3 seconds
                    setTimeout(() => {
                      if (message.parentNode) {
                        message.parentNode.removeChild(message);
                      }
                    }, 3000);
                  }
                }
              };
              
              // EXECUTE: Universal Video Initialization
              const device = VideoArchitecture.detectDevice();
              const config = VideoArchitecture.getConfig(device);
              const { userData, videoPath } = VideoArchitecture.initializeSource();
              
              console.log('ðŸ” Device detected:', device);
              console.log('âš™ï¸ Video config:', config);
              
              // Apply Device-Specific Configuration
              if (config.strategy === 'native_only') {
                // iOS: Pure Native Strategy
                console.log('ðŸ“± iOS: Implementing pure native strategy');
                videoPlayer.controls = true;
                videoPlayer.setAttribute('muted', '');
                videoPlayer.style.pointerEvents = 'auto';
                
                // iOS Mute/Unmute Recovery System
                VideoArchitecture.setupIOSRecovery(videoPlayer);
                
                console.log('ðŸ“± iOS: Pure native controls active');
                return;
                
              } else if (config.strategy === 'hybrid') {
                // Android/Mobile: Hybrid Strategy  
                console.log('ðŸ“± Mobile: Implementing hybrid strategy');
                videoPlayer.controls = true;
                
                if (playOverlay) {
                  playOverlay.style.display = 'flex';
                  playOverlay.style.opacity = '0.8';
                }
                
              } else {
                // Desktop: Custom Strategy
                console.log('ðŸ–¥ï¸ Desktop: Implementing custom strategy');
                videoPlayer.controls = false;
                
                if (playOverlay) {
                  playOverlay.style.display = 'flex';
                }
                
                // Initialize custom video player for desktop
                if (typeof window.initializeCustomVideoPlayer === 'function') {
                  window.initializeCustomVideoPlayer(userData);
                }
              }
              
              // Professional overlay management for non-iOS devices
              if (config.overlay && playOverlay) {
                playOverlay.style.display = 'flex';
                playOverlay.classList.remove('hidden');
                console.log('ðŸŽ­ Professional overlay activated for', config.strategy);
              }
              
              // Enable video controls for pause capability
              videoPlayer.controls = false; // Start without controls
              
              // Professional Video Interaction System
              let isLoading = false;
              let hasPlayed = false;
              
              // Create loading indicator
              const createLoadingIndicator = () => {
                const loadingDiv = document.createElement('div');
                loadingDiv.className = 'video-loading-indicator';
                loadingDiv.style.cssText = `
                  position: absolute;
                  top: 0;
                  left: 0;
                  right: 0;
                  bottom: 0;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  background: rgba(0, 0, 0, 0.5);
                  z-index: 10;
                `;
                loadingDiv.innerHTML = `
                  <div style="
                    color: white;
                    font-size: 14px;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                  ">
                    <div style="
                      width: 16px;
                      height: 16px;
                      border: 2px solid rgba(255,255,255,0.3);
                      border-top: 2px solid white;
                      border-radius: 50%;
                      animation: spin 1s linear infinite;
                    "></div>
                    Loading...
                  </div>
                  <style>
                    @keyframes spin {
                      0% { transform: rotate(0deg); }
                      100% { transform: rotate(360deg); }
                    }
                  </style>
                `;
                return loadingDiv;
              };
              
              // Professional play function with loading states
              const playVideo = async () => {
                if (isLoading) return;
                
                console.log('ðŸŽ¥ Professional play initiated');
                isLoading = true;
                
                // Show loading indicator
                const loadingIndicator = createLoadingIndicator();
                playOverlay.appendChild(loadingIndicator);
                playButton.style.opacity = '0.5';
                
                try {
                  // Clean controls handling - no native controls (non-iOS only)
                  videoPlayer.controls = false;
                  console.log('ðŸ“± Using custom controls only (non-iOS)');
                  
                  await videoPlayer.play();
                  
                  // Success - hide overlay
                  playOverlay.classList.add('hidden');
                  hasPlayed = true;
                  console.log('âœ… Video playing successfully');
                  
                } catch (err) {
                  console.error('âŒ Video play failed:', err);
                  // Show error state
                  const videoCaption = playOverlay.querySelector('.video-caption');
                  if (videoCaption) {
                    videoCaption.textContent = 'Unable to play - Click to retry';
                  }
                } finally {
                  // Cleanup loading state
                  isLoading = false;
                  playButton.style.opacity = '1';
                  if (loadingIndicator && loadingIndicator.parentNode) {
                    loadingIndicator.parentNode.removeChild(loadingIndicator);
                  }
                }
              };
              
              // Single unified click handler
              const handlePlayClick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                
                if (videoPlayer.paused) {
                  playVideo();
                } else {
                  // Pause functionality
                  console.log('â¸ï¸ Pausing video');
                  videoPlayer.pause();
                }
              };
              
              // Apply click handlers
              playButton.addEventListener('click', handlePlayClick);
              playOverlay.addEventListener('click', handlePlayClick);
              
              // Professional container-based interaction (iOS-safe)
              const videoContainer = document.querySelector('.professional-video-player');
              if (videoContainer) {
                videoContainer.addEventListener('click', (e) => {
                  // Only handle clicks when not clicking on specific buttons
                  if (!e.target.closest('.clean-play-button') && !isLoading) {
                    e.preventDefault();
                    e.stopPropagation();
                    handlePlayClick(e);
                  }
                });
              }
              
              // NOTE: iOS logic moved to top of function for immediate handling
              
              // Event handlers for overlay management
              videoPlayer.addEventListener('play', () => {
                console.log('â–¶ï¸ Video playing');
                playOverlay.classList.add('hidden');
              });
              
              videoPlayer.addEventListener('pause', () => {
                console.log('â¸ï¸ Video paused');
                if (!videoPlayer.ended && hasPlayed) {
                  playOverlay.classList.remove('hidden');
                  const videoCaption = playOverlay.querySelector('.video-caption');
                  if (videoCaption) {
                    videoCaption.textContent = 'Click to resume video';
                  }
                }
              });
              
              videoPlayer.addEventListener('ended', () => {
                console.log('ðŸ Video ended');
                playOverlay.classList.remove('hidden');
                hasPlayed = false; // Reset for replay
                const videoCaption = playOverlay.querySelector('.video-caption');
                if (videoCaption) {
                  videoCaption.textContent = 'Click to replay video';
                }
                // Reset to beginning for clean replay
                videoPlayer.currentTime = 0;
              });
              
              console.log('âœ… Video player functionality initialized with proper play/pause');
            } else {
              console.log('âš ï¸ Video player elements not found:', {
                videoPlayer: !!videoPlayer,
                playButton: !!playButton,
                playOverlay: !!playOverlay
              });
            }
            
            // 2. Initialize Accordion
            const prepItems = document.querySelectorAll('.prep-item');
            if (prepItems.length > 0) {
              console.log('âœ… Accordion elements found, setting up functionality...');
              
              prepItems.forEach((item, index) => {
                // ENHANCED: Clean up any existing event listeners and add modern touch support
                const question = item.querySelector('.prep-question');
                if (question) {
                  // Remove any existing event listeners
                  if (question._accordionHandler) {
                    question.removeEventListener('click', question._accordionHandler);
                    question.removeEventListener('touchstart', question._accordionHandler);
                  }
                  
                  // Add modern event handler with touch support
                  const handler = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    window.togglePrepItem(this, e);
                  };
                  
                  // Support both click and touch
                  question.addEventListener('click', handler, { passive: false });
                  question.addEventListener('touchstart', handler, { passive: false });
                  question._accordionHandler = handler;
                  
                  // Add visual feedback for touch
                  question.style.cursor = 'pointer';
                  question.style.userSelect = 'none';
                  question.style.webkitUserSelect = 'none';
                  question.style.webkitTouchCallout = 'none';
                  
                  console.log('âœ… Enhanced accordion item', index, 'with touch support');
                }
              });
              
              console.log('âœ… Accordion functionality initialized');
              
              // CRITICAL: Initialize modern event listeners for accordion
              if (typeof window.initializeAccordionListeners === 'function') {
                window.initializeAccordionListeners();
              }
              
              // CRITICAL FIX: Clean accordion state after creation (with delay to override other scripts)
              if (typeof window.cleanAccordionState === 'function') {
                window.cleanAccordionState();
                // Double-clean with delay to ensure no other scripts re-add active classes
                setTimeout(() => {
                  window.cleanAccordionState();
                  console.log('ðŸ§¹ DOUBLE-CLEAN: Ensured accordion state is completely reset');
                }, 100);
              }
              
            } else {
              console.log('âš ï¸ Accordion elements not found');
            }
            
            // 3. Initialize AI Phone Component (if available)
            setTimeout(() => {
              if (typeof initializeSmartPhoneCta === 'function') {
                console.log('ðŸ“± Initializing AI phone component...');
                initializeSmartPhoneCta();
              } else {
                console.log('âš ï¸ initializeSmartPhoneCta function not available');
              }
            }, 100);
            
            console.log('âœ… Confirmation page interactivity fully initialized');
          };
          
          // Initialize with proper timing and DOM ready checks
          setTimeout(() => {
            const checkAndInitialize = () => {
              const container = document.querySelector('.enhanced-confirmation');
              if (container) {
                console.log('âœ… Confirmation container found, initializing...');
                window.initializeConfirmationPageInteractivity();
                
                // Initialize phone component for AI Strategy Call button
                if (typeof initPhoneComponent === 'function') {
                  console.log('ðŸ“± Initializing phone component for AI Strategy Call...');
                  initPhoneComponent();
                } else {
                  console.log('âš ï¸ initPhoneComponent function not available');
                }
              } else {
                console.log('âš ï¸ Confirmation container not ready, retrying...');
                setTimeout(checkAndInitialize, 100);
              }
            };
            checkAndInitialize();
          }, 200);
        };
        
        // REMOVED: Old togglePrepItem function - replaced with enhanced version below
      </script>
      
      <!-- Cal inline embed code ends -->
    </main>
    
    
    <!-- Footer -->
    <footer class="confirmation-footer">
      <div class="footer-links">
        <a href="mailto:hi@phunithichote.com" class="link-button w-inline-block">
          <div class="button-link-wrapper">
            <div class="button-text-block">
              <div class="button-text is-hover">HI@PHUNITHICHOTE.COM</div>
              <div class="button-text">HI@PHUNITHICHOTE.COM</div>
            </div>
          </div>
          <div class="underline is-nav"></div>
        </a>
        <span class="footer-divider"></span>
        <a href="/" class="link-button w-inline-block">
          <div class="button-link-wrapper">
            <div class="button-text-block">
              <div class="button-text is-hover">BACK TO HOMEPAGE</div>
              <div class="button-text">BACK TO HOMEPAGE</div>
            </div>
            <div class="arrow-button-block">
              <div class="arrow-button _01 w-embed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                </svg></div>
              <div class="arrow-button _02 w-embed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
                </svg></div>
            </div>
          </div>
          <div class="underline is-nav"></div>
        </a>
      </div>
    </footer>
  </div>

  <script>
    // Professional environment detection - MUST BE FIRST
    const isProduction = window.location.hostname === 'nithichote.com';
    
    // Global confirmation page state variables - make globally accessible
    window.confirmationPageCreated = false;
    window.confirmationTimeout = null;
    
    // Custom Loading Screen Management
    class CustomLoadingManager {
      constructor() {
        this.overlay = document.getElementById('customLoadingOverlay');
        this.isActive = false;
        this.detectionInterval = null;
        this.hideTimeout = null;
        
        // Bind methods to maintain context
        this.show = this.show.bind(this);
        this.hide = this.hide.bind(this);
        this.detectCalComLoading = this.detectCalComLoading.bind(this);
        
        if (!isProduction) console.log('ðŸ”„ CustomLoadingManager initialized');
      }
      
      show(message = 'Preparing Your Session', subtitle = 'Setting up your personalized automation strategy session...') {
        if (!this.overlay || this.isActive) return;
        
        // Update text content
        const textEl = this.overlay.querySelector('.custom-loading-text');
        const subtitleEl = this.overlay.querySelector('.custom-loading-subtitle');
        
        if (textEl) textEl.textContent = message;
        if (subtitleEl) subtitleEl.textContent = subtitle;
        
        // Show overlay with fade-in
        this.overlay.classList.add('active');
        this.isActive = true;
        
        if (!isProduction) console.log('âœ… Custom loading screen shown:', message);
        
        // Start detection for Cal.com loading states
        this.startDetection();
      }
      
      hide() {
        if (!this.overlay || !this.isActive) return;
        
        // Clear any timeouts
        if (this.hideTimeout) {
          clearTimeout(this.hideTimeout);
          this.hideTimeout = null;
        }
        
        // Hide with smooth fade-out
        this.overlay.classList.remove('active');
        this.isActive = false;
        
        // Stop detection
        this.stopDetection();
        
        if (!isProduction) console.log('âœ… Custom loading screen hidden');
      }
      
      startDetection() {
        // Clear existing interval
        this.stopDetection();
        
        // Check for Cal.com loading indicators every 200ms
        this.detectionInterval = setInterval(this.detectCalComLoading, 200);
        
        if (!isProduction) console.log('ðŸ” Started Cal.com loading detection');
      }
      
      stopDetection() {
        if (this.detectionInterval) {
          clearInterval(this.detectionInterval);
          this.detectionInterval = null;
          if (!isProduction) console.log('â¹ï¸ Stopped Cal.com loading detection');
        }
      }
      
      detectCalComLoading() {
        // Look for common Cal.com loading indicators
        const loadingIndicators = [
          // Direct text content
          document.querySelector('[data-testid*="loading"]'),
          document.querySelector('[aria-label*="loading"]'),
          // Loading spinners
          document.querySelector('.cal-loading'),
          document.querySelector('[class*="spinner"]'),
          document.querySelector('[class*="loading"]'),
          // Redirect text
          ...Array.from(document.querySelectorAll('*')).filter(el => 
            el.textContent && el.textContent.toLowerCase().includes('redirecting')
          ),
          // Cal.com specific loading states
          document.querySelector('#my-cal-inline-30min [data-cal-loading="true"]'),
          document.querySelector('#my-cal-inline-30min iframe[src*="loading"]')
        ];
        
        const calComIsLoading = loadingIndicators.some(indicator => {
          if (!indicator) return false;
          
          // Check if element is visible
          const rect = indicator.getBoundingClientRect();
          const isVisible = rect.width > 0 && rect.height > 0 && 
                           window.getComputedStyle(indicator).display !== 'none';
          
          return isVisible;
        });
        
        // If Cal.com is loading but our screen isn't shown, show it
        if (calComIsLoading && !this.isActive) {
          this.show('Preparing Your Session', 'Setting up your personalized automation strategy session...');
        }
        
        // If Cal.com finished loading and our screen is shown, hide it after delay
        if (!calComIsLoading && this.isActive) {
          // Add slight delay to ensure smooth transition
          this.hideTimeout = setTimeout(() => {
            this.hide();
          }, 800); // 800ms delay for smooth UX
        }
      }
      
      // Manual controls for specific events
      showForRedirect() {
        this.show('Redirecting to Confirmation', 'Taking you to your booking confirmation...');
      }
      
      showForConfirmation() {
        this.show('Processing Booking', 'Confirming your strategy session...');
      }
    }
    
    // Initialize custom loading manager
    window.customLoadingManager = new CustomLoadingManager();
    
    // Simplified Theme Monitor - Official Cal.com approach
    class CalComThemeMonitor {
      constructor() {
        if (!isProduction) console.log('ðŸŽ¨ Cal.com Theme Monitor initialized (using official theming)');
      }
      
      // Monitor for any theme issues and provide fallback
      monitorTheme() {
        // Simple monitoring for theme application
        const checkTheme = setInterval(() => {
          const calContainer = document.getElementById('my-cal-inline-30min');
          if (!calContainer) return;
          
          // Log theme status for debugging
          if (!isProduction) {
            console.log('ðŸ” Cal.com theme status check - using official cssVarsPerTheme');
          }
        }, 5000);
        
        // Stop monitoring after 30 seconds
        setTimeout(() => {
          clearInterval(checkTheme);
          if (!isProduction) console.log('âœ… Theme monitoring completed');
        }, 30000);
      }
    }
    
    // Initialize simplified theme monitor
    window.calComThemeMonitor = new CalComThemeMonitor();
    
    // Security: Input sanitization function
    function sanitizeInput(input) {
      if (typeof input !== 'string') return input;
      
      // Remove any HTML tags
      input = input.replace(/<[^>]*>/g, '');
      
      // Escape special characters
      input = input
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#x27;')
        .replace(/\//g, '&#x2F;');
      
      // Remove any script tags or javascript: protocols
      input = input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
      input = input.replace(/javascript:/gi, '');
      
      // Trim whitespace
      input = input.trim();
      
      // Limit length to prevent buffer overflow attacks
      if (input.length > 500) {
        input = input.substring(0, 500);
      }
      
      return input;
    }
    
    // Cal.com integration with metadata for questionnaire data passing
    
    // Professional console logging - only in development
    const devLog = (...args) => {
      if (!isProduction) console.log(...args);
    };
    
    const devError = (...args) => {
      console.error(...args); // Always show errors for monitoring
    };
    
    const devWarn = (...args) => {
      if (!isProduction) console.warn(...args);
    };
    
    // Global confirmation page state
    // Global variables declared above
    
    // Helper function to get challenge label
    function getChallengeLabel(challengeValue) {
      const challengeLabels = {
        'manual-tasks': 'Too many manual tasks',
        'slow-processes': 'Slow, inefficient processes',
        'scaling-issues': 'Can\'t scale operations',
        'missed-opportunities': 'Missing opportunities'
      };
      return challengeLabels[challengeValue] || challengeValue;
    }
    
    // Simple iframe embed approach - no complex initialization needed
    
    // Cal.com inline embed handles initialization automatically
    // Event handlers can be added separately if booking confirmation is needed
    
    // Simplified fallback function (no loading containers needed)
    function showFallbackOptions() {
      // Cal.com inline embed handles errors gracefully
      // Only needed if additional error handling is required
      console.log('Cal.com fallback options can be added if needed');
    }
    
    // Cal.com initialization and form setup handled in the inline script above
    
    // Browser Extension Detection and Warning System
    function detectProblematicExtensions() {
        const problematicExtensions = [];
        
        // Common extension signatures that can interfere with Cal.com
        if (window.YoinkUI || document.querySelector('script[src*="yoink"]')) {
          problematicExtensions.push('YoinkUI');
        }
        
        if (window.adBlock || window.uBlock) {
          problematicExtensions.push('Ad Blocker');
        }
        
        if (window.grammarly || document.querySelector('[data-gr-ext]')) {
          problematicExtensions.push('Grammarly');
        }
        
        // Generic extension detection
        const extensionScripts = document.querySelectorAll('script[src^="chrome-extension://"], script[src^="moz-extension://"]');
        if (extensionScripts.length > 0) {
          problematicExtensions.push(`${extensionScripts.length} browser extensions`);
        }
        
        return problematicExtensions;
      }
      
      // Duplicate variable declarations removed - using global ones below
      
      // Extract confirmation page creation logic into separate function for reuse  
      // First duplicate createConfirmationPage removed - using comprehensive version below
    
    // Duplicate function removed - using simplified version above
    
    // REMOVED duplicate code causing syntax errors - keeping only working functions below
    
    // REMOVED: Duplicate DOMContentLoaded listener - initializeSmartPhoneCta already handled in main listener (line 4974)
    
    // Browser Extension Detection and Warning System
    function detectProblematicExtensions() {
        const problematicExtensions = [];
        
        // Common extension signatures that can interfere with Cal.com
        if (window.YoinkUI || document.querySelector('script[src*="yoink"]')) {
          problematicExtensions.push('YoinkUI');
        }
        
        if (window.adBlock || window.uBlock) {
          problematicExtensions.push('Ad Blocker');
        }
        
        if (window.grammarly || document.querySelector('[data-gr-ext]')) {
          problematicExtensions.push('Grammarly');
        }
        
        // Generic extension detection
        const extensionScripts = document.querySelectorAll('script[src^="chrome-extension://"], script[src^="moz-extension://"]');
        if (extensionScripts.length > 0) {
          problematicExtensions.push(`${extensionScripts.length} browser extensions`);
        }
        
        return problematicExtensions;
      }
      
      // Duplicate variable declarations removed - using global ones below
      
      // Second duplicate createConfirmationPage removed - using comprehensive version below
      
      // Simple iframe approach - no complex initialization needed
    
    
    // Global flag to prevent duplicate confirmation pages with timeout reset
    // Global variables declared above
    
    // Duplicate function removed - using the complete first definition at line 5257
    /*
      console.log('ðŸš¨ === createConfirmationPage CALLED ===');
      console.log('ðŸ” Called from:', e?.detail?.source || 'unknown');
      console.log('ðŸ” Call stack:', new Error().stack);
      console.log('ðŸ” Event data:', e);
      console.log('ðŸŽ¯ Creating confirmation page...');
      
      // CRITICAL FIX: Check if already created, but allow retry for failed attempts
      if (window.confirmationPageCreated && document.querySelector('.enhanced-confirmation')) {
        console.log('âš ï¸ Confirmation page already created and visible, skipping...');
        return;
      }
      
      // Set flag early but will reset on error for retry capability
      const attemptStartTime = Date.now();
      console.log('ðŸ”„ Starting confirmation page creation attempt...');
      
      // Get stored user data for personalization
      let userData = {};
      try {
        // Try localStorage first (persistent), then sessionStorage (temporary)
        // Try localStorage first (survives page refresh), then sessionStorage
        let storedData = localStorage.getItem('questionnaireData');
        if (!storedData) {
          storedData = sessionStorage.getItem('questionnaireData');
          console.log('ðŸ“Š Using sessionStorage fallback (data may not persist on refresh)');
        } else {
          console.log('ðŸ“Š Using localStorage data (persistent across refreshes)');
        }
        if (storedData) {
          userData = JSON.parse(storedData);
          console.log('ðŸ“Š User data loaded for AI call:', userData);
        } else {
          console.log('âš ï¸ No questionnaire data found for AI call');
        }
      } catch (err) {
        devError('âŒ Error loading questionnaire data for AI call:', err);
      }
      
      // Create split messaging for better visual hierarchy
      const problemStatement = userData.challenge ? 
        `Ready to solve ${userData.challengeLabel || userData.challenge}?` : 
        'Ready for your strategy session?';
      const actionStatement = 'Complete the steps below:';
      
      // Get the correct video file based on challenge type
      const videoMap = {
        'manual-tasks': 'videos/manual-tasks-blueprint.mp4',
        'slow-processes': 'videos/strategy-blueprint.mp4', 
        'scaling-issues': 'videos/scaling-blueprint.mp4',
        'missed-opportunities': 'videos/lead-saving-blueprint.mp4'
      };
      const challengeType = userData.challenge || 'manual-tasks';
      const videoPath = videoMap[challengeType] || videoMap['manual-tasks'];
      console.log('ðŸŽ¥ Using video path:', videoPath, 'for challenge:', challengeType);
      
      // Create enhanced content ABOVE the Cal.com confirmation with AGGRESSIVE CSS DOMINANCE
      const enhancedContent = document.createElement('div');
      enhancedContent.className = 'enhanced-confirmation';
      
      // RESPONSIVE CSS DOMINANCE - ensure our confirmation appears with proper layout and full visibility
      enhancedContent.style.cssText = `
        position: relative !important;
        width: 100% !important;
        max-width: none !important;
        min-height: 100vh !important;
        height: auto !important;
        background: var(--primary-black) !important;
        z-index: 100 !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box !important;
      `;
      enhancedContent.innerHTML = `
        <div class="confirmation-container">
          <div class="confirmation-success-badge">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22,4 12,14.01 9,11.01"></polyline>
            </svg>
            Strategy Session Confirmed
          </div>
          <h1 class="confirmation-heading">
            Your AI automation strategy session is confirmed
          </h1>
          <div class="confirmation-tagline">
            <span class="tagline-problem">${problemStatement}</span>
            <span class="tagline-action">${actionStatement}</span>
          </div>
          
          <!-- Video Section -->
          <div class="confirmation-video">
            <div class="step-indicator">
              <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">1</span>
              <h3>Watch My Quick Message</h3>
            </div>
            <div class="professional-video-container">
              <!-- Professional Video Player - Clean & Modern -->
              <div class="professional-video-player" id="professionalVideoPlayer">
                <video 
                  id="mainVideo"
                  class="main-video"
                  preload="metadata"
                  playsinline
                  webkit-playsinline
                  poster=""
                >
                  <source src="" type="video/mp4" id="videoSource">
                  Your browser does not support the video tag.
                </video>
                
                <!-- Professional Play Button Overlay -->
                <div class="video-play-overlay" id="videoPlayOverlay">
                  <button class="clean-play-button" id="cleanPlayButton" aria-label="Play personalized video">
                    â–¶
                  </button>
                  <div class="video-info">
                    <p class="video-caption">Click to play personalized video</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Divider -->
          <div class="section-divider"></div>
          
          <!-- AI Discovery Section -->
          <div class="ai-discovery-section">
            <div class="ai-discovery-container">
              <div class="step-indicator">
                <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">2</span>
                <h2 class="ai-discovery-heading">Start Your AI Discovery Call</h2>
              </div>
              
              <p class="ai-discovery-subheading">
                Spend 5 minutes with my AI assistant to identify your top automation opportunities before our call.
              </p>
              
              <!-- Success Message (initially hidden) -->
              <div class="ai-success-message" id="aiSuccessMessage">
                <div class="success-message-container">
                  <div class="success-emoji">âœ…</div>
                  <h3 class="success-heading">AI Discovery Call Starting!</h3>
                  <p class="success-text">Call in 60 seconds!</p>
                </div>
              </div>
              
              <!-- ZERO-DEPENDENCY PHONE COMPONENT IN DYNAMIC TEMPLATE -->
              <div id="phoneComponentContainer" style="position: relative; width: 100%; max-width: 400px; height: 84px; margin: 2.25rem auto 0.5rem auto; pointer-events: auto;">
                <div id="buttonContainer" style="position: absolute; top: 0; left: 0; width: 100%; opacity: 1; transform: translateY(0); pointer-events: auto; transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out; z-index: 3;">
                  <button id="ctaButton" style="all: initial; display: flex; align-items: center; justify-content: center; gap: 4px; width: 100%; height: 48px; background: white; border: 1px solid #e5e5e5; border-radius: 8px; color: #333333; font-size: 13px; font-weight: 500; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; text-align: center; cursor: pointer; pointer-events: auto; -webkit-appearance: none; -moz-appearance: none; appearance: none; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; -webkit-text-stroke-width: 0; -webkit-text-stroke-color: transparent; text-shadow: none; outline: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.2s ease; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility; padding: 0 8px;">
                    <svg width="10" height="10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: #333333;">
                      <path d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59533 1.99522 8.06814 2.16708 8.43999 2.48353C8.81184 2.79999 9.06334 3.23945 9.14999 3.72C9.31071 4.68007 9.58887 5.61273 9.97999 6.5C10.1018 6.80258 10.1445 7.13162 10.1044 7.45606C10.0642 7.78049 9.94218 8.09014 9.74999 8.35L8.52999 9.57C9.85999 12.0756 11.9544 14.17 14.46 15.5L15.68 14.28C15.9399 14.0878 16.2495 13.9658 16.574 13.9256C16.8984 13.8855 17.2274 13.9282 17.53 14.05C18.4173 14.4411 19.3499 14.7193 20.31 14.88C20.7955 14.9685 21.2387 15.2239 21.5547 15.5997C21.8707 15.9755 22.0397 16.4499 22.03 16.94L22 16.92Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Get AI Strategy Call in 60 Seconds
                  </button>
                </div>
                <div id="phoneFormContainer" style="position: absolute; top: 0; left: 0; width: 100%; height: 84px; opacity: 0; transform: translateY(5px); pointer-events: none; transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out; z-index: 5;">
                  <div style="position: relative; display: flex; align-items: stretch; width: 100%; height: 48px; gap: 8px;">
                    <input type="tel" id="phoneInput" placeholder="(555) 123-4567" maxlength="14" autocomplete="tel" pattern="[0-9\s\(\)\-]*" inputmode="numeric" style="flex: 1; height: 48px; padding: 0 16px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px 0 0 8px; color: white; font-size: 16px; font-weight: normal; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; cursor: text; pointer-events: auto; outline: none; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; text-shadow: none; box-sizing: border-box; z-index: 100;" />
                    <button type="button" id="callButton" style="height: 48px; background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.5); font-weight: 600; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; cursor: not-allowed; pointer-events: auto; display: flex; align-items: center; justify-content: center; -webkit-appearance: none; -moz-appearance: none; appearance: none; outline: none; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-sizing: border-box; z-index: 101; opacity: 0.6;"><span class="call-button-text">Call Me</span></button>
                  </div>
                  <p id="statusMessage" style="all: initial; color: rgba(255, 255, 255, 0.6); font-size: 12px; font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif; margin: 12px 0 0 0; text-align: center; -webkit-text-stroke: 0; -moz-text-stroke: 0; text-stroke: 0; text-shadow: none; line-height: 1.4; min-height: 24px; box-sizing: border-box;"></p>
                </div>
              </div>
              
              
              <p class="ai-supporting-text">
                <strong>Why this matters:</strong> 73% of my most successful implementations started with this AI discovery call. You'll arrive to your strategy session with clarity, not confusion.
              </p>
            </div>
          </div>
          
          <!-- Section Divider -->
          <div class="section-divider"></div>

          <!-- Step 3: Meeting Details -->
          <div class="ai-discovery-section">
            <div class="ai-discovery-container">
              <div class="step-indicator">
                <span class="step-number-badge" style="background: white !important; color: #0f0f0f !important; font-weight: 700 !important;">3</span>
                <h2 class="ai-discovery-heading">Meeting Confirmed</h2>
              </div>
              
              <p class="ai-discovery-subheading">
                You'll receive a calendar invitation and meeting details at your email shortly.
              </p>
              
              <!-- 2025 Minimal Typography Confirmation -->
              <div class="minimal-confirmation">
                
                <!-- Professional Preparation Accordion -->
                <div class="prep-section">
                  <h3 class="prep-title">How to Prepare</h3>
                  <div class="prep-accordion">
                    <div class="prep-item">
                      <div class="prep-question" onclick="togglePrepItem(this, event)" ontouchstart="togglePrepItem(this, event)"
                        <span>Review your current software tools</span>
                        <span class="prep-toggle">+</span>
                      </div>
                      <div class="prep-answer">
                        <div class="prep-answer-content">
                          <p>Make a note of the 3-5 software tools or platforms you use daily in your business. This could include your CRM, email platform, project management tool, accounting software, or communication apps. Knowing your current tech stack helps me design automations that work seamlessly with what you already use.</p>
                        </div>
                      </div>
                    </div>
                    <div class="prep-item">
                      <div class="prep-question" onclick="togglePrepItem(this, event)" ontouchstart="togglePrepItem(this, event)"
                        <span>Identify what takes up most of your time</span>
                        <span class="prep-toggle">+</span>
                      </div>
                      <div class="prep-answer">
                        <div class="prep-answer-content">
                          <p>Think about what tasks eat up most of your time each week. Consider things like responding to emails, updating spreadsheets, scheduling meetings, following up with leads, or preparing reports. These time drains are often the highest-impact automation opportunities.</p>
                        </div>
                      </div>
                    </div>
                    <div class="prep-item">
                      <div class="prep-question" onclick="togglePrepItem(this, event)" ontouchstart="togglePrepItem(this, event)"
                        <span>Think about tasks you do the same way repeatedly</span>
                        <span class="prep-toggle">+</span>
                      </div>
                      <div class="prep-answer">
                        <div class="prep-answer-content">
                          <p>Consider 2-3 tasks you do the exact same way every time. Examples: sending welcome emails to new clients, creating invoices, updating project status, or organizing files. These predictable workflows are perfect candidates for complete automation.</p>
                        </div>
                      </div>
                    </div>
                    <div class="prep-item">
                      <div class="prep-question" onclick="togglePrepItem(this, event)" ontouchstart="togglePrepItem(this, event)"
                        <span>Consider what you wish happened automatically</span>
                        <span class="prep-toggle">+</span>
                      </div>
                      <div class="prep-answer">
                        <div class="prep-answer-content">
                          <p>Come ready with 2-3 things you wish happened automatically in your business. Maybe it's instant lead follow-up, automatic data backup, or notifications when important events happen. Having specific wishes helps me prioritize which automations will make the biggest impact for you.</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Email Button - Match Footer Style -->
                <div class="minimal-contact">
                  <a href="mailto:hi@nithichote.com?subject=Meeting Question" class="link-button w-inline-block">
                    <div class="button-link-wrapper">
                      <div class="button-text-block">
                        <div class="button-text">Questions? Email me</div>
                        <div class="button-text is-hover">QUESTIONS? EMAIL ME</div>
                      </div>
                    </div>
                    <div class="underline is-nav"></div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
      
      // FIXED: Replace entire booking page content with confirmation content
      const pageWrapper = document.querySelector('.page-wrapper');
      
      if (!isProduction) {
        console.log('ðŸ“ Target container:', {
          pageWrapper: !!pageWrapper
        });
      }
      
      // ENHANCED: Replace the entire page content instead of inserting + hiding
      console.log('ðŸ”§ Starting complete content replacement...');
      console.log('ðŸ” DOM elements check:', {
        pageWrapper: !!pageWrapper,
        enhancedContent: !!enhancedContent
      });
      
      try {
        if (pageWrapper) {
          console.log('âœ… REPLACING entire booking page with confirmation content');
          // CRITICAL: Replace all booking content with confirmation content
          pageWrapper.innerHTML = '';
          pageWrapper.appendChild(enhancedContent);
          console.log('âœ… Complete content replacement successful - no more mixed content!');
          
          // SUCCESS: Set flag only after successful insertion
          window.confirmationPageCreated = true;
          localStorage.setItem('confirmationViewed', 'true');
          console.log('ðŸŽ¯ Confirmation page creation SUCCESSFUL - flag set to true');
          
          // Verify the insertion worked
          const insertedElement = document.querySelector('.enhanced-confirmation');
          console.log('ðŸ” Insertion verification:', {
            elementFound: !!insertedElement,
            isVisible: insertedElement ? insertedElement.style.display !== 'none' : false,
            hasParent: insertedElement ? !!insertedElement.parentNode : false
          });
          
          // CRITICAL: Show footer after content insertion
          const confirmationFooter = document.querySelector('.confirmation-footer');
          if (confirmationFooter) {
            confirmationFooter.style.display = 'block';
            console.log('âœ… Dynamic confirmation footer displayed');
          } else {
            console.log('âŒ Dynamic confirmation footer not found');
          }
          
          // STEP 2: CRITICAL FIX - Initialize video player with comprehensive element checking
          console.log('ðŸŽ¬ DYNAMIC CONFIRMATION: Starting video initialization...');
          
          // Multi-stage initialization with retries for dynamic content
          const initializeVideoWithRetry = (attempt = 1, maxAttempts = 5) => {
            const videoPlayer = document.getElementById('professionalVideoPlayer');
            const mainVideo = document.getElementById('mainVideo');
            const playButton = document.getElementById('cleanPlayButton');
            const playOverlay = document.getElementById('videoPlayOverlay');
            
            console.log(`ðŸ” ATTEMPT ${attempt}/${maxAttempts} - Element check:`);
            console.log('  videoPlayer:', !!videoPlayer);
            console.log('  mainVideo:', !!mainVideo);
            console.log('  playButton:', !!playButton);
            console.log('  playOverlay:', !!playOverlay);
            
            if (videoPlayer && mainVideo && playButton && playOverlay) {
              console.log('âœ… DYNAMIC CONFIRMATION: All video elements found, initializing...');
              initializeCustomVideoPlayer(userData);
              return true;
            } else if (attempt < maxAttempts) {
              console.log(`â³ DYNAMIC CONFIRMATION: Elements not ready, retry in ${attempt * 100}ms...`);
              setTimeout(() => initializeVideoWithRetry(attempt + 1, maxAttempts), attempt * 100);
              return false;
            } else {
              console.error('âŒ DYNAMIC CONFIRMATION: Video elements not found after all attempts');
              console.log('  Missing elements - cannot initialize video player');
              return false;
            }
          };
          
          // Start initialization immediately, then with progressive delays
          setTimeout(initializeVideoWithRetry, 50);
          
        } else {
          console.log('âš ï¸ Page wrapper not found - using body fallback');
          // Fallback: append to body if page-wrapper is missing
          if (enhancedContent && document.body) {
            console.log('ðŸ”„ Fallback: Appending to document body');
            document.body.appendChild(enhancedContent);
            window.confirmationPageCreated = true;
            console.log('âœ… Confirmation page appended to body (fallback)');
            
            // STEP 2: Initialize video player for fallback path
            console.log('ðŸŽ¬ FALLBACK CONFIRMATION: Starting video initialization...');
            setTimeout(initializeVideoWithRetry, 50);
          } else {
            console.error('âŒ Content replacement failed - no valid containers available');
            return;
          }
        }
      } catch (error) {
        console.error('ðŸš¨ CRITICAL ERROR: Confirmation page creation failed:', error);
        console.log('ðŸ”„ Keeping confirmation flag as false to allow retry...');
        
        // ERROR: Do NOT set confirmationPageCreated = true, allow retry
        setTimeout(() => {
          console.log('â° Retry timer: confirmation page creation can be attempted again');
        }, 2000);
        
        // Re-throw error for calling code to handle
        throw error;
      }
      
      // Hide header and progress sections but SHOW Cal.com confirmation
      const header = document.querySelector('.calendar-header');
      const progress = document.querySelector('.progress-indicator');
      const personalizedMsg = document.querySelector('.personalized-message');
      const confirmationFooter = document.querySelector('.confirmation-footer');
      const calcomContainer = document.getElementById('my-cal-inline-30min');
      
      if (header) header.style.display = 'none';
      if (progress) progress.style.display = 'none';
      if (personalizedMsg) personalizedMsg.style.display = 'none';
      
      // AGGRESSIVELY HIDE Cal.com embed during confirmation to prevent booking form reappearing
      if (calcomContainer) {
        calcomContainer.style.cssText = `
          display: none !important;
          visibility: hidden !important;
          opacity: 0 !important;
          position: absolute !important;
          top: -9999px !important;
          left: -9999px !important;
          z-index: -1 !important;
          pointer-events: none !important;
        `;
        if (!isProduction) console.log('âœ… Cal.com embed AGGRESSIVELY hidden during confirmation');
      }
      
      // Also hide any Cal.com modal overlays or popups
      const calModals = document.querySelectorAll('[data-cal-namespace], [class*="cal-"], iframe[src*="cal.com"]');
      calModals.forEach(modal => {
        if (modal !== calcomContainer) {
          modal.style.cssText = `
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            z-index: -1 !important;
          `;
        }
      });
      
      // Footer display logic moved to after dynamic content insertion
      
      // Set up professional video player and AI discovery with enhanced reliability
      setTimeout(() => {
        console.log('ðŸŽ¬ Initializing confirmation page components...');
        
        // Enhanced video player initialization with retry logic
        const initVideo = () => {
          const videoPlayer = document.getElementById('professionalVideoPlayer');
          const mainVideo = document.getElementById('mainVideo');
          
          if (videoPlayer && mainVideo) {
            console.log('âœ… Video elements found, initializing player...');
            initializeCustomVideoPlayer(userData);
            return true;
          } else {
            console.log('âš ï¸ Video elements not yet available, will retry...');
            return false;
          }
        };
        
        // Try immediately, then with retries if needed
        if (!initVideo()) {
          let retryCount = 0;
          const maxRetries = 5;
          const retryInterval = setInterval(() => {
            retryCount++;
            console.log(`ðŸ”„ Video initialization retry ${retryCount}/${maxRetries}`);
            
            if (initVideo() || retryCount >= maxRetries) {
              clearInterval(retryInterval);
              if (retryCount >= maxRetries) {
                console.error('âŒ Video initialization failed after maximum retries');
              }
            }
          }, 200);
        }
        
        // Initialize AI Discovery (this should always work)
        initializeSmartPhoneCta();
      }, 500);
      
      // ðŸ”„ ENHANCED STATE PERSISTENCE - Professional reload persistence with multiple fallbacks
      const persistenceTimestamp = Date.now().toString();
      const persistenceSource = e?.detail?.source || 'unknown';
      
      try {
        // Primary persistence: sessionStorage (survives tabs, not browser restart)
        sessionStorage.setItem('confirmationPageActive', 'true');
        sessionStorage.setItem('confirmationTimestamp', persistenceTimestamp);
        sessionStorage.setItem('confirmationSource', persistenceSource);
        sessionStorage.setItem('confirmationPriority', (e?.detail?.priority || 1).toString());
        
        // Secondary persistence: localStorage (survives browser restart)
        localStorage.setItem('bookingConfirmed', 'true');
        localStorage.setItem('bookingTimestamp', persistenceTimestamp);
        
        // Store questionnaire data for personalization on reload
        const questionnaireData = localStorage.getItem('questionnaireData');
        if (questionnaireData) {
          sessionStorage.setItem('questionnaireData', questionnaireData);
        }
        
        // Tertiary persistence: URL fragment (manual bookmark support)
        if (!window.location.hash.includes('confirmed')) {
          // Add confirmation hash without triggering page reload
          const newHash = window.location.hash ? `${window.location.hash}&confirmed=true` : '#confirmed=true';
          history.replaceState(null, null, newHash);
        }
        
        console.log('ðŸ’¾ ENHANCED confirmation state persistence saved:', {
          sessionStorage: {
            confirmationPageActive: 'true',
            confirmationTimestamp: persistenceTimestamp,
            confirmationSource: persistenceSource,
            confirmationPriority: e?.detail?.priority || 1
          },
          localStorage: {
            bookingConfirmed: 'true',
            bookingTimestamp: persistenceTimestamp,
            questionnaireData: !!questionnaireData
          },
          url: {
            hash: window.location.hash,
            containsConfirmed: window.location.hash.includes('confirmed')
          }
        });
        
      } catch (err) {
        console.error('âŒ Error saving confirmation persistence state:', err);
        // Fallback: at minimum, set the essential localStorage flag
        try {
          localStorage.setItem('bookingConfirmed', 'true');
          localStorage.setItem('bookingTimestamp', persistenceTimestamp);
          console.log('ðŸ’¾ Fallback: Essential localStorage persistence saved');
        } catch (fallbackErr) {
          console.error('âŒ Critical: Cannot save any persistence state:', fallbackErr);
        }
      }
      
    */
    // END DUPLICATE FUNCTION BLOCK
    
    // Re-enabled setupBookingSuccessHandler with duplication prevention
    function setupBookingSuccessHandler() {
      devLog('ðŸš€ setupBookingSuccessHandler called');
      
      // Streamlined Cal.com API verification
      if (!isProduction) {
        console.log('ðŸ” Cal.com API Status:', {
          CalExists: typeof Cal !== 'undefined',
          NamespaceReady: !!(Cal.ns && Cal.ns["30min"])
        });
      }
      
      // Verify Cal.com API is available
      if (typeof Cal === 'undefined') {
        console.error('âŒ Cal is not defined - Cal.com not loaded properly');
        return;
      }
      
      if (!Cal.ns) {
        console.error('âŒ Cal.ns is not available - Cal.com API not ready');
        return;
      }
      
      if (!Cal.ns["30min"]) {
        console.error('âŒ Cal.ns["30min"] is not available - calendar instance not ready');
        return;
      }
      
      console.log('âœ… Cal.com API verified - registering booking success handler');
      
      // Booking success handler is now registered in the Cal.com initialization script above
    }
    
    
    function displayPersonalizedMessage(userData) {
      const personalizedSection = document.getElementById('personalized-message');
      const personalizedText = document.getElementById('personalized-text');
      
      // Hardcoded challenge-based messages for stability
      const challengeMessages = {
        'manual-tasks': "Let's unlock hours back in your week with smart automation",
        'slow-processes': "Ready to accelerate your operations with intelligent workflows",
        'scaling-issues': "Time to build systems that scale with your ambitions",
        'missed-opportunities': "Let's capture every opportunity with automated systems"
      };
      
      // Default message if no challenge or unknown challenge
      const defaultMessage = "Ready to transform your business with automation";
      
      // Get message based on challenge type
      let message = challengeMessages[userData.challenge] || defaultMessage;
      
      // Display the message
      if (personalizedText && personalizedSection) {
        personalizedText.textContent = message;
        personalizedSection.style.display = 'block';
      }
    }
    
    
    function getBookingData() {
      // Try to get booking date from sessionStorage
      const bookingDate = sessionStorage.getItem('bookingDate');
      let startDate, endDate;
      
      if (bookingDate) {
        const date = new Date(bookingDate);
        startDate = date.toISOString().replace(/[-:]/g, '').replace('.000', '');
        const endTime = new Date(date.getTime() + 30 * 60000); // Add 30 minutes
        endDate = endTime.toISOString().replace(/[-:]/g, '').replace('.000', '');
      } else {
        // Fallback to tomorrow at 10am
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(10, 0, 0, 0);
        startDate = tomorrow.toISOString().replace(/[-:]/g, '').replace('.000', '');
        const endTime = new Date(tomorrow.getTime() + 30 * 60000);
        endDate = endTime.toISOString().replace(/[-:]/g, '').replace('.000', '');
      }
      
      return { startDate, endDate };
    }
    
    // Additional Custom Loading Screen Triggers
    function initializeCustomLoadingIntegration() {
      if (!window.customLoadingManager) return;
      
      // Monitor DOM for redirect text (like "Redirecting to confirmation...")
      const redirectTextObserver = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          mutation.addedNodes.forEach((node) => {
            if (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE) {
              const text = node.textContent || '';
              if (text.toLowerCase().includes('redirecting') && 
                  text.toLowerCase().includes('confirmation')) {
                if (!isProduction) console.log('ðŸ” Detected redirect text:', text);
                window.customLoadingManager.showForRedirect();
              }
            }
          });
        });
      });
      
      // Start observing the Cal.com container
      const calContainer = document.getElementById('my-cal-inline-30min');
      if (calContainer) {
        redirectTextObserver.observe(calContainer, {
          childList: true,
          subtree: true,
          characterData: true
        });
        
        if (!isProduction) console.log('âœ… Redirect text observer started');
      }
      
      // Also monitor for form submissions that might trigger redirects
      document.addEventListener('submit', function(e) {
        // Check if it's a Cal.com form
        const form = e.target;
        if (form && (form.closest('#my-cal-inline-30min') || 
                    form.querySelector('[data-cal-namespace]') ||
                    form.action.includes('cal.com'))) {
          if (!isProduction) console.log('ðŸ” Cal.com form submitted, showing loading');
          window.customLoadingManager.showForRedirect();
        }
      });
      
      // Monitor for iframe loading states
      const iframe = document.querySelector('#my-cal-inline-30min iframe');
      if (iframe) {
        iframe.addEventListener('load', () => {
          // Small delay to ensure Cal.com content is ready
          setTimeout(() => {
            if (window.customLoadingManager.isActive) {
              window.customLoadingManager.hide();
            }
          }, 1000);
        });
      }
      
      if (!isProduction) console.log('âœ… Custom loading integration initialized');
    }
    
    // DISABLED: Old restoration system replaced by master restoration function
    /*
    document.addEventListener('DOMContentLoaded', function() {
      
      // ðŸ”„ OLD SYSTEM DISABLED - Now handled by masterConfirmationRestoration()
      const confirmationActive = sessionStorage.getItem('confirmationPageActive');
      const confirmationTimestamp = sessionStorage.getItem('confirmationTimestamp');
      const confirmationSource = sessionStorage.getItem('confirmationSource');
      const bookingConfirmed = localStorage.getItem('bookingConfirmed');
      const bookingTimestamp = localStorage.getItem('bookingTimestamp');
      
      // Check for rescheduling parameter (from referrer URL)
      const referrerUrl = new URL(document.referrer || window.location.href);
      const isSchedulingAnother = referrerUrl.searchParams.get('schedule_another') === 'true';
      
      // CRITICAL FIX: Check if user is coming from form (new booking flow)
      const referrer = document.referrer;
      const isFromForm = referrer && (referrer.includes('contact') || referrer.includes('index'));
      const isReload = !referrer || referrer === window.location.href;
      
      console.log('ðŸ”„ === PROFESSIONAL RELOAD PERSISTENCE CHECK ===');
      console.log('ðŸ” Page reload detected, checking confirmation state...');
      console.log('ðŸ” sessionStorage.confirmationPageActive:', confirmationActive);
      console.log('ðŸ” sessionStorage.confirmationTimestamp:', confirmationTimestamp);  
      console.log('ðŸ” sessionStorage.confirmationSource:', confirmationSource);
      console.log('ðŸ” localStorage.bookingConfirmed:', bookingConfirmed);
      console.log('ðŸ” localStorage.bookingTimestamp:', bookingTimestamp);
      console.log('ðŸ” isSchedulingAnother:', isSchedulingAnother);
      console.log('ðŸ” referrer:', referrer || 'empty/none');
      console.log('ðŸ” isFromForm:', isFromForm);
      console.log('ðŸ” isReload:', isReload);
      console.log('ðŸ” URL contains confirmed:', window.location.href.includes('confirmed'));
      
      // CRITICAL FIX: Clear old booking states ONLY when truly coming from form (not reload)
      if (isFromForm && !isSchedulingAnother && !isReload) {
        console.log('ðŸ§¹ CLEARING OLD BOOKING STATES: New booking flow from form detected (not a reload)');
        console.log('ðŸ§¹ Clearing localStorage.bookingConfirmed and sessionStorage.confirmationPageActive');
        
        // Clear persistence flags so user sees Cal.com widget
        localStorage.removeItem('bookingConfirmed');
        localStorage.removeItem('bookingTimestamp');
        localStorage.removeItem('bookingEventType');
        sessionStorage.removeItem('confirmationPageActive');
        sessionStorage.removeItem('confirmationTimestamp');
        sessionStorage.removeItem('confirmationSource');
        sessionStorage.removeItem('confirmationPriority');
        
        console.log('âœ… OLD BOOKING STATES CLEARED: Fresh booking flow ready');
      } else if (isReload && (confirmationActive === 'true' || bookingConfirmed === 'true')) {
        console.log('ðŸ”„ RELOAD PROTECTION: Not clearing states during confirmation page reload');
      }
      
      console.log('ðŸ”„ === END PERSISTENCE CHECK ===');
      
      // ENHANCED: Professional confirmation state detection with priority system
      // Priority 1: Session storage (most recent, survives tabs but not browser restart)
      // Priority 2: Local storage (survives browser restart, indicates completed booking)  
      // Priority 3: URL indicators (manual navigation or bookmarks)
      
      let isValidConfirmation = false;
      let validationReason = '';
      let confirmationPriority = 0;
      
      // Priority 1: Session storage confirmation (highest priority - user was just on confirmation page)
      if (confirmationActive === 'true' && confirmationTimestamp && !isSchedulingAnother && !isFromForm) {
        const timestamp = parseInt(confirmationTimestamp);
        const hoursSinceConfirmation = (Date.now() - timestamp) / (1000 * 60 * 60);
        
        if (hoursSinceConfirmation < 24) { // 24-hour session window
          isValidConfirmation = true;
          validationReason = `session_active_${hoursSinceConfirmation.toFixed(1)}h_ago`;
          confirmationPriority = 3;
          console.log('âœ… PRIORITY 1: Active session confirmation detected');
          console.log(`ðŸ” Session age: ${hoursSinceConfirmation.toFixed(2)} hours`);
          console.log(`ðŸ” Session source: ${confirmationSource || 'unknown'}`);
        } else {
          console.log('âš ï¸ Session confirmation expired (>24h), checking other sources');
        }
      }
      
      // Priority 2: Local storage booking confirmation (persistent across browser restarts)
      if (!isValidConfirmation && bookingConfirmed === 'true' && !isSchedulingAnother && !isFromForm) {
        const bookingTime = bookingTimestamp ? new Date(bookingTimestamp) : null;
        const hoursSinceBooking = bookingTime ? (Date.now() - bookingTime.getTime()) / (1000 * 60 * 60) : null;
        
        if (!hoursSinceBooking || hoursSinceBooking < 72) { // 72-hour booking window  
          isValidConfirmation = true;
          validationReason = `localStorage_booking_${hoursSinceBooking ? hoursSinceBooking.toFixed(1) + 'h_ago' : 'no_timestamp'}`;
          confirmationPriority = 2;
          console.log('âœ… PRIORITY 2: Persistent booking confirmation detected');
          console.log(`ðŸ” Booking age: ${hoursSinceBooking ? hoursSinceBooking.toFixed(2) + ' hours' : 'unknown'}`);
        } else {
          console.log('âš ï¸ Booking confirmation expired (>72h), checking URL indicators');
        }
      }
      
      // Priority 3: URL confirmation indicators (lowest priority - manual navigation)
      if (!isValidConfirmation && window.location.href.includes('confirmed') && !isSchedulingAnother && !isFromForm) {
        isValidConfirmation = true; 
        validationReason = 'URL_confirmation_indicator';
        confirmationPriority = 1;
        console.log('âœ… PRIORITY 3: URL confirmation indicator detected');
      }
      
      const shouldShowConfirmation = isValidConfirmation;
      
      console.log('ðŸŽ¯ CONFIRMATION DECISION:', {
        shouldShow: shouldShowConfirmation,
        reason: validationReason,
        priority: confirmationPriority,
        isSchedulingAnother: isSchedulingAnother,
        isFromForm: isFromForm
      });
      
      // HELPFUL DEBUG: Log what will happen for different scenarios
      if (isFromForm && !isSchedulingAnother) {
        console.log('âœ… FORM USER FLOW: User from form will see Cal.com booking widget (as expected)');
      } else if (shouldShowConfirmation) {
        console.log('âœ… RETURN USER FLOW: Returning user will see confirmation page (as expected)');
      } else {
        console.log('âœ… FRESH USER FLOW: Fresh user will see Cal.com booking widget (as expected)');
      }
      
      // ENHANCED: Execute confirmation restoration with immediate loading and visual feedback
      if (shouldShowConfirmation && isValidConfirmation) {
        console.log(`ðŸš€ RESTORING CONFIRMATION PAGE: ${validationReason} (Priority ${confirmationPriority})`);
        
        // Show immediate loading state to prevent flash
        const body = document.body;
        if (body && !body.classList.contains('confirmation-loading')) {
          body.classList.add('confirmation-loading');
          console.log('ðŸ”„ Added loading state to prevent content flash');
        }
        
        // Only restore if immediate booking confirmation didn't already handle it
        if (!window.confirmationPageCreated) {
          
          // CRITICAL FIX: Reset confirmation page flag for session restoration
          console.log('ðŸ”§ Resetting confirmation page flag for session restoration...');
          window.confirmationPageCreated = false;
          window.bookingHandled = false;
          
          // IMMEDIATE restoration - no delays for professional UX
          console.log('âš¡ Executing IMMEDIATE confirmation page restoration...');
          
          try {
            window.createConfirmationPage({
              detail: {
                source: `session_restoration_${validationReason}`,
                text: 'Restored from session',
                priority: confirmationPriority,
                timestamp: confirmationTimestamp || Date.now().toString()
              }
            });
            
            console.log('âœ… Confirmation page restored successfully');
            
            // Remove loading state after restoration
            setTimeout(() => {
              if (body) body.classList.remove('confirmation-loading');
            }, 100);
            
          } catch (error) {
            console.error('âŒ Error restoring confirmation page:', error);
            // Fallback: remove loading state and show calendar
            if (body) body.classList.remove('confirmation-loading');
            
            // Clean up invalid session state to allow fresh booking
            sessionStorage.removeItem('confirmationPageActive');
            sessionStorage.removeItem('confirmationTimestamp');
            sessionStorage.removeItem('confirmationSource');
            localStorage.removeItem('bookingConfirmed');
            localStorage.removeItem('bookingTimestamp');
            console.log('ðŸ§¹ Cleaned up failed persistence state, allowing fresh booking');
          }
          
        } else {
          console.log('âœ… Confirmation already handled by immediate booking logic');
          // Remove loading state since confirmation already exists
          if (body) body.classList.remove('confirmation-loading');
        }
        
      } else if (!shouldShowConfirmation) {
        
        // CRITICAL: Ensure users from form never get stuck in loading state
        if (isFromForm) {
          console.log('âœ… FORM USER: Ensuring Cal.com widget is visible and interactive');
          const body = document.body;
          if (body && body.classList.contains('confirmation-loading')) {
            body.classList.remove('confirmation-loading');
            console.log('ðŸ”§ Removed loading state for form user to show Cal.com widget');
          }
        }
        
        // Clean up any expired or invalid confirmation state
        if (confirmationActive === 'true' || bookingConfirmed === 'true') {
          console.log('ðŸ§¹ Cleaning up expired/invalid confirmation state');
          
          // Clean up session storage
          sessionStorage.removeItem('confirmationPageActive');
          sessionStorage.removeItem('confirmationTimestamp'); 
          sessionStorage.removeItem('confirmationSource');
          
          // Only clean up localStorage if it's truly expired
          const bookingTime = bookingTimestamp ? new Date(bookingTimestamp) : null;
          const hoursSinceBooking = bookingTime ? (Date.now() - bookingTime.getTime()) / (1000 * 60 * 60) : null;
          
          if (hoursSinceBooking && hoursSinceBooking > 72) {
            localStorage.removeItem('bookingConfirmed');
            localStorage.removeItem('bookingTimestamp');
            localStorage.removeItem('latestBookingData');
            console.log('ðŸ§¹ Cleaned up expired localStorage booking data (>72h)');
          }
        }
        
        console.log('âœ… Ready for normal Cal.com initialization');
        
      }
      
      // Initialize custom loading screen integration
      initializeCustomLoadingIntegration();
      
      // Initialize simplified theme monitoring
      if (window.calComThemeMonitor) {
        window.calComThemeMonitor.monitorTheme();
        
        if (!isProduction) console.log('âœ… Using official Cal.com theming system with cssVarsPerTheme');
      }
      
      // Check if we have questionnaire data (try localStorage first, then sessionStorage)
      // Try localStorage first (survives page refresh), then sessionStorage
      let storedData = localStorage.getItem('questionnaireData');
      if (!storedData) {
        storedData = sessionStorage.getItem('questionnaireData');
        console.log('ðŸ“Š Using sessionStorage fallback (data may not persist on refresh)');
      } else {
        console.log('ðŸ“Š Using localStorage data (persistent across refreshes)');
      }
      if (storedData) {
        console.log('ðŸ“Š Questionnaire data available for Cal.com integration');
      } else {
        console.log('âš ï¸ No questionnaire data found - Cal.com will use defaults');
      }
      
      // Cal.com inline embed initializes automatically via script in HTML
      // No manual initialization needed
      
      // Initialize form functionality on page load (not just after booking)
      initializeSmartPhoneCta();
    // }); // END OF DISABLED OLD RESTORATION SYSTEM
    
    // REMOVED: Duplicate video function definition (moved earlier to fix ordering issue)
    // OLD COMPLEX FUNCTION REPLACED WITH EARLY SIMPLE VERSION
    /* DISABLED - Old complex video function replaced with simpler early version
    window.initializeCustomVideoPlayer = function(userData) {
      console.log('ðŸš« OLD VIDEO FUNCTION - DISABLED (early version used instead)');
      return; // Exit immediately - early version handles this now
      
      const videoPlayer = document.getElementById('professionalVideoPlayer');
      const mainVideo = document.getElementById('mainVideo');
      const playButton = document.getElementById('cleanPlayButton');
      const videoSource = document.getElementById('videoSource');
      const playOverlay = document.getElementById('videoPlayOverlay');
      
      // Debug element existence
      console.log('ðŸ” Element Check:');
      console.log('  videoPlayer:', videoPlayer ? 'âœ… Found' : 'âŒ Missing');
      console.log('  mainVideo:', mainVideo ? 'âœ… Found' : 'âŒ Missing');
      console.log('  playButton:', playButton ? 'âœ… Found' : 'âŒ Missing');
      console.log('  videoSource:', videoSource ? 'âœ… Found' : 'âŒ Missing');
      console.log('  playOverlay:', playOverlay ? 'âœ… Found' : 'âŒ Missing');
      
      if (!videoPlayer || !mainVideo || !playButton || !videoSource) {
        console.error('ðŸš« Missing video elements, aborting initialization');
        return;
      }
      
      // Debug button styling
      if (playButton) {
        const buttonStyles = window.getComputedStyle(playButton);
        console.log('ðŸŽ¯ Button Debugging:');
        console.log('  Background:', buttonStyles.background);
        console.log('  Background-color:', buttonStyles.backgroundColor);
        console.log('  Color:', buttonStyles.color);
        console.log('  Width:', buttonStyles.width);
        console.log('  Height:', buttonStyles.height);
        console.log('  Display:', buttonStyles.display);
        console.log('  Text-stroke:', buttonStyles.webkitTextStroke || 'none');
        console.log('  Text-shadow:', buttonStyles.textShadow);
      }
      
      // Challenge-based video and thumbnail mapping
      const videoMap = {
        'manual-tasks': 'videos/manual-tasks-blueprint.mp4',
        'slow-processes': 'videos/strategy-blueprint.mp4', 
        'scaling-issues': 'videos/scaling-blueprint.mp4',
        'missed-opportunities': 'videos/lead-saving-blueprint.mp4'
      };
      
      // FIXED: Use existing thumbnail images (user can replace with extracted frames)
      const thumbnailMap = {
        'manual-tasks': 'thumbnails/manual-tasks-blueprint-poster.jpg',
        'slow-processes': 'thumbnails/strategy-blueprint-poster.jpg', 
        'scaling-issues': 'thumbnails/scaling-blueprint-poster.jpg',
        'missed-opportunities': 'thumbnails/lead-saving-blueprint-poster.jpg'
      };
      
      const challengeType = userData.challenge || 'manual-tasks';
      const videoPath = videoMap[challengeType] || videoMap['manual-tasks'];
      const thumbnailPath = thumbnailMap[challengeType] || thumbnailMap['manual-tasks'];
      
      console.log('ðŸŽ¥ Video Configuration:');
      console.log('  Challenge type:', challengeType);
      console.log('  Video path:', videoPath);
      console.log('  Thumbnail path:', thumbnailPath);
      
      // FIXED: Implement dual poster system with cache busting
      const cacheBuster = Date.now();
      const videoUrlWithCacheBust = videoPath + '?v=' + cacheBuster;
      const thumbnailUrlWithCacheBust = thumbnailPath + '?v=' + cacheBuster;
      
      console.log('ðŸ”§ === PROFESSIONAL POSTER IMPLEMENTATION ===');
      console.log('  Video URL:', videoUrlWithCacheBust);
      console.log('  Thumbnail URL:', thumbnailUrlWithCacheBust);
      
      // Set video source
      videoSource.src = videoUrlWithCacheBust;
      
      // ENHANCED POSTER SYSTEM: Preload + Dual display for guaranteed visibility
      console.log('ðŸŽ¯ Applying enhanced poster system with preloading...');
      
      // Preload poster image to ensure it's cached
      const posterPreloader = new Image();
      posterPreloader.onload = () => {
        console.log('âœ… Poster image preloaded successfully');
        
        // Apply poster after successful preload
        mainVideo.poster = thumbnailUrlWithCacheBust;
        mainVideo.style.backgroundImage = `url("${thumbnailUrlWithCacheBust}")`;
        mainVideo.style.backgroundSize = 'cover';
        mainVideo.style.backgroundPosition = 'center';
        mainVideo.style.backgroundRepeat = 'no-repeat';
        
        // Remove loading state
        mainVideo.style.backgroundColor = 'transparent';
        console.log('âœ… Poster applied after preload');
      };
      
      posterPreloader.onerror = () => {
        console.warn('âš ï¸ Poster preload failed, applying video frame fallback');
        // Apply video frame as poster using time fragment
        mainVideo.poster = videoPath + '#t=0.5';
        mainVideo.style.backgroundColor = '#202020'; // Lighter fallback
        
        // Force video to load first frame for poster
        mainVideo.currentTime = 0.5;
        mainVideo.preload = 'metadata';
      };
      
      // CRITICAL: Set video source and poster immediately
      console.log('ðŸŽ¬ Setting video source:', videoPath);
      videoSource.src = videoPath;
      mainVideo.src = videoPath;
      
      // IMMEDIATE FALLBACK: Set video frame as poster immediately
      mainVideo.poster = videoPath + '#t=0.5';
      mainVideo.preload = 'metadata';
      
      // Show professional loading state while poster loads
      mainVideo.style.backgroundColor = '#202020';
      mainVideo.style.backgroundImage = 'linear-gradient(135deg, #202020 0%, #2a2a2a 100%)';
      
      // Force the video to load
      mainVideo.load();
      
      // Try to load custom thumbnail
      posterPreloader.src = thumbnailUrlWithCacheBust;
      
      console.log('âœ… Poster applied via video.poster:', mainVideo.poster);
      console.log('âœ… Background applied via CSS:', mainVideo.style.backgroundImage);
      
      // VALIDATION: Check if thumbnail is now visible
      setTimeout(() => {
        const videoRect = mainVideo.getBoundingClientRect();
        const computedStyles = window.getComputedStyle(mainVideo);
        
        console.log('ðŸ” === POSTER VISIBILITY VALIDATION ===');
        console.log('  Video dimensions:', videoRect.width + 'x' + videoRect.height);
        console.log('  Video poster attribute:', mainVideo.poster || 'none');
        console.log('  CSS background-image:', computedStyles.backgroundImage);
        console.log('  CSS background-size:', computedStyles.backgroundSize);
        console.log('  Video should now be visible WITHOUT hover requirement');
        
        if (mainVideo.poster && computedStyles.backgroundImage !== 'none') {
          console.log('ðŸŽ‰ === THUMBNAIL SYSTEM ACTIVE ===');
          console.log('  âœ… Dual poster system successfully applied');
          console.log('  âœ… Video should be permanently visible with blur overlay');
        } else {
          console.log('âš ï¸ Poster system may not be fully active');
        }
        
        // VALIDATION: Check overlay blur effect
        const overlay = document.getElementById('videoPlayOverlay');
        if (overlay) {
          const overlayStyles = window.getComputedStyle(overlay);
          console.log('ðŸ” === OVERLAY BLUR VALIDATION ===');
          console.log('  Overlay background:', overlayStyles.background);
          console.log('  Backdrop-filter:', overlayStyles.backdropFilter || 'not supported');
          console.log('  WebKit backdrop-filter:', overlayStyles.webkitBackdropFilter || 'not supported');
          console.log('  Z-index:', overlayStyles.zIndex);
          console.log('  Opacity:', overlayStyles.opacity);
          console.log('  Visibility:', overlayStyles.visibility);
          console.log('  Position:', overlayStyles.position);
          
          // Test backdrop-filter support
          const supportsBackdrop = CSS.supports('backdrop-filter', 'blur(1px)') || CSS.supports('-webkit-backdrop-filter', 'blur(1px)');
          console.log('  Browser supports backdrop-filter:', supportsBackdrop);
          
          if (supportsBackdrop) {
            console.log('âœ… BACKDROP-FILTER SUPPORTED - blur should work');
          } else {
            console.log('âš ï¸ Backdrop-filter not supported - fallback should activate');
          }
          
          console.log('ðŸŽ¯ Video should show permanent blurred overlay WITHOUT hover dependency');
        }
      }, 100);
      
      // CRITICAL FIX: Add ALL event listeners BEFORE load() to ensure they fire
      console.log('ðŸŽ¬ Setting up video event listeners BEFORE load()...');
      
      mainVideo.addEventListener('loadstart', function() {
        console.log('ðŸ”„ Video loading started');
        console.log('  Ready state:', mainVideo.readyState, '(0=HAVE_NOTHING, 1=HAVE_METADATA, 2=HAVE_CURRENT_DATA, 3=HAVE_FUTURE_DATA, 4=HAVE_ENOUGH_DATA)');
        console.log('  Current time:', mainVideo.currentTime);
        console.log('  Video visible area:', mainVideo.offsetWidth + 'x' + mainVideo.offsetHeight);
      });
      
      mainVideo.addEventListener('loadedmetadata', function() {
        console.log('ðŸŽ¬ Video metadata loaded - first frame should be visible');
        console.log('  Video dimensions:', mainVideo.videoWidth + 'x' + mainVideo.videoHeight);
        console.log('  Video duration:', mainVideo.duration);
        console.log('  Current time:', mainVideo.currentTime);
        
        // PHASE 3: Enhanced first frame forcing technique
        setTimeout(() => {
          if (mainVideo.readyState >= 1) { // HAVE_METADATA or better
            console.log('ðŸŽ¯ Forcing first frame display via seek technique');
            mainVideo.currentTime = 0.001; // Micro-seek to force frame render
          }
        }, 100); // Small delay to ensure metadata is fully processed
      });
      
      mainVideo.addEventListener('seeked', function() {
        console.log('ðŸŽ¬ Video seeked - frame should now be visible at time:', mainVideo.currentTime);
        // Frame should now be displayed properly
      });
      
      mainVideo.addEventListener('loadeddata', function() {
        console.log('ðŸ“Š Video data loaded - FIRST FRAME SHOULD BE VISIBLE NOW');
        console.log('  Video dimensions:', mainVideo.videoWidth + 'x' + mainVideo.videoHeight);
        console.log('  Video duration:', mainVideo.duration);
        console.log('  Current time before guaranteed seek:', mainVideo.currentTime);
        console.log('  Ready state:', mainVideo.readyState);
        
        // GUARANTEED SEEK: Now we definitely have frame data
        if (mainVideo.currentTime === 0) {
          console.log('ðŸŽ¯ GUARANTEED SEEK: Forcing currentTime to 0.1s in loadeddata event');
          mainVideo.currentTime = 0.1;
          console.log('ðŸ” Post-loadeddata seek - currentTime now:', mainVideo.currentTime);
        }
        
        // VALIDATION: First frame should now be displayed
        if (mainVideo.readyState >= 2) { // HAVE_CURRENT_DATA or better
          console.log('âœ… SUCCESS: Video first frame loaded and should be visible!');
          console.log('  Video poster should now be visible via dual system');
        } else {
          console.log('âš ï¸ WARNING: Video may not have enough data for first frame display');
        }
      });
      
      mainVideo.addEventListener('canplay', function() {
        console.log('âœ… Video can start playing');
        console.log('  Ready state:', mainVideo.readyState);
        console.log('  Current time:', mainVideo.currentTime);
        console.log('  Video paused:', mainVideo.paused);
        
        // FINAL BACKUP: Ensure we're not stuck at currentTime = 0
        if (mainVideo.currentTime === 0) {
          console.log('ðŸš¨ FINAL BACKUP SEEK: currentTime still 0, forcing seek to 0.1s');
          mainVideo.currentTime = 0.1;
          console.log('ðŸ” Final backup seek result - currentTime:', mainVideo.currentTime);
        } else {
          console.log('âœ… SEEK SUCCESS: currentTime is', mainVideo.currentTime, '(not stuck at 0)');
        }
        
        // Final comprehensive validation
        setTimeout(() => {
          console.log('ðŸŽ¯ === FINAL VIDEO STATUS CHECK ===');
          console.log('  Video element dimensions:', mainVideo.offsetWidth + 'x' + mainVideo.offsetHeight);
          console.log('  Video natural dimensions:', mainVideo.videoWidth + 'x' + mainVideo.videoHeight);
          console.log('  Ready state:', mainVideo.readyState);
          console.log('  Current time:', mainVideo.currentTime);
          console.log('  CRITICAL CHECK - currentTime > 0:', mainVideo.currentTime > 0 ? 'âœ… SUCCESS (frame should be visible)' : 'âŒ FAILED (still at black frame)');
          console.log('  Video element background:', window.getComputedStyle(mainVideo).background);
          
          // Final status for user
          if (mainVideo.currentTime > 0) {
            console.log('ðŸŽ‰ VIDEO PREVIEW SHOULD NOW BE VISIBLE WITHOUT HOVER!');
          } else {
            console.log('ðŸš¨ VIDEO PREVIEW STILL BROKEN - SEEK FAILED');
          }
        }, 500);
      });
      
      mainVideo.addEventListener('pause', function() {
        if (!mainVideo.ended) {
          playOverlay.classList.remove('hidden');
          // Update text to show play option
          const videoCaption = document.querySelector('.video-caption');
          if (videoCaption) {
            videoCaption.textContent = 'Click to resume video';
          }
          console.log('â¸ï¸ Video paused, showing overlay');
        }
      });
      
      mainVideo.addEventListener('play', function() {
        playOverlay.classList.add('hidden');
        // Update text for when user clicks during play (though hidden)
        const videoCaption = document.querySelector('.video-caption');
        if (videoCaption) {
          videoCaption.textContent = 'Click to pause video';
        }
        
        // VALIDATION: Check hidden state application
        setTimeout(() => {
          const overlayStyles = window.getComputedStyle(playOverlay);
          console.log('ðŸ” === HIDDEN STATE VALIDATION ===');
          console.log('  Overlay has hidden class:', playOverlay.classList.contains('hidden'));
          console.log('  Computed opacity:', overlayStyles.opacity);
          console.log('  Computed visibility:', overlayStyles.visibility);
          console.log('  Pointer events:', overlayStyles.pointerEvents);
          console.log('  âœ… Overlay should be completely invisible during playback');
        }, 50);
        
        console.log('â–¶ï¸ Video playing, hiding overlay');
      });
      
      mainVideo.addEventListener('ended', function() {
        playOverlay.classList.remove('hidden');
        mainVideo.controls = false;
        
        // Video ended - poster maintains consistent appearance
        
        // Reset text when video ends
        const videoCaption = document.querySelector('.video-caption');
        if (videoCaption) {
          videoCaption.textContent = 'Click to replay video';
        }
        console.log('â¹ï¸ Video ended, showing overlay');
      });
      
      mainVideo.addEventListener('error', function(e) {
        console.error('ðŸš« Video error occurred:', e);
        console.error('  Error details:', mainVideo.error);
        console.error('  Error code:', mainVideo.error ? mainVideo.error.code : 'Unknown');
        
        // PHASE 5: Enhanced error handling with fallback
        const errorCode = mainVideo.error ? mainVideo.error.code : 0;
        const errorMessages = {
          1: 'MEDIA_ERR_ABORTED - Video loading was aborted',
          2: 'MEDIA_ERR_NETWORK - Network error occurred',
          3: 'MEDIA_ERR_DECODE - Video decode error',
          4: 'MEDIA_ERR_SRC_NOT_SUPPORTED - Video format not supported'
        };
        
        console.error('  Error explanation:', errorMessages[errorCode] || 'Unknown error');
        
        // Show overlay and provide user feedback
        playOverlay.classList.remove('hidden');
        const videoCaption = document.querySelector('.video-caption');
        if (videoCaption) {
          videoCaption.textContent = 'Video temporarily unavailable - Click to retry';
        }
        
        // Fallback: Try reloading the video after a delay
        setTimeout(() => {
          console.log('ðŸ”„ Attempting video recovery...');
          mainVideo.load();
        }, 2000);
      });
      
      // Add timeout fallback if video doesn't load within reasonable time
      const videoLoadTimeout = setTimeout(() => {
        if (mainVideo.readyState < 1) { // Still no metadata after 10 seconds
          console.warn('âš ï¸ Video loading timeout - implementing fallback');
          console.log('  Current ready state:', mainVideo.readyState);
          console.log('  Showing play overlay as fallback');
          playOverlay.classList.remove('hidden');
          
          const videoCaption = document.querySelector('.video-caption');
          if (videoCaption) {
            videoCaption.textContent = 'Click to load personalized video';
          }
        }
      }, 10000); // 10 second timeout
      
      // Clear timeout if video loads successfully  
      mainVideo.addEventListener('loadedmetadata', function() {
        clearTimeout(videoLoadTimeout);
      }, { once: true });
      
      // PHASE 2: FORCE IMMEDIATE FIRST FRAME LOAD - Professional approach
      mainVideo.preload = 'metadata'; // Load metadata + first frame
      console.log('ðŸš€ Starting enhanced video load with forced first frame...');
      
      // CRITICAL: Force video to load and display first frame immediately
      mainVideo.load();
      
      // PROFESSIONAL TECHNIQUE: Seek to first frame to force browser to load it
      const forceFirstFrame = () => {
        if (mainVideo.readyState >= 2) { // HAVE_CURRENT_DATA or better - REQUIRED for seeking to work
          console.log('ðŸŽ¬ FORCING FIRST FRAME: Setting currentTime to 0.1s (readyState=' + mainVideo.readyState + ')');
          mainVideo.currentTime = 0.1; // Seek to first frame (skip black)
          console.log('âœ… First frame seek initiated - should be visible now');
          console.log('ðŸ” Seek validation - currentTime after seek:', mainVideo.currentTime);
        } else {
          console.log('â³ Waiting for CURRENT_DATA (readyState >= 2) before first frame seek, current:', mainVideo.readyState);
          setTimeout(forceFirstFrame, 50); // Retry in 50ms
        }
      };
      
      // Start forcing first frame load immediately
      setTimeout(forceFirstFrame, 100);
      console.log('ðŸ”„ Video loading with first frame force initiated');
      
      // Force video to fill container - JavaScript runtime fix
      function forceVideoFill() {
        const containerRect = videoPlayer.getBoundingClientRect();
        const videoRect = mainVideo.getBoundingClientRect();
        
        console.log('ðŸ”§ Forcing video to fill container:');
        console.log('  Container size:', containerRect.width + 'x' + containerRect.height);
        console.log('  Video size before fix:', videoRect.width + 'x' + videoRect.height);
        
        // Force exact dimensions via JavaScript
        mainVideo.style.setProperty('width', '100%', 'important');
        mainVideo.style.setProperty('height', '100%', 'important');
        mainVideo.style.setProperty('position', 'absolute', 'important');
        mainVideo.style.setProperty('top', '0', 'important');
        mainVideo.style.setProperty('left', '0', 'important');
        mainVideo.style.setProperty('right', '0', 'important');
        mainVideo.style.setProperty('bottom', '0', 'important');
        mainVideo.style.setProperty('object-fit', 'cover', 'important');
        
        // Force re-measurement
        setTimeout(() => {
          const newVideoRect = mainVideo.getBoundingClientRect();
          console.log('  Video size after fix:', newVideoRect.width + 'x' + newVideoRect.height);
          
          const fillsCorrectly = (Math.abs(newVideoRect.width - containerRect.width) < 1) && 
                                (Math.abs(newVideoRect.height - containerRect.height) < 1);
          console.log('  Video fills container:', fillsCorrectly ? 'âœ… YES' : 'âŒ STILL NO');
          
          if (!fillsCorrectly) {
            console.error('ðŸš¨ JavaScript video sizing failed - investigating parent containers');
            // Check for interference
            let parent = videoPlayer.parentElement;
            let level = 1;
            while (parent && level <= 3) {
              const parentStyles = window.getComputedStyle(parent);
              console.error(`  Parent Level ${level} (${parent.className}):`);
              console.error(`    Display: ${parentStyles.display}`);
              console.error(`    Position: ${parentStyles.position}`);
              console.error(`    Overflow: ${parentStyles.overflow}`);
              parent = parent.parentElement;
              level++;
            }
          }
        }, 50);
      }
      
      // Force video fill on load and resize
      forceVideoFill();
      setTimeout(forceVideoFill, 500); // Backup check
      window.addEventListener('resize', forceVideoFill);
      
      // ENHANCED: Comprehensive click debugging with multiple event detection methods
      console.log('ðŸ”§ === SETTING UP ENHANCED PLAY BUTTON HANDLERS ===');
      
      // Method 1: Direct click handler with comprehensive debugging
      playButton.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        console.log('ðŸŽ¬ === PLAY BUTTON CLICKED (Direct) ===');
        console.log('  Event details:', e);
        console.log('  Button element:', playButton);
        console.log('  Video ready state:', mainVideo.readyState);
        console.log('  Video src:', mainVideo.currentSrc || videoSource.src);
        
        playVideo();
      });
      
      // Method 2: Overlay click handler as backup
      if (playOverlay) {
        playOverlay.addEventListener('click', function(e) {
          console.log('ðŸŽ¬ === OVERLAY CLICKED (Backup) ===');
          e.preventDefault();
          e.stopPropagation();
          playVideo();
        });
      }
      
      // Method 3: Event delegation on video player container
      if (videoPlayer) {
        videoPlayer.addEventListener('click', function(e) {
          if (e.target === playButton || e.target.closest('.clean-play-button') || e.target.closest('.video-play-overlay')) {
            console.log('ðŸŽ¬ === VIDEO PLAYER DELEGATION CLICKED ===');
            e.preventDefault();
            e.stopPropagation();
            playVideo();
          }
        });
      }
      
      // Centralized play function with enhanced debugging
      function playVideo() {
        console.log('ðŸš€ === PLAY VIDEO FUNCTION CALLED ===');
        
        // Track that play function was successfully called
        window.lastPlayButtonClick = Date.now();
        
        // Debug trigger source
        if (window.manualVideoTrigger) {
          console.log('ðŸ”§ Triggered manually via global click handler');
          window.manualVideoTrigger = false;
        } else {
          console.log('âœ… Triggered via normal event handlers');
        }
        
        // Debug button state after click
        const clickStyles = window.getComputedStyle(playButton);
        console.log('ðŸŽ¯ Button State After Click:');
        console.log('  Background:', clickStyles.backgroundColor);
        console.log('  Color:', clickStyles.color);
        
        // Hide overlay and play video
        playOverlay.classList.add('hidden');
        mainVideo.controls = true;
        
        console.log('ðŸ“± Overlay hidden, controls enabled');
        
        const playPromise = mainVideo.play();
        if (playPromise !== undefined) {
          playPromise.then(() => {
            console.log('âœ… Video playing successfully');
          }).catch(error => {
            console.error('âš ï¸ Video play failed:', error);
            console.log('ðŸ“¹ Video error details:', mainVideo.error);
            // Show overlay again on failure
            playOverlay.classList.remove('hidden');
            mainVideo.controls = false;
          });
        }
      }
      
      // STEP 4: COMPREHENSIVE TESTING - Global click monitoring
      console.log('ðŸ§ª === ENABLING COMPREHENSIVE TESTING MODE ===');
      
      // ENHANCED: Global click monitor with comprehensive debugging
      document.addEventListener('click', function(e) {
        const rect = videoPlayer.getBoundingClientRect();
        const x = e.clientX;
        const y = e.clientY;
        
        // Check if click is within video player bounds
        if (x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom) {
          console.log('ðŸŽ¯ === CLICK DETECTED IN VIDEO AREA ===');
          console.log('  Click coordinates:', x, y);
          console.log('  Video player bounds:', rect);
          console.log('  Target element:', e.target);
          console.log('  Target tagName:', e.target.tagName);
          console.log('  Target class:', e.target.className);
          console.log('  Target ID:', e.target.id);
          console.log('  Event path:', e.composedPath ? e.composedPath() : 'not available');
          
          // Check if click reached play button elements
          const isPlayButton = e.target.id === 'cleanPlayButton' || e.target.closest('.clean-play-button');
          const isPlayOverlay = e.target.id === 'videoPlayOverlay' || e.target.closest('.video-play-overlay');
          
          console.log('  Is play button?', isPlayButton);
          console.log('  Is play overlay?', isPlayOverlay);
          console.log('  Should trigger video?', isPlayButton || isPlayOverlay);
          
          // Manual video trigger if expected elements were clicked but handlers didn't fire
          if ((isPlayButton || isPlayOverlay) && !window.lastPlayButtonClick) {
            console.log('âš ï¸ Manual video trigger - handlers may have failed');
            window.manualVideoTrigger = true;
            playVideo();
          }
          
          // Track last click time for debugging
          window.lastVideoAreaClick = Date.now();
        } else {
          // Click outside video area
          console.log('ðŸ‘† Click detected outside video area');
        }
      });
      
      // Track successful play button clicks
      window.lastPlayButtonClick = null;
      
      // Test all video elements visibility and positioning
      setTimeout(() => {
        console.log('ðŸ“ === FINAL VISIBILITY TEST ===');
        
        const elements = [
          { name: 'Video Player Container', element: videoPlayer },
          { name: 'Main Video', element: mainVideo },
          { name: 'Play Button', element: playButton },
          { name: 'Play Overlay', element: playOverlay }
        ];
        
        elements.forEach(({ name, element }) => {
          if (element) {
            const rect = element.getBoundingClientRect();
            const styles = window.getComputedStyle(element);
            
            console.log(`ðŸ” ${name}:`);
            console.log('  Visible:', rect.width > 0 && rect.height > 0 && styles.visibility !== 'hidden' && styles.display !== 'none');
            console.log('  Dimensions:', `${rect.width}x${rect.height}`);
            console.log('  Position:', `(${rect.left}, ${rect.top})`);
            console.log('  Z-index:', styles.zIndex);
            console.log('  Pointer events:', styles.pointerEvents);
            console.log('  Background:', styles.backgroundColor || styles.background);
          } else {
            console.log(`âŒ ${name}: NOT FOUND`);
          }
        });
      }, 1000);
      
      // STEP 4: FINAL VALIDATION - Comprehensive success indicators
      setTimeout(() => {
        console.log('ðŸ === COMPREHENSIVE VALIDATION SUMMARY ===');
        
        // Professional video player uses poster images for consistent preview
        
        // Check video container visibility
        const containerRect = videoPlayer.getBoundingClientRect();
        const containerVisible = containerRect.width > 0 && containerRect.height > 0;
        console.log('ðŸ“‹ CONTAINER VISIBILITY:');
        console.log('  âœ… Container visible:', containerVisible);
        console.log('  ðŸ“ Container size:', `${containerRect.width}x${containerRect.height}`);
        
        // Check play button functionality
        const playButtonVisible = playButton && playButton.getBoundingClientRect().width > 0;
        console.log('ðŸ“‹ PLAY BUTTON:');
        console.log('  âœ… Button visible:', playButtonVisible);
        console.log('  ðŸŽ¯ Button clickable:', playButtonVisible && playButton.style.pointerEvents !== 'none');
        
        // Check overlay visibility
        const overlayVisible = playOverlay && !playOverlay.classList.contains('hidden');
        console.log('ðŸ“‹ PLAY OVERLAY:');
        console.log('  âœ… Overlay visible:', overlayVisible);
        console.log('  ðŸŽ¯ Overlay interactive:', overlayVisible && playOverlay.style.pointerEvents !== 'none');
        
        // Overall validation
        const allSystemsGo = posterDisplayed && containerVisible && playButtonVisible && overlayVisible;
        console.log('ðŸ“‹ OVERALL STATUS:');
        console.log('  ðŸŽ¯ All systems operational:', allSystemsGo ? 'âœ… YES' : 'âŒ NO');
        
        if (allSystemsGo) {
          console.log('ðŸŽ‰ === VIDEO SYSTEM FULLY OPERATIONAL ===');
          console.log('  âœ… Poster image should be visible');
          console.log('  âœ… Play button should respond to clicks');
          console.log('  âœ… Video container has proper visibility');
        } else {
          console.log('âš ï¸ === ISSUES DETECTED ===');
          console.log('  Check individual components above for details');
        }
      }, 2000);
      
      // Enhanced container debugging with parent analysis
      setTimeout(() => {
        console.log('ðŸ“ === CONTAINER DIMENSION ANALYSIS ===');
        
        // Container analysis
        const containerStyles = window.getComputedStyle(videoPlayer);
        const containerRect = videoPlayer.getBoundingClientRect();
        console.log('ðŸŽ¬ Video Player Container:');
        console.log('  CSS width:', containerStyles.width);
        console.log('  CSS height:', containerStyles.height);
        console.log('  CSS padding-top:', containerStyles.paddingTop);
        console.log('  CSS max-width:', containerStyles.maxWidth);
        console.log('  Actual width:', containerRect.width + 'px');
        console.log('  Actual height:', containerRect.height + 'px');
        console.log('  Actual aspect ratio:', (containerRect.width / containerRect.height).toFixed(2));
        console.log('  Position:', containerStyles.position);
        console.log('  Display:', containerStyles.display);
        
        // Video element analysis
        const videoStyles = window.getComputedStyle(mainVideo);
        const videoRect = mainVideo.getBoundingClientRect();
        console.log('ðŸŽ¥ Video Element:');
        console.log('  CSS width:', videoStyles.width);
        console.log('  CSS height:', videoStyles.height);
        console.log('  Actual width:', videoRect.width + 'px');
        console.log('  Actual height:', videoRect.height + 'px');
        console.log('  Video object-fit:', videoStyles.objectFit);
        console.log('  Video position:', videoStyles.position);
        console.log('  Video z-index:', videoStyles.zIndex);
        
        // Parent container analysis
        const parentContainer = videoPlayer.parentElement;
        if (parentContainer) {
          const parentStyles = window.getComputedStyle(parentContainer);
          const parentRect = parentContainer.getBoundingClientRect();
          console.log('ðŸ“¦ Parent Container (' + parentContainer.className + '):');
          console.log('  Parent width:', parentRect.width + 'px');
          console.log('  Parent height:', parentRect.height + 'px');
          console.log('  Parent display:', parentStyles.display);
          console.log('  Parent flex-direction:', parentStyles.flexDirection);
          console.log('  Parent align-items:', parentStyles.alignItems);
          console.log('  Parent justify-content:', parentStyles.justifyContent);
        }
        
        // Button overlay analysis
        if (playOverlay) {
          const overlayStyles = window.getComputedStyle(playOverlay);
          const overlayRect = playOverlay.getBoundingClientRect();
          console.log('ðŸŽ¯ Play Overlay:');
          console.log('  Overlay width:', overlayRect.width + 'px');
          console.log('  Overlay height:', overlayRect.height + 'px');
          console.log('  Overlay position:', overlayStyles.position);
          console.log('  Overlay z-index:', overlayStyles.zIndex);
        }
        
        // Check for aspect ratio issues
        const expectedHeight = containerRect.width * (9/16);
        const heightDifference = Math.abs(containerRect.height - expectedHeight);
        console.log('ðŸŽ¯ Container Aspect Ratio Check:');
        console.log('  Expected height for 16:9:', expectedHeight.toFixed(2) + 'px');
        console.log('  Actual height:', containerRect.height + 'px');
        console.log('  Height difference:', heightDifference.toFixed(2) + 'px');
        
        // Enhanced debugging for parent container interference - reuse existing parentContainer
        if (parentContainer) {
          const parentRect = parentContainer.getBoundingClientRect();
          console.log('ðŸ” Enhanced Parent Container Analysis:');
          console.log('  Parent aspect-ratio:', getComputedStyle(parentContainer).aspectRatio);
          console.log('  Parent max-width:', getComputedStyle(parentContainer).maxWidth);
          console.log('  Expected parent height for 16:9:', (parentRect.width * (9/16)).toFixed(2) + 'px');
        }
        
        // Video content sizing analysis
        console.log('ðŸ“¹ Video Content Analysis:');
        console.log('  Video natural width:', mainVideo.videoWidth || 'Not loaded');
        console.log('  Video natural height:', mainVideo.videoHeight || 'Not loaded');
        if (mainVideo.videoWidth && mainVideo.videoHeight) {
          const videoAspectRatio = (mainVideo.videoWidth / mainVideo.videoHeight).toFixed(2);
          console.log('  Video natural aspect ratio:', videoAspectRatio);
          console.log('  Container aspect ratio:', (containerRect.width / containerRect.height).toFixed(2));
          
          // Check if video is filling container
          const videoFillsContainer = (Math.abs(videoRect.width - containerRect.width) < 2) && 
                                    (Math.abs(videoRect.height - containerRect.height) < 2);
          console.log('  Video fills container:', videoFillsContainer ? 'âœ… YES' : 'âŒ NO');
          
          if (!videoFillsContainer) {
            console.error('ðŸš¨ VIDEO SIZING ISSUE DETECTED!');
            console.error('  Video element is smaller than container');
            console.error('  Video size:', videoRect.width + 'x' + videoRect.height);
            console.error('  Container size:', containerRect.width + 'x' + containerRect.height);
            console.error('  This explains the "video within container" appearance');
          }
        }
        
        // Check for CSS conflicts
        console.log('ðŸ” CSS Conflict Check:');
        const computedObjectFit = videoStyles.objectFit;
        const computedPosition = videoStyles.position;
        const computedTop = videoStyles.top;
        const computedLeft = videoStyles.left;
        console.log('  object-fit applied:', computedObjectFit);
        console.log('  position applied:', computedPosition);
        console.log('  top applied:', computedTop);
        console.log('  left applied:', computedLeft);
        
        if (computedObjectFit !== 'cover') {
          console.error('âŒ object-fit: cover not applied properly');
        }
        if (computedPosition !== 'absolute') {
          console.error('âŒ position: absolute not applied properly');
        }
        
        if (heightDifference > 5) {
          console.error('âš ï¸ CONTAINER ASPECT RATIO ISSUE DETECTED!');
          console.error('  Container is not maintaining 16:9 ratio');
        } else {
          console.log('âœ… CONTAINER ASPECT RATIO PERFECT!');
          console.log('  Container maintains proper 16:9 dimensions (difference: ' + heightDifference.toFixed(1) + 'px)');
          console.log('  ðŸŽ‰ VIDEO SIZING FIX SUCCESSFUL!');
        }
      }, 100);
      
      console.log('ðŸŽ¬ === VIDEO PLAYER INITIALIZATION COMPLETE ===');
    }

    // Smart Phone CTA Functionality
    function initializeSmartPhoneCta() {
      // New emergency button
      const emergencyButton = document.getElementById('emergencyPhoneButton');
      
      // Original elements (kept for compatibility)
      const smartPhoneCta = document.getElementById('smartPhoneCta');
      const buttonState = document.getElementById('buttonState');
      const phoneState = document.getElementById('phoneState');
      const digitInputForm = document.getElementById('digitInputForm');
      const confirmBtn = document.getElementById('confirmBtn');
      const aiSuccessMessage = document.getElementById('aiSuccessMessage');
      
      // Digit input boxes
      const area1 = document.getElementById('area1');
      const area2 = document.getElementById('area2');
      const area3 = document.getElementById('area3');
      const digitBoxes = [area1, area2, area3];
      
      // Emergency button click handler - show phone form with debugging
      if (emergencyButton) {
        console.log('âœ… Emergency button found, adding click handler');
        emergencyButton.addEventListener('click', (e) => {
          e.preventDefault();
          console.log('ðŸ”¥ Emergency button clicked - starting transition');
          console.log('ðŸ“ Elements check:', {
            emergencyButton: !!emergencyButton,
            smartPhoneCta: !!smartPhoneCta,
            phoneState: !!phoneState
          });
          
          if (smartPhoneCta && phoneState) {
            console.log('ðŸŽ¯ Starting Apple-style clean transition');
            
            // Step 1: Hide button with Apple-style animation
            emergencyButton.classList.add('hidden');
            
            // Step 2: Show form with clean fade-in (slight delay for overlap)
            setTimeout(() => {
              console.log('ðŸ“± Showing form with clean animation');
              smartPhoneCta.classList.add('visible');
              phoneState.classList.add('active');
              phoneState.style.display = 'block';
              
              // Focus phone input instantly for professional responsiveness
              const phoneInput = document.getElementById('phoneInput');
              if (phoneInput) {
                phoneInput.focus();
                phoneInput.style.setProperty('cursor', 'text', 'important');
                console.log('âœ… Apple-style transition complete - phone input focused instantly');
              } else {
                console.log('âŒ Phone input not found');
              }
              
            }, 50); // Slight delay for smooth overlap
          } else {
            console.log('âŒ Required elements not found:', {
              smartPhoneCta: !!smartPhoneCta,
              phoneState: !!phoneState
            });
          }
        });
      } else {
        console.log('âŒ Emergency button not found in DOM');
      }
      
      // NOTE: Professional phone input logic moved to initPhoneComponent() 
      // for dynamic element support. Static validation removed to prevent conflicts.
      
      // Form submission handler - removed dead code
      
      if (!smartPhoneCta || !buttonState || !phoneState) {
        console.log('âš ï¸ Smart phone CTA elements not found');
        return;
      }
      
      // State management
      let isPhoneMode = false;
      
      // Professional phone number formatting with advanced masking
      function formatPhoneNumber(value) {
        // Remove all non-digits
        const phoneNumber = value.replace(/\D/g, '');
        
        // Don't format if empty
        if (!phoneNumber) return '';
        
        // Limit to 10 digits max (US phone number)
        const limitedNumber = phoneNumber.substring(0, 10);
        
        // Progressive formatting based on length
        if (limitedNumber.length <= 3) {
          return limitedNumber;
        } else if (limitedNumber.length <= 6) {
          return `(${limitedNumber.slice(0, 3)}) ${limitedNumber.slice(3)}`;
        } else {
          return `(${limitedNumber.slice(0, 3)}) ${limitedNumber.slice(3, 6)}-${limitedNumber.slice(6)}`;
        }
      }
      
      // Enhanced phone validation
      function validatePhoneNumber(phone) {
        const digitsOnly = phone.replace(/\D/g, '');
        return digitsOnly.length === 10;
      }
      
      // Professional input feedback
      function showInputFeedback(input, isValid) {
        const wrapper = input.closest('.phone-input-wrapper');
        if (!wrapper) return;
        
        if (isValid) {
          wrapper.classList.remove('error');
          wrapper.classList.add('valid');
        } else {
          wrapper.classList.remove('valid');
          wrapper.classList.add('error');
        }
      }
      
      // Clear input feedback
      function clearInputFeedback(input) {
        const wrapper = input.closest('.phone-input-wrapper');
        if (wrapper) {
          wrapper.classList.remove('error', 'valid');
        }
      }
      
      if (!smartPhoneCta || !buttonState || !phoneState) {
        console.log('âš ï¸ Smart phone CTA elements not found');
        return;
      }
      
      // Professional phone number formatting with advanced masking
      function formatPhoneNumber(value) {
        // Remove all non-digits
        const phoneNumber = value.replace(/\D/g, '');
        
        // Don't format if empty
        if (!phoneNumber) return '';
        
        // Limit to 10 digits max (US phone number)
        const limitedNumber = phoneNumber.substring(0, 10);
        
        // Progressive formatting based on length
        if (limitedNumber.length <= 3) {
          return limitedNumber;
        } else if (limitedNumber.length <= 6) {
          return `(${limitedNumber.slice(0, 3)}) ${limitedNumber.slice(3)}`;
        } else {
          return `(${limitedNumber.slice(0, 3)}) ${limitedNumber.slice(3, 6)}-${limitedNumber.slice(6)}`;
        }
      }
      
      // Enhanced phone validation
      function validatePhoneNumber(phone) {
        const digitsOnly = phone.replace(/\D/g, '');
        return digitsOnly.length === 10;
      }
      
      // Professional input feedback
      function showInputFeedback(input, isValid) {
        const wrapper = input.closest('.phone-input-wrapper');
        if (!wrapper) return;
        
        if (isValid) {
          wrapper.classList.remove('error');
          wrapper.classList.add('valid');
        } else {
          wrapper.classList.remove('valid');
          wrapper.classList.add('error');
        }
      }
      
      // Clear input feedback
      function clearInputFeedback(input) {
        const wrapper = input.closest('.phone-input-wrapper');
        if (wrapper) {
          wrapper.classList.remove('error', 'valid');
        }
      }
      
      // NEW: Smart Phone CTA functionality
      // Phone number validation
      function validatePhoneNumber() {
        const area1Value = area1.value.trim();
        const area2Value = area2.value.trim();
        const area3Value = area3.value.trim();
        
        const isArea1Valid = area1Value.length === 3 && /^\d{3}$/.test(area1Value);
        const isArea2Valid = area2Value.length === 3 && /^\d{3}$/.test(area2Value);
        const isArea3Valid = area3Value.length === 4 && /^\d{4}$/.test(area3Value);
        
        return isArea1Valid && isArea2Valid && isArea3Valid;
      }
      
      // Update confirm button state
      function updateConfirmButton() {
        const isValid = validatePhoneNumber();
        if (confirmBtn) confirmBtn.disabled = !isValid;
      }
      
      // Update digit box styling
      function updateDigitBoxStyle(box) {
        if (!box) return;
        const isCurrentlyFilled = box.value.length === parseInt(box.maxLength);
        const isValidLength = box.value.length <= parseInt(box.maxLength);
        
        // Clear previous states
        box.classList.remove('filled', 'error');
        
        if (isCurrentlyFilled && /^\d+$/.test(box.value)) {
          box.classList.add('filled');
        } else if (box.value.length > 0 && (!isValidLength || !/^\d+$/.test(box.value))) {
          box.classList.add('error');
        }
      }
      
      // Initialize digit box event listeners if they exist
      if (digitBoxes.length > 0 && digitBoxes[0]) {
        digitBoxes.forEach((box, index) => {
          if (!box) return;
          
          // Input event for auto-advance
          box.addEventListener('input', (e) => {
            const nextBox = digitBoxes[index + 1];
            updateDigitBoxStyle(box);
            updateConfirmButton();
            
            // Auto-advance when current box is filled
            if (box.value.length === parseInt(box.maxLength) && nextBox) {
              nextBox.focus();
            }
          });
          
          // Keydown for special key handling
          box.addEventListener('keydown', (e) => {
            const allowedKeys = ['Backspace', 'Delete', 'Tab', 'Escape', 'Enter', 'ArrowLeft', 'ArrowRight'];
            if (!allowedKeys.includes(e.key) && !/\d/.test(e.key)) {
              e.preventDefault();
            }
            
            if (e.key === 'Backspace' && box.value.length === 0 && index > 0) {
              const previousBox = digitBoxes[index - 1];
              if (previousBox) {
                previousBox.focus();
                previousBox.value = '';
                updateDigitBoxStyle(previousBox);
              }
            }
            
            if (e.key === 'Enter' && validatePhoneNumber() && confirmBtn) {
              e.preventDefault();
              confirmBtn.click();
            }
          });
        });
        
        // Button to phone mode transition
        if (buttonState && phoneState) {
          buttonState.addEventListener('click', () => {
            buttonState.classList.add('sliding-out');
            phoneState.classList.add('active');
            setTimeout(() => area1.focus(), 200);
          });
          
          // ESC key to return to button mode
          document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && phoneState.classList.contains('active')) {
              buttonState.classList.remove('sliding-out');
              phoneState.classList.remove('active');
              digitBoxes.forEach(box => {
                if (box) {
                  box.value = '';
                  box.classList.remove('filled', 'error');
                }
              });
              updateConfirmButton();
            }
          });
        }
        
        // Initialize confirm button state
        updateConfirmButton();
        
        // Form submission handling
        if (digitInputForm && confirmBtn) {
          digitInputForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validatePhoneNumber()) {
              // Highlight invalid boxes
              digitBoxes.forEach(box => {
                if (box && box.value.length !== parseInt(box.maxLength)) {
                  box.classList.add('error');
                }
              });
              return;
            }
            
            // Get phone number
            const phoneNumber = `(${area1.value}) ${area2.value}-${area3.value}`;
            console.log('ðŸ“ž Submitting phone number:', phoneNumber);
            
            // Show loading state
            confirmBtn.disabled = true;
            confirmBtn.textContent = 'Calling...';
            
            // Simulate loading
            setTimeout(() => {
              // Hide phone state and show success
              if (phoneState) {
                phoneState.style.opacity = '0';
                phoneState.style.transform = 'scale(0.95)';
              }
              
              setTimeout(() => {
                if (phoneState) phoneState.style.display = 'none';
                if (aiSuccessMessage) aiSuccessMessage.classList.add('active');
                
                // Reset form state
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Call Me';
                if (phoneState) {
                  phoneState.style.opacity = '1';
                  phoneState.style.transform = 'scale(1)';
                  phoneState.style.display = 'flex';
                }
                
                // Return to button state
                if (buttonState && phoneState) {
                  buttonState.classList.remove('sliding-out');
                  phoneState.classList.remove('active');
                  digitBoxes.forEach(box => {
                    if (box) {
                      box.value = '';
                      box.classList.remove('filled', 'error');
                    }
                  });
                  updateConfirmButton();
                }
              }, 300);
            }, 1200);
          });
        }
      }
    }

    // Enhanced confirmation detection - multiple detection methods
    function setupConfirmationDetection() {
      if (!isProduction) console.log('ðŸ” Setting up enhanced confirmation detection...');
      
      // Method 1: DOM text observer for "This meeting is scheduled"
      const textObserver = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.type === 'childList' || mutation.type === 'characterData') {
            const calContainer = document.getElementById('my-cal-inline-30min');
            if (calContainer) {
              const textContent = calContainer.textContent || '';
              if (textContent.includes('This meeting is scheduled') || 
                  textContent.includes('Meeting confirmed') ||
                  textContent.includes('successfully scheduled') ||
                  textContent.includes('confirmed')) {
                console.log('ðŸŽ¯ CONFIRMATION via text observer:', textContent);
                textObserver.disconnect();
                window.createConfirmationPage({detail: {source: 'text_observer', text: textContent}});
              }
            }
          }
        });
      });
      
      // Start observing
      const calContainer = document.getElementById('my-cal-inline-30min');
      if (calContainer) {
        textObserver.observe(calContainer, {
          childList: true,
          subtree: true,
          characterData: true
        });
      }
      
      // Stop text observer after 5 minutes
      setTimeout(() => {
        textObserver.disconnect();
        console.log('â° Text observer timeout');
      }, 300000);
    }
    
    // Note: setupConfirmationDetection now called from initializeCalendar for better timing
    
    // PHASE 1: Intersection Observer Implementation - Professional Lazy Loading
    let calendarInitialized = false;
    
    // Create Intersection Observer for lazy loading
    const calendarObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting && !calendarInitialized) {
          if (!isProduction) console.log('ðŸš€ Calendar section visible - Cal.com already initialized');
          
          calendarInitialized = true;
          observer.unobserve(entry.target); // Stop observing once initialized
          
          // Cal.com is already initialized in DOMContentLoaded - no need to call again
          console.log('âœ… Calendar lazy loading completed');
        }
      });
    }, {
      // Trigger when 10% of calendar section is visible
      threshold: 0.1,
      // Add some margin for smoother experience
      rootMargin: '50px'
    });
    */
    
    // REMOVED: Duplicate calendar lazy loading - already handled in main DOMContentLoaded listener
    // Start observing calendar container immediately since DOM is ready
    if (document.readyState === 'loading') {
      // REMOVED: Duplicate DOMContentLoaded listener - calendar lazy loading handled in main listener (line 4974)
    } else {
      const calendarContainer = document.querySelector('.calendar-container');
      if (calendarContainer) {
        calendarObserver.observe(calendarContainer);
        if (!isProduction) console.log('âœ… Calendar lazy loading observer activated');
      }
    }

    // PROFESSIONAL CSS CONFLICT CLEANUP - Phase 4
    function cleanupConflictingStyles() {
      console.log('ðŸ§¹ CSS CLEANUP: Starting comprehensive conflict resolution...');
      
      // DEBUG: Check what's currently overriding cursor before cleanup
      const phoneInput = document.getElementById('phoneInput');
      if (phoneInput) {
        const computedStyle = getComputedStyle(phoneInput);
        console.log('ðŸ” PRE-CLEANUP DEBUG: Phone input cursor state:');
        console.log('  - Computed cursor:', computedStyle.cursor);
        console.log('  - Inline cursor:', phoneInput.style.cursor);
        console.log('  - CSS Text:', phoneInput.style.cssText);
        
        // Check for conflicting stylesheets
        const allStyles = document.querySelectorAll('style, link[rel="stylesheet"]');
        console.log('ðŸ“‹ ACTIVE STYLESHEETS:', allStyles.length);
        allStyles.forEach((style, index) => {
          if (style.href) {
            console.log(`  ${index}: External - ${style.href}`);
          } else if (style.id) {
            console.log(`  ${index}: Internal - ID: ${style.id}`);
          } else {
            console.log(`  ${index}: Internal - Anonymous`);
          }
        });
      }
      
      // Remove any existing CSS injection that might be causing conflicts
      const existingStyles = document.querySelectorAll('style[id*="phone"], style[id*="cursor"]');
      existingStyles.forEach(style => style.remove());
      console.log('âœ… CSS CLEANUP: Removed existing phone/cursor style injections');
      
      // Inject comprehensive cursor fix CSS to override ALL conflicts
      const cursorFixCSS = document.createElement('style');
      cursorFixCSS.id = 'professional-cursor-fix';
      cursorFixCSS.textContent = `
        /* SIMPLE CURSOR FIX - Let browser handle defaults */
        input#phoneInput,
        input[type="tel"]#phoneInput {
          cursor: text !important;
        }
        
        /* HOVER AND FOCUS STATES - MAXIMUM SPECIFICITY */
        html body div#phoneComponentContainer div#phoneFormContainer input#phoneInput:hover,
        html body div#phoneComponentContainer div#phoneFormContainer input#phoneInput:focus,
        html body div#phoneComponentContainer div#phoneFormContainer input#phoneInput:active,
        div#phoneFormContainer input#phoneInput:hover,
        div#phoneFormContainer input#phoneInput:focus,
        input#phoneInput:hover,
        input#phoneInput:focus {
          cursor: text !important;
        }
        
        /* CONTAINER CURSOR INHERITANCE FIX */
        div#phoneFormContainer,
        div#phoneComponentContainer {
          cursor: default !important;
        }
        
        /* NUCLEAR OPTION - OVERRIDE ANY POSSIBLE INTERFERENCE */
        input[style*="cursor"][id="phoneInput"] {
          cursor: text !important;
        }
        
        #callButton,
        button#callButton {
          cursor: pointer !important;
          -webkit-user-select: none !important;
          -moz-user-select: none !important;
          user-select: none !important;
          pointer-events: auto !important;
        }
        
        /* PLACEHOLDER STYLING - Match border color */
        #phoneInput::placeholder {
          color: rgba(255, 255, 255, 0.15) !important;
        }
        
        #phoneInput::-webkit-input-placeholder {
          color: rgba(255, 255, 255, 0.15) !important;
        }
        
        #phoneInput::-moz-placeholder {
          color: rgba(255, 255, 255, 0.15) !important;
          opacity: 1 !important;
        }
        
        /* CALL BUTTON STATES - Subtle sophistication with high specificity */
        button#callButton[type="button"].disabled {
          cursor: not-allowed !important;
          background: rgba(255, 255, 255, 0.05) !important; /* Very subtle */
          color: rgba(255, 255, 255, 0.4) !important;
          opacity: 0.6 !important;
          border: 1px solid rgba(255, 255, 255, 0.1) !important;
          box-shadow: none !important;
        }
        
        button#callButton[type="button"].enabled {
          cursor: pointer !important;
          background: rgba(255, 255, 255, 0.1) !important; /* Subtle, not bright white */
          color: rgba(255, 255, 255, 0.9) !important; /* Light text, not dark */
          opacity: 1 !important;
          border: 1px solid rgba(255, 255, 255, 0.2) !important;
          box-shadow: none !important;
        }
        
        button#callButton[type="button"].enabled:hover {
          cursor: pointer !important;
          background: rgba(255, 255, 255, 0.15) !important; /* Slightly brighter */
          color: rgba(255, 255, 255, 1) !important; /* Pure white text */
          transform: translateY(-1px) !important;
          border: 1px solid rgba(255, 255, 255, 0.3) !important;
          box-shadow: none !important;
        }
        
        #callButton.disabled:hover {
          cursor: not-allowed !important;
          background: rgba(255, 255, 255, 0.15) !important;
          color: rgba(255, 255, 255, 0.5) !important;
          transform: none !important;
        }
        
        /* APPLE-LIKE PULSING ANIMATION */
        @keyframes pulse {
          0%, 100% { 
            opacity: 1;
            transform: scale(1);
          }
          50% { 
            opacity: 0.8;
            transform: scale(1.02);
          }
        }
        
        #callButton.calling {
          animation: pulse 2s infinite;
          background: rgba(34, 197, 94, 0.9) !important;
          color: white !important;
        }
        
        #phoneFormContainer,
        #phoneComponentContainer {
          cursor: auto !important;
          pointer-events: auto !important;
        }
        
        /* Prevent any container from blocking interactions */
        .cookie-consent-banner,
        .cookie-consent-modal {
          pointer-events: auto !important;
        }
        
        .cookie-consent-banner * {
          pointer-events: auto !important;
        }
        
        /* Restore General Sans font properly */
        #phoneInput,
        #callButton,
        #ctaButton,
        #statusMessage {
          font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif !important;
        }
        
        /* CSS Custom Properties for Professional Consistency */
        :root {
          --phone-component-padding-mobile: 1.75rem auto 0.25rem auto;
          --phone-component-padding-tablet: 2.25rem auto 0.5rem auto;
          --phone-component-padding-desktop: 2.75rem auto 0.75rem auto;
          --button-height-mobile: 44px;
          --button-height-tablet: 48px;
          --button-height-desktop: 52px;
          --touch-target-min: 44px;
          
          /* Fluid Typography with clamp() */
          --font-size-cta: clamp(0.875rem, 0.8rem + 0.5vw, 1rem);
          --font-size-input: clamp(0.875rem, 0.85rem + 0.3vw, 1rem);
          --font-size-call-button: clamp(0.75rem, 0.7rem + 0.3vw, 0.875rem);
          
          /* Accessibility & Colors */
          --focus-color: var(--white);
          --focus-shadow: 0 0 0 2px rgba(255, 255, 255, 0.25);
          --button-border-hover: #d1d5db;
          --button-bg-hover: #f8f9fa;
        }
        
        /* PROFESSIONAL MOBILE-FIRST CONTAINER DESIGN */
        #phoneComponentContainer {
          /* Mobile Base - Optimized for button content fit */
          width: calc(100% - 16px) !important; 
          max-width: 390px !important;
          margin: var(--phone-component-padding-mobile) !important; /* Override inline style */
          height: 80px !important; /* Fixed height to prevent layout shifts */
          position: relative !important;
          box-sizing: border-box !important;
        }
        
        /* OVERRIDE INLINE MARGIN STYLE */
        #phoneComponentContainer[style*="margin: 2rem auto"] {
          margin: var(--phone-component-padding-mobile) !important;
        }
        
        #buttonContainer,
        #phoneFormContainer {
          position: absolute !important;
          top: 0 !important;
          left: 0 !important;
          width: 100% !important;
          height: 100% !important;
          display: flex !important;
          flex-direction: column !important;
          box-sizing: border-box !important;
        }
        
        /* PROFESSIONAL CTA BUTTON - MOBILE FIRST WITH ACCESSIBILITY */
        #ctaButton {
          /* Mobile Base Design - Fixed sizing to prevent wrapping */
          width: 100% !important;
          height: var(--button-height-mobile) !important;
          font-size: 13px !important; /* Fixed small size for mobile to fit text */
          font-weight: 500 !important;
          gap: 0.5rem !important;
          padding: 0 0.75rem !important; /* Reduced padding for more text space */
          box-sizing: border-box !important;
          transition: all 0.2s ease !important;
          min-height: var(--touch-target-min) !important;
          white-space: nowrap !important; /* Prevent text wrapping */
          
          /* Enhanced Accessibility */
          line-height: 1.2 !important;
          text-rendering: optimizeLegibility !important;
          -webkit-font-smoothing: antialiased !important;
          -moz-osx-font-smoothing: grayscale !important;
        }
        
        #ctaButton svg {
          width: 14px !important; /* Fixed size for mobile */
          height: 14px !important;
          flex-shrink: 0 !important;
          transition: color 0.2s ease !important;
          background: transparent !important; /* Ensure no background on SVG */
          border: none !important;
          outline: none !important;
        }
        
        #ctaButton svg path {
          transition: stroke 0.2s ease !important;
          fill: none !important; /* Ensure no fill conflicts */
          background: transparent !important;
        }
        

        /* HOVER STATE - WHITE BACKGROUND WITH BLACK TEXT */
        div#buttonContainer button#ctaButton:hover,
        div#buttonContainer button#ctaButton:hover:active,
        button#ctaButton:hover,
        button#ctaButton:hover:active,
        #ctaButton:hover,
        #ctaButton:hover:active,
        button[style*="all: initial"]:hover,
        button[style*="all: initial"]:hover:active,
        button[style*="color: #333333"]:hover,
        button[style*="color: #333333"]:hover:active,
        #ctaButton[style*="all: initial"]:hover,
        #ctaButton[style*="all: initial"]:hover:active,
        #ctaButton[style*="color: #333333"]:hover,
        #ctaButton[style*="color: #333333"]:hover:active {
          /* VISUAL PROPERTIES - BLACK TEXT ON WHITE BACKGROUND */
          background: #f8f9fa !important;
          border-color: #d1d5db !important;
          color: #000000 !important; /* BLACK TEXT ON HOVER + ACTIVE */
          transform: translateY(-1px) !important;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
          /* REMOVE ANY GLOW EFFECTS */
          outline: none !important;
          -webkit-tap-highlight-color: transparent !important;
          -webkit-focus-ring-color: transparent !important;
        }
        
        /* SVG ICON DEFAULT STATE - ENSURE CORRECT BASE COLOR */
        div#buttonContainer button#ctaButton svg,
        button#ctaButton svg,
        #ctaButton svg,
        svg[style*="color: #333333"] {
          color: #333333 !important; /* DEFAULT GRAY ICON */
          fill: currentColor !important;
          stroke: currentColor !important;
        }

        /* SVG ICON HOVER STATE - BLACK ON HOVER */
        div#buttonContainer button#ctaButton:hover svg,
        div#buttonContainer button#ctaButton:hover:active svg,
        button#ctaButton:hover svg,
        button#ctaButton:hover:active svg,
        #ctaButton:hover svg,
        #ctaButton:hover:active svg,
        button[style*="all: initial"]:hover svg,
        button[style*="all: initial"]:hover:active svg,
        button[style*="all: initial"]:hover svg[style*="color: #333333"],
        button[style*="all: initial"]:hover:active svg[style*="color: #333333"],
        #ctaButton:hover svg[style*="color: #333333"],
        #ctaButton:hover:active svg[style*="color: #333333"],
        button[style*="color: #333333"]:hover svg[style*="color: #333333"],
        button[style*="color: #333333"]:hover:active svg[style*="color: #333333"] {
          color: #000000 !important; /* BLACK ICON ON HOVER + ACTIVE */
          fill: currentColor !important; /* Ensure fill follows color */
          stroke: currentColor !important; /* Ensure stroke follows color */
        }
        
        /* SVG PATH DEFAULT STATE */
        div#buttonContainer button#ctaButton svg path,
        button#ctaButton svg path,
        #ctaButton svg path {
          stroke: #333333 !important; /* DEFAULT GRAY STROKE */
          fill: none !important; /* Keep as stroke-only icon */
        }

        /* SVG PATH HOVER STATE */
        div#buttonContainer button#ctaButton:hover svg path,
        div#buttonContainer button#ctaButton:hover:active svg path,
        button#ctaButton:hover svg path,
        button#ctaButton:hover:active svg path,
        #ctaButton:hover svg path,
        #ctaButton:hover:active svg path,
        button[style*="all: initial"]:hover svg path,
        button[style*="all: initial"]:hover:active svg path {
          stroke: #000000 !important; /* BLACK STROKE ON HOVER + ACTIVE */
          color: #000000 !important; /* BLACK COLOR ON HOVER + ACTIVE */
          fill: none !important; /* Keep as stroke-only icon */
        }
        
        /* MAXIMUM SPECIFICITY - OVERRIDE JAVASCRIPT INLINE STYLES */
        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover,
        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover:active {
          color: #000000 !important; /* NUCLEAR BLACK TEXT */
          background: #f8f9fa !important; /* NUCLEAR WHITE BACKGROUND */
          border-color: #d1d5db !important; /* NUCLEAR BORDER */
        }

        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover svg,
        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover:active svg {
          color: #000000 !important; /* NUCLEAR BLACK SVG */
          stroke: #000000 !important; /* NUCLEAR BLACK STROKE */
        }

        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover svg path,
        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:hover:active svg path {
          stroke: #000000 !important; /* NUCLEAR BLACK PATH STROKE */
          color: #000000 !important; /* NUCLEAR BLACK PATH COLOR */
        }

        /* ULTIMATE OVERRIDE - TARGET ELEMENTS WITH SPECIFIC INLINE STYLES */
        button[style*="color: #333333"][id="ctaButton"]:hover,
        button[style*="color: #333333"][id="ctaButton"]:hover:active,
        button[style*="all: initial"][id="ctaButton"]:hover,
        button[style*="all: initial"][id="ctaButton"]:hover:active {
          color: #000000 !important; /* ULTIMATE BLACK TEXT OVERRIDE */
        }

        button[id="ctaButton"]:hover svg[style*="color: #333333"],
        button[id="ctaButton"]:hover:active svg[style*="color: #333333"] {
          color: #000000 !important; /* ULTIMATE BLACK SVG OVERRIDE */
          stroke: #000000 !important; /* ULTIMATE BLACK STROKE OVERRIDE */
        }

        #ctaButton:active {
          transform: translateY(0) !important;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
        }
        
        /* REMOVE ALL FOCUS/OUTLINE EFFECTS - CLEAN PROFESSIONAL LOOK */
        #ctaButton:focus,
        #ctaButton:focus-visible,
        #ctaButton:focus-within,
        #ctaButton:-webkit-any-link:focus,
        button#ctaButton:focus,
        button#ctaButton:focus-visible,
        button#ctaButton:focus-within,
        div#buttonContainer button#ctaButton:focus,
        div#buttonContainer button#ctaButton:focus-visible,
        div#buttonContainer button#ctaButton:focus-within,
        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:focus,
        html body div#phoneComponentContainer div#buttonContainer button#ctaButton:focus-visible {
          outline: none !important;
          outline-width: 0 !important;
          outline-color: transparent !important;
          outline-style: none !important;
          outline-offset: 0 !important;
          box-shadow: none !important;
          border: 1px solid #e5e5e5 !important; /* Keep original border */
          -webkit-focus-ring-color: transparent !important;
          -webkit-tap-highlight-color: transparent !important;
        }

        /* RESERVE SPACE FOR DYNAMIC STATUS MESSAGE */
        #statusMessage {
          min-height: 24px !important; /* Reserve consistent space even when empty */
          margin: 12px 0 0 0 !important; /* Consistent spacing */
          transition: opacity 0.2s ease !important; /* Smooth transitions */
        }
        
        /* When empty, make invisible but maintain space */
        #statusMessage:empty {
          opacity: 0 !important; /* Invisible but space reserved */
        }
        
        /* REMOVED CONFLICTING :active RULE - WAS RESETTING COLORS TO GRAY */
        /* This was preventing hover states from working properly */
        
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
          #ctaButton {
            transition: none !important;
          }
          
          #ctaButton:hover {
            transform: none !important;
          }
        }
        
        /* PROFESSIONAL CALL BUTTON - PROGRESSIVE ENHANCEMENT */
        /* Professional dynamic button with content-aware sizing */
        button#callButton[type="button"] {
          flex: 0 0 auto !important; /* Shrink to content */
          width: auto !important; /* Auto-size to content */
          min-width: 2.5rem !important; /* Minimum touch target (40px) */
          max-width: 6rem !important; /* Safety limit */
          padding: 0 0.75rem !important; /* Consistent 12px padding */
          box-sizing: border-box !important;
          position: relative !important;
          border-radius: 8px !important;
          border: 1px solid rgba(255, 255, 255, 0.1) !important;
          box-shadow: none !important;
          background: rgba(255, 255, 255, 0.05) !important; /* Very subtle default */
          color: rgba(255, 255, 255, 0.4) !important;
        }
        
        
        /* ULTRA-COMPACT MOBILE: iPhone 12 Pro 390px and similar - SCOPED TO MAIN CTA ONLY */
        @media screen and (max-width: 24.375rem) { /* 390px */
          /* Only target the main CTA button in the AI discovery section, not booking flow elements */
          .ai-discovery-container #ctaButton {
            font-size: 11px !important; /* Readable compact size */
            gap: 4px !important; /* Professional spacing */
            padding: 0 6px !important; /* Tight but readable padding */
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
          }
          
          .ai-discovery-container #ctaButton svg {
            width: 12px !important; /* Better icon size */
            height: 12px !important;
            flex-shrink: 0 !important;
          }
          
          /* Success message responsive sizing - match button */
          .success-message-responsive {
            font-size: 11px !important; /* Same as button */
          }
          
        }

        /* SMALL MOBILE: 391px-479px - SCOPED TO MAIN CTA ONLY */
        @media screen and (min-width: 24.4375rem) and (max-width: 29.9375rem) {
          /* Only target the main CTA button in the AI discovery section, not booking flow elements */
          .ai-discovery-container #ctaButton {
            font-size: 12px !important; /* More readable size */
            gap: 4px !important; /* Professional spacing - consistent */
            padding: 0 8px !important; /* Better padding */
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
          }
          
          .ai-discovery-container #ctaButton svg {
            width: 14px !important; /* Better icon size */
            height: 14px !important;
            flex-shrink: 0 !important;
          }
          
          /* Success message responsive sizing - match button */
          .success-message-responsive {
            font-size: 12px !important; /* Same as button */
          }
          
        }

        /* PROGRESSIVE ENHANCEMENT: Large Mobile (480px+) */
        @media screen and (min-width: 30rem) {
          #phoneComponentContainer,
          #phoneComponentContainer[style*="margin: 2rem auto"] {
            width: calc(100% - 16px) !important;
            margin: var(--phone-component-padding-tablet) !important;
          }
          
          #ctaButton {
            font-size: 15px !important; /* Fixed size for large mobile */
            gap: 0.625rem !important;
            padding: 0 1rem !important; /* Restore normal padding */
          }
          
          #ctaButton svg {
            width: 16px !important; /* Fixed size */
            height: 16px !important;
          }
        }

        /* CLEAN CALL BUTTON RESPONSIVE TEXT SYSTEM */
        
        /* Clean text styling - remove any artifacts */
        #callButton .call-button-text {
          font-size: 0.875rem !important; /* 14px - readable size */
          color: inherit !important;
          opacity: 1 !important;
          white-space: nowrap !important;
          background: transparent !important; /* Remove any background */
          border: none !important; /* Remove any borders */
          text-shadow: none !important; /* Remove text shadows */
          outline: none !important; /* Remove outlines */
          box-shadow: none !important; /* Remove box shadows */
          -webkit-text-stroke: 0 !important; /* Remove webkit text stroke */
          -moz-text-stroke: 0 !important; /* Remove moz text stroke */
        }
        
        /* MOBILE COMPACT: Shorter text on small screens */
        @media screen and (max-width: 24.375rem) { /* â‰¤390px */
          /* Mobile: tighter padding for "Call" text */
          button#callButton[type="button"] {
            flex: 0 0 auto !important; /* Auto-size to content */
            width: auto !important; /* Let content determine width */
            min-width: 2.25rem !important; /* Smaller minimum for mobile (36px) */
            max-width: 4rem !important; /* Smaller max for mobile space */
            padding: 0 0.5rem !important; /* Tighter 8px padding for mobile */
            white-space: nowrap !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            box-shadow: none !important;
          }
          
          /* Fix enabled state with high specificity */
          button#callButton[type="button"].enabled {
            background: rgba(255, 255, 255, 0.1) !important; /* Much more subtle */
            color: rgba(255, 255, 255, 0.9) !important; /* Light text, not dark */
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            box-shadow: none !important;
          }
          
          button#callButton[type="button"].enabled:hover {
            background: rgba(255, 255, 255, 0.15) !important; /* Slightly brighter on hover */
            color: rgba(255, 255, 255, 1) !important; /* Pure white text */
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            box-shadow: none !important;
            transform: translateY(-1px) !important;
          }
          
          /* Fix disabled state too */
          button#callButton[type="button"].disabled {
            background: rgba(255, 255, 255, 0.05) !important; /* Very subtle */
            color: rgba(255, 255, 255, 0.4) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            box-shadow: none !important;
          }
        }
        }
        
        /* TABLET DESIGN (768px+) */
        @media screen and (min-width: 48rem) {
          #phoneComponentContainer,
          #phoneComponentContainer[style*="margin: 2rem auto"] {
            max-width: 400px !important;
            margin: var(--phone-component-padding-tablet) !important;
          }
        }
          
          #ctaButton {
            height: var(--button-height-tablet) !important;
            font-size: 16px !important; /* Fixed size for tablet */
            gap: 0.75rem !important;
            padding: 0 1.25rem !important;
          }
          
          #ctaButton svg {
            width: 18px !important; /* Fixed size */
            height: 18px !important;
          }
          
          /* Tablet: comfortable padding for "Call Me" text */
          button#callButton[type="button"] {
            flex: 0 0 auto !important; /* Auto-size to content */
            width: auto !important; /* Let content determine width */
            min-width: 2.5rem !important; /* Standard minimum touch target */
            max-width: 5rem !important; /* Reasonable max for tablets */
            padding: 0 0.75rem !important; /* Comfortable 12px padding */
            white-space: nowrap !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            box-shadow: none !important;
          }
          
          /* Fix tablet enabled state */
          button#callButton[type="button"].enabled {
            background: rgba(255, 255, 255, 0.1) !important; /* Subtle background */
            color: rgba(255, 255, 255, 0.9) !important; /* Light text */
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            box-shadow: none !important;
          }
          
        }
        
        /* DESKTOP OPTIMIZATION (1024px+) */
        @media screen and (min-width: 64rem) {
          #phoneComponentContainer,
          #phoneComponentContainer[style*="margin: 2rem auto"] {
            margin: var(--phone-component-padding-desktop) !important;
          }
        }
          
          #ctaButton {
            height: var(--button-height-desktop) !important;
            font-size: 1rem !important;
            padding: 0 1.5rem !important;
          }
          
          #ctaButton:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 16px rgba(0,0,0,0.15) !important;
          }
        }
        
        /* PHONE FORM RESPONSIVE DESIGN */
        #phoneFormContainer > div {
          display: flex !important;
          align-items: stretch !important;
          width: 100% !important;
          gap: 8px !important; /* Consistent gap across all devices */
          box-sizing: border-box !important;
        }
        
        #phoneInput {
          flex: 1 !important;
          min-width: 0 !important; /* Allow shrinking */
          border-radius: 8px !important; /* Full rounded corners with gap */
          font-size: var(--font-size-input) !important;
          box-sizing: border-box !important;
          
          /* Enhanced Accessibility */
          line-height: 1.2 !important;
          text-rendering: optimizeLegibility !important;
          -webkit-font-smoothing: antialiased !important;
          -moz-osx-font-smoothing: grayscale !important;
        }
        
        /* Accessible focus states for input - Subtle styling */
        #phoneInput:focus,
        #phoneInput:focus-visible {
          outline: none !important;
          border-color: rgba(255, 255, 255, 0.3) !important;
          box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2) !important;
          background: rgba(255, 255, 255, 0.08) !important;
        }
        
        /* Call button accessibility improvements - Subtle focus */
        #callButton:focus,
        #callButton:focus-visible {
          outline: none !important;
          box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3) !important;
          border-color: rgba(255, 255, 255, 0.4) !important;
        }
        
        /* Responsive input sizing */
        @media screen and (min-width: 30rem) {
          #phoneFormContainer > div {
            gap: 8px !important; /* Maintain consistent gap */
          }
          
          #phoneInput {
            border-radius: 8px !important;
          }
          
          #callButton {
            border-radius: 8px !important;
          }
        }
        
        /* High contrast support */
        @media (prefers-contrast: high) {
          #ctaButton {
            border-width: 2px !important;
            font-weight: 600 !important;
          }
          
          #callButton {
            border-width: 2px !important;
          }
          
          #phoneInput {
            border-width: 2px !important;
          }
        }
        
        /* Reduced motion for all animations */
        @media (prefers-reduced-motion: reduce) {
          #phoneComponentContainer,
          #buttonContainer,
          #phoneFormContainer,
          #ctaButton,
          #callButton,
          #phoneInput {
            transition: none !important;
            animation: none !important;
          }
          
          #ctaButton:hover,
          #ctaButton:active {
            transform: none !important;
          }
        }
        
        /* Print styles */
        @media print {
          #phoneComponentContainer {
            background: white !important;
            color: black !important;
            box-shadow: none !important;
          }
          
          #ctaButton,
          #callButton {
            background: white !important;
            color: black !important;
            border: 2px solid black !important;
          }
        }
        
        /* Professional cursor management with proper boundaries */
        #phoneComponentContainer {
          overflow: visible !important; /* ðŸ§ˆ LUXURY FIX: Prevent animation cutoff */
          cursor: default !important;
        }
        
        /* ðŸ§ˆ ANTI-CUTOFF: Ensure animations have breathing room */
        #phoneComponentContainer.animating {
          overflow: visible !important;
          padding: 2px 0 !important;
          margin-top: calc(2.25rem - 2px) !important;
        }
        
        #phoneComponentContainer * {
          cursor: inherit !important;
        }
        
        #ctaButton {
          cursor: pointer !important;
        }
        
        input#phoneInput[type="tel"],
        #phoneFormContainer input#phoneInput,
        div#phoneFormContainer input#phoneInput[type="tel"] {
          cursor: text !important;
          user-select: text !important;
          -webkit-user-select: text !important;
          -moz-user-select: text !important;
        }
        
        input#phoneInput[type="tel"]:hover,
        input#phoneInput[type="tel"]:focus,
        #phoneFormContainer input#phoneInput:hover,
        #phoneFormContainer input#phoneInput:focus {
          cursor: text !important !important;
          /* Professional hover state */
          background: rgba(255, 255, 255, 0.08) !important;
        }
        
        
        /* Professional form container when visible */
        #phoneFormContainer[style*="opacity: 1"] {
          pointer-events: auto !important;
        }
        
        /* Ensure phone input has proper cursor */
        #phoneFormContainer[style*="opacity: 1"] #phoneInput {
          cursor: text !important;
          pointer-events: auto !important;
          z-index: 1000 !important;
        }
        
        /* ðŸš¨ CRITICAL FIX: Enable pointer events on parent container when form is active */
        #phoneComponentContainer:has(#phoneFormContainer[style*="opacity: 1"]) {
          pointer-events: auto !important;
        }
        
        /* Fallback for browsers without :has() support */
        #phoneComponentContainer.form-active {
          pointer-events: auto !important;
        }
        
        
        #callButton,
        #callButton:hover,
        #callButton:focus,
        #callButton:active,
        button#callButton,
        button[type="button"]#callButton {
          cursor: pointer !important;
        }
        
        /* OVERRIDE ALL POSSIBLE CONTAINER CURSOR CONFLICTS */
        div[id*="phone"] input[type="tel"] {
          cursor: text !important;
        }
        
        div[id*="phone"] button {
          cursor: pointer !important;
        }
      `;
      
      document.head.appendChild(cursorFixCSS);
      console.log('âœ… CSS CLEANUP: Injected professional cursor fix CSS');
      
      console.log('âœ… SIMPLE FIX: Removed appearance:none - browser handles cursor naturally');
      
      // DEBUG: Check cursor state after CSS injection
      if (phoneInput) {
        setTimeout(() => {
          const postCleanupStyle = getComputedStyle(phoneInput);
          console.log('ðŸ” POST-CLEANUP DEBUG: Phone input cursor state:');
          console.log('  - Computed cursor after cleanup:', postCleanupStyle.cursor);
          console.log('  - Inline cursor after cleanup:', phoneInput.style.cursor);
          
          // ðŸš« DISABLED OLD CURSOR MONITORING - REPLACED BY NEW UNIFIED SYSTEM
          console.log('ðŸš« OLD CURSOR WATCHER DISABLED - Using new unified system');
          
          // Initialize cursor watcher if needed
          if (typeof cursorWatcher === 'undefined') {
            var cursorWatcher = new MutationObserver(function(mutations) {
              console.log('ðŸ“± Phone input style changes detected');
            });
          }
          
          // Watch for style changes on phone input
          cursorWatcher.observe(phoneInput, {
            attributes: true,
            attributeFilter: ['style'],
            attributeOldValue: true
          });
          
          console.log('ðŸ‘€ CURSOR WATCHER: Monitoring phone input for style changes');
          
          // Also watch the parent containers
          const phoneContainer = document.getElementById('phoneComponentContainer');
          const phoneFormContainer = document.getElementById('phoneFormContainer');
          
          if (phoneContainer) {
            cursorWatcher.observe(phoneContainer, {
              attributes: true,
              attributeFilter: ['style', 'class'],
              attributeOldValue: true
            });
          }
          
          if (phoneFormContainer) {
            cursorWatcher.observe(phoneFormContainer, {
              attributes: true,
              attributeFilter: ['style', 'class'],
              attributeOldValue: true
            });
          }
          
        }, 100);
      }
      
      // Also check for cookie consent CSS conflicts
      const cookieCSS = document.querySelector('link[href*="cookie-consent"]');
      if (cookieCSS) {
        console.log('âš ï¸ CSS CLEANUP: Cookie consent CSS detected - may cause conflicts');
        
        // Add specific overrides for cookie consent conflicts
        const cookieOverrideCSS = document.createElement('style');
        cookieOverrideCSS.id = 'cookie-consent-override';
        cookieOverrideCSS.textContent = `
          /* Override cookie consent font conflicts */
          #phoneInput {
            font-family: Arial, Helvetica, sans-serif !important;
            cursor: text !important;
          }
          
          #callButton {
            font-family: Arial, Helvetica, sans-serif !important;
            cursor: pointer !important;
          }
        `;
        document.head.appendChild(cookieOverrideCSS);
        console.log('âœ… CSS CLEANUP: Applied cookie consent conflict overrides');
      }
    }

    // ðŸ”§ CRITICAL FIX: Phone input cursor and form activation (moved outside function scope)
    // This code was broken because it was inside initializeSmartPhoneCta() after an early return
    setTimeout(() => {
      console.log('ðŸš€ === PHONE INPUT CURSOR FIX INITIALIZATION ===');
      
      // Define elements for form activation
      const aiCtaButton = document.getElementById('ctaButton');
      const phoneFormContainer = document.getElementById('phoneFormContainer');
      const phoneInput = document.getElementById('phoneInput');
      
      console.log('ðŸ” GLOBAL SCOPE: Element selection results:', {
        aiCtaButton: !!aiCtaButton,
        phoneFormContainer: !!phoneFormContainer,
        phoneInput: !!phoneInput,
        buttonExists: !!document.getElementById('ctaButton'),
        formExists: !!document.getElementById('phoneFormContainer'),
        inputExists: !!document.getElementById('phoneInput')
      });
      
      // ðŸŽ¯ SUCCESS: Now this code will execute because it's outside the function scope!
      console.log('âœ… CRITICAL FIX APPLIED: Code moved outside function scope to prevent early return blocking');
      
    }, 1000); // Wait for page to fully load

    // SIMPLIFIED PHONE COMPONENT INITIALIZATION  
    // Event delegation handles all interactions, this just verifies elements exist
    function initPhoneComponent() {
      console.log('ðŸ“± Initializing Professional Phone Component System...');
      
      const elements = {
        ctaButton: document.getElementById('ctaButton'),
        buttonContainer: document.getElementById('buttonContainer'),
        phoneFormContainer: document.getElementById('phoneFormContainer'),
        phoneInput: document.getElementById('phoneInput'),
        callButton: document.getElementById('callButton'),
        statusMessage: document.getElementById('statusMessage')
      };
      
      console.log('ðŸ” Elements found:', Object.entries(elements).reduce((acc, [key, val]) => {
        acc[key] = !!val;
        return acc;
      }, {}));
      
      // Clean up any conflicting styles first
      cleanupConflictingStyles();
      
      // CRITICAL: Add comprehensive professional UX logic for dynamic elements
      const { phoneInput, callButton, statusMessage } = elements;
      
      if (phoneInput) {
        console.log('âœ… Setting up professional phone input functionality...');
        
        // Initialize call button in disabled state
        if (callButton) {
          callButton.classList.remove('enabled');
          callButton.classList.add('disabled');
          callButton.style.setProperty('cursor', 'not-allowed', 'important');
          console.log('âœ… Call button initialized in disabled state');
        }
        
        // PHASE 1: Real-time phone number formatting as user types
        phoneInput.addEventListener('input', (e) => {
          let value = e.target.value.replace(/\D/g, ''); // Remove non-digits
          let formattedValue = '';
          
          if (value.length > 0) {
            if (value.length <= 3) {
              formattedValue = `(${value}`;
            } else if (value.length <= 6) {
              formattedValue = `(${value.slice(0, 3)}) ${value.slice(3)}`;
            } else {
              formattedValue = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6, 10)}`;
            }
          }
          
          e.target.value = formattedValue;
          
          // PHASE 2: Update call button state based on phone validation
          if (callButton) {
            const isValid = value.length >= 10; // At least 10 digits
            
            if (isValid && !callButton.classList.contains('enabled')) {
              callButton.classList.remove('disabled');
              callButton.classList.add('enabled');
              callButton.style.setProperty('cursor', 'pointer', 'important');
              console.log('âœ… Call button enabled - phone number valid');
            } else if (!isValid && !callButton.classList.contains('disabled')) {
              callButton.classList.remove('enabled');
              callButton.classList.add('disabled');
              callButton.style.setProperty('cursor', 'not-allowed', 'important');
            }
          }
          
          // PHASE 3: Update status message
          if (statusMessage) {
            if (value.length === 0) {
              statusMessage.textContent = '';
            } else if (value.length < 10) {
              statusMessage.textContent = 'Please enter a complete phone number';
              statusMessage.style.color = 'rgba(255, 255, 255, 0.6)';
              statusMessage.style.fontSize = '12px';
            } else {
              statusMessage.textContent = 'âœ“ Phone number ready';
              statusMessage.style.color = '#22c55e';
              statusMessage.style.fontSize = '12px';
            }
          }
        });
        
        // PHASE 1B: Block non-numeric input and handle backspace properly
        phoneInput.addEventListener('keydown', (e) => {
          // Allow: backspace, delete, tab, escape, enter, navigation keys
          if ([8, 9, 27, 13, 46, 37, 38, 39, 40].indexOf(e.keyCode) !== -1 ||
              // Allow Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
              (e.keyCode === 65 && e.ctrlKey === true) || // Ctrl+A
              (e.keyCode === 67 && e.ctrlKey === true) || // Ctrl+C
              (e.keyCode === 86 && e.ctrlKey === true) || // Ctrl+V
              (e.keyCode === 88 && e.ctrlKey === true)) { // Ctrl+X
            // Let it happen, don't do anything
          } else {
            // Ensure that it is a number and stop the keypress
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
              e.preventDefault();
              console.log('ðŸš« Blocked non-numeric input:', e.key);
              return;
            }
          }
          
          if (e.key === 'Backspace') {
            let value = e.target.value;
            let cursorPos = e.target.selectionStart;
            
            // If cursor is after a formatting character, move it back
            if (value[cursorPos - 1] === ')' || value[cursorPos - 1] === ' ' || value[cursorPos - 1] === '-') {
              setTimeout(() => {
                e.target.setSelectionRange(cursorPos - 1, cursorPos - 1);
              }, 0);
            }
          }
        });
        
        console.log('âœ… Phone input validation and formatting initialized');
      }
      
      // PHASE 4: Cursor now handled by CSS - no JavaScript needed
      
      // PHASE 5: Add CTA button handler and other direct event listeners
      setTimeout(() => {
        addDirectEventListeners();
        console.log('âœ… CTA button handler and direct listeners added');
      }, 200);
      
      console.log('âœ… Professional Phone Component System fully initialized');
      return true;
    }


    // NOTE: togglePrepItem function now defined early in the script (line ~5330) for better loading
    
    // Initialize accordion event listeners after confirmation page loads
    window.initializeAccordionListeners = function() {
      const prepQuestions = document.querySelectorAll('.prep-question');
      prepQuestions.forEach(question => {
        // Remove any existing listeners first
        question.removeEventListener('click', question._accordionHandler);
        
        // Add new listener
        const handler = function(e) {
          e.preventDefault();
          window.togglePrepItem(this);
        };
        
        question.addEventListener('click', handler);
        question._accordionHandler = handler; // Store reference for removal
      });
      
      console.log('ðŸŽ¯ Accordion listeners initialized for', prepQuestions.length, 'items');
    }

    // TEST: Verify script is loading
    console.log('ðŸ”¥ SCRIPT IS LOADING - This should appear immediately!');
    
    // SMART INITIALIZATION: Wait for dynamic confirmation content
    function waitForDynamicContent() {
      console.log('â³ Waiting for dynamic confirmation content to be created...');
      
      // Check if confirmation page elements exist (means dynamic content was created)
      const checkForContent = () => {
        const enhancedConfirmation = document.querySelector('.enhanced-confirmation');
        const phoneContainer = document.getElementById('phoneComponentContainer');
        
        if (enhancedConfirmation && phoneContainer) {
          console.log('âœ… Dynamic confirmation content found, initializing phone component...');
          initPhoneComponent();
          return true;
        }
        return false;
      };
      
      // Try immediately first
      if (checkForContent()) return;
      
      // If not found, wait and check periodically
      let attempts = 0;
      const maxAttempts = 50; // 5 seconds total
      const checkInterval = setInterval(() => {
        attempts++;
        console.log(`ðŸ” Attempt ${attempts}/${maxAttempts}: Looking for dynamic content...`);
        
        if (checkForContent() || attempts >= maxAttempts) {
          clearInterval(checkInterval);
          if (attempts >= maxAttempts) {
            console.log('âš ï¸ Timeout waiting for dynamic content, trying fallback initialization...');
            initPhoneComponent(); // Try anyway as fallback
          }
        }
      }, 100); // Check every 100ms
    }
    
    // SMART: Early detection only for legitimate return visits (not new booking flows)
    (function checkSmartEarlyState() {
      const confirmationActive = sessionStorage.getItem('confirmationPageActive');
      const bookingConfirmed = localStorage.getItem('bookingConfirmed');
      const referrerUrl = new URL(document.referrer || window.location.href);
      const isSchedulingAnother = referrerUrl.searchParams.get('schedule_another') === 'true';
      const referrer = document.referrer;
      const isFromForm = referrer && (referrer.includes('contact') || referrer.includes('index'));
      const isReload = !referrer || referrer === window.location.href;
      
      // Enhanced debug logging for early detection
      console.log('âš¡ === SMART EARLY DETECTION DEBUG ===');
      console.log('ðŸ” confirmationActive:', confirmationActive);
      console.log('ðŸ” bookingConfirmed:', bookingConfirmed);
      console.log('ðŸ” isSchedulingAnother:', isSchedulingAnother);
      console.log('ðŸ” referrer:', referrer || 'empty/none');
      console.log('ðŸ” isFromForm:', isFromForm);
      console.log('ðŸ” isReload:', isReload);
      console.log('ðŸ” NEW Condition (!isSchedulingAnother && (confirmationActive === "true" || bookingConfirmed === "true")):', !isSchedulingAnother && (confirmationActive === 'true' || bookingConfirmed === 'true'));
      
      // PROFESSIONAL FIX: Check for recent booking completion
      const bookingTimestamp = localStorage.getItem('bookingTimestamp');
      const now = Date.now();
      const oneHour = 60 * 60 * 1000; // 1 hour in milliseconds
      
      // Parse timestamp (handle both number strings and ISO strings)
      let timestamp = 0;
      if (bookingTimestamp) {
        const parsed = parseInt(bookingTimestamp);
        if (isNaN(parsed)) {
          // Fallback to ISO string parsing
          timestamp = new Date(bookingTimestamp).getTime();
        } else {
          timestamp = parsed;
        }
      }
      
      const hasRecentBooking = bookingTimestamp && (now - timestamp) < oneHour;
      
      console.log('ðŸ” bookingTimestamp raw:', bookingTimestamp);
      console.log('ðŸ” timestamp parsed:', timestamp);
      console.log('ðŸ” now:', now);
      console.log('ðŸ” age (minutes):', Math.round((now - timestamp) / (1000 * 60)));
      console.log('ðŸ” hasRecentBooking:', hasRecentBooking);
      console.log('ðŸ” FINAL Condition (!isSchedulingAnother && (confirmationActive === "true" || bookingConfirmed === "true" || hasRecentBooking)):', !isSchedulingAnother && (confirmationActive === 'true' || bookingConfirmed === 'true' || hasRecentBooking));
      
      // FIXED: Allow restoration if booking is confirmed OR recent, even from form navigation
      // Only block if explicitly scheduling another session
      if (!isSchedulingAnother && (confirmationActive === 'true' || bookingConfirmed === 'true' || hasRecentBooking)) {
        console.log('âš¡ SMART EARLY DETECTION: Legitimate return visit detected');
        console.log('ðŸ” This should be a reload or return visit, preparing for restoration');
        
        // Only add loading state for legitimate return visits
        if (document.body) {
          document.body.classList.add('confirmation-loading');
        } else {
          // REMOVED: Duplicate DOMContentLoaded listener - body class handling should be in main listener
        }
        
        window.earlyConfirmationDetected = true;
      } else {
        console.log('âš¡ SMART EARLY DETECTION: New booking flow detected, no early preparation needed');
        window.earlyConfirmationDetected = false;
      }
    })();
    
    // REMOVED: Duplicate DOMContentLoaded for waitForDynamicContent - should be handled in main listener
    // Initialize when DOM is ready, then wait for dynamic content
    if (document.readyState === 'loading') {
      console.log('ðŸ“„ DOM still loading - waitForDynamicContent should be in main DOMContentLoaded');
    } else {
      console.log('ðŸ“„ DOM already loaded, waiting for dynamic content');
      waitForDynamicContent();
    }
    
    // PROFESSIONAL WEBHOOK SYSTEM - Single Point of Truth
    let globalWebhookState = {
      isProcessing: false,
      lastRequestId: null,
      lastRequestTime: 0
    };
    
    /**
     * CENTRAL WEBHOOK FUNCTION - Professional single point of truth
     * Handles all n8n webhook sends with global deduplication and error handling
     */
    function sendWebhookToN8N(phoneValue, formattedPhone, requestSource = 'ai_discovery_call') {
      const now = Date.now();
      const requestId = `${now}-${Math.random().toString(36).substr(2, 9)}`;
      
      // GLOBAL DEDUPLICATION: 2-second protection window
      if (globalWebhookState.isProcessing || (now - globalWebhookState.lastRequestTime) < 2000) {
        console.log(`ðŸš« WEBHOOK BLOCKED: Duplicate request prevented (last: ${globalWebhookState.lastRequestId})`);
        return Promise.resolve({ success: false, reason: 'duplicate_blocked' });
      }
      
      globalWebhookState.isProcessing = true;
      globalWebhookState.lastRequestId = requestId;
      globalWebhookState.lastRequestTime = now;
      
      console.log(`ðŸ“¡ CENTRAL WEBHOOK: Sending request ${requestId} from ${requestSource}`);
      
      // Get stored data from questionnaire
      const getStoredData = () => {
        try {
          const calMetadata = JSON.parse(localStorage.getItem('cal_metadata') || '{}');
          const formData = JSON.parse(localStorage.getItem('form_data') || '{}');
          let questionnaireData = localStorage.getItem('questionnaireData');
          if (!questionnaireData) {
            questionnaireData = sessionStorage.getItem('questionnaireData');
          }
          const sessionData = JSON.parse(questionnaireData || '{}');
          
          return {
            email: calMetadata.email || formData.email || sessionData.email || '',
            name: calMetadata.name || formData.name || sessionData.name || '',
            company: calMetadata.company || formData.company || sessionData.company || '',
            role: calMetadata.role || formData.role || sessionData.role || '',
            teamSize: calMetadata.teamSize || formData.teamSize || sessionData.teamSize || '',
            challenge: calMetadata.challenge || formData.challenge || sessionData.challenge || '',
            bookingId: calMetadata.bookingId || ''
          };
        } catch (e) {
          console.warn('Could not retrieve stored questionnaire data:', e);
          return {};
        }
      };
      
      const storedData = getStoredData();
      const webhookData = {
        phone: phoneValue.replace(/\D/g, ''),
        formatted_phone: formattedPhone,
        source: requestSource,
        timestamp: new Date().toISOString(),
        request_id: requestId,
        matching_data: {
          email: storedData.email,
          name: storedData.name,
          company: storedData.company,
          role: storedData.role,
          teamSize: storedData.teamSize,
          challenge: storedData.challenge
        },
        call_request: {
          type: "ai_discovery_callback",
          requested_at: new Date().toISOString(),
          page_source: "ai_discovery_call_section",
          user_agent: navigator.userAgent,
          referrer: document.referrer || 'direct'
        }
      };
      
      const webhookUrl = 'https://n8n.umbryth.com/webhook/d1c24b37-79c4-4a4a-8fae-34008bf985a0';
      const params = new URLSearchParams({
        phone: webhookData.phone,
        formatted_phone: webhookData.formatted_phone,
        source: webhookData.source,
        timestamp: webhookData.timestamp,
        request_id: webhookData.request_id,
        email: webhookData.matching_data.email || '',
        name: webhookData.matching_data.name || '',
        company: webhookData.matching_data.company || '',
        role: webhookData.matching_data.role || '',
        teamSize: webhookData.matching_data.teamSize || '',
        challenge: webhookData.matching_data.challenge || '',
        call_type: webhookData.call_request.type,
        bookingId: storedData.bookingId || ''
      });
      
      const getWebhookUrl = `${webhookUrl}?${params.toString()}`;
      console.log('ðŸš€ CENTRAL WEBHOOK: Sending request with URL length:', getWebhookUrl.length);
      
      return fetch(getWebhookUrl, { method: 'GET' })
        .then(response => {
          console.log(`ðŸ“¡ WEBHOOK ${requestId}: Response status ${response.status}`);
          if (response.ok) {
            console.log(`âœ… WEBHOOK ${requestId}: Successfully sent to n8n`);
            return response.text().then(text => ({ success: true, response: text, requestId }));
          } else {
            console.warn(`âš ï¸ WEBHOOK ${requestId}: Non-200 response:`, response.status);
            return response.text().then(text => ({ success: false, error: `HTTP ${response.status}`, response: text, requestId }));
          }
        })
        .catch(error => {
          console.error(`âŒ WEBHOOK ${requestId}: Network error:`, error.message);
          return { success: false, error: error.message, requestId };
        })
        .finally(() => {
          // Reset processing state after 2 seconds
          setTimeout(() => {
            globalWebhookState.isProcessing = false;
            console.log(`ðŸ”„ WEBHOOK: Ready for next request (${requestId} completed)`);
          }, 2000);
        });
    }

    // PROFESSIONAL UI STATE FUNCTIONS - Error handling and user feedback
    function showSuccessCallState(phoneFormContainer) {
      const statusMessage = document.getElementById('statusMessage');
      
      console.log('ðŸŽ¯ SUCCESS: showSuccessCallState function called');
      console.log('ðŸ“Š SUCCESS: phoneFormContainer:', phoneFormContainer);
      
      // Check if calling state already exists to prevent duplicates
      const existingCallingContainer = document.getElementById('callingStateContainer');
      if (existingCallingContainer) {
        console.log('âš ï¸ SUCCESS: Calling state already active, ignoring duplicate');
        return;
      }
      
      console.log('âœ… SUCCESS: No existing calling container, proceeding...');
      
      if (phoneFormContainer) {
        console.log('ðŸ§ˆ SUCCESS: Starting buttery smooth crossfade...');
        
        // ðŸ§ˆ LUXURY CROSSFADE: Create success container FIRST for seamless transition
        const callingContainer = document.createElement('div');
        callingContainer.id = 'callingStateContainer';
        console.log('ðŸ“¦ SUCCESS: Container element created with ID:', callingContainer.id);
        callingContainer.style.cssText = `
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 48px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(34, 197, 94, 0.15);
          border: 1px solid rgba(34, 197, 94, 0.3);
          border-radius: 8px;
          opacity: 0;
          transition: opacity 0.4s cubic-bezier(0.23, 1, 0.32, 1);
          z-index: 10;
          box-sizing: border-box;
        `;
        
        callingContainer.innerHTML = `
          <div style="
            font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #22c55e;
            text-align: center;
            width: 100%;
            line-height: 1.2;
          ">
            ðŸŸ¢ Great! Calling you in 60 seconds
          </div>
        `;
        
        console.log('ðŸ”— SUCCESS: Inserting container into DOM...');
        phoneFormContainer.parentNode.insertBefore(callingContainer, phoneFormContainer);
        console.log('âœ… SUCCESS: Container inserted into DOM');
        
        // ðŸ§ˆ SEAMLESS CROSSFADE: Start both animations simultaneously for buttery smoothness  
        console.log('ðŸ“± SUCCESS: Starting pure opacity crossfade animation...');
        phoneFormContainer.style.transition = 'opacity 0.4s cubic-bezier(0.23, 1, 0.32, 1)';
        phoneFormContainer.style.opacity = '0';
        phoneFormContainer.style.pointerEvents = 'none';
        
        // ðŸ§ˆ LUXURY TIMING: Success appears as form fades (overlapping crossfade)
        setTimeout(() => {
          console.log('ðŸŽ­ SUCCESS: Making success container visible...');
          callingContainer.style.opacity = '1';
          console.log('ðŸ‘ï¸ SUCCESS: Pure buttery smooth crossfade active!');
        }, 50); // Overlap timing for seamless crossfade
        
        // Clean up form after crossfade completes
        setTimeout(() => {
          phoneFormContainer.style.display = 'none';
          // ðŸ§ˆ CLEANUP: Remove animating class after transition complete
          const phoneContainer = document.getElementById('phoneComponentContainer');
          if (phoneContainer) {
            phoneContainer.classList.remove('animating');
          }
          console.log('ðŸŽ‰ SUCCESS: Crossfade complete, form cleaned up!');
        }, 400);
      } else if (statusMessage) {
        statusMessage.textContent = 'ðŸŸ¢ Great! Calling you in 60 seconds';
        statusMessage.style.color = '#22c55e';
        statusMessage.style.fontSize = '16px';
        statusMessage.style.fontWeight = '600';
      }
    }
    
    function showRetryCallState(phoneFormContainer, phoneValue, formattedPhone) {
      const statusMessage = document.getElementById('statusMessage');
      
      console.log('âš ï¸ RETRY: Showing retry state for failed webhook');
      
      // Check if retry state already exists
      const existingRetryContainer = document.getElementById('retryStateContainer');
      if (existingRetryContainer) {
        console.log('âš ï¸ Retry state already active, ignoring duplicate');
        return;
      }
      
      if (phoneFormContainer) {
        phoneFormContainer.style.transition = 'opacity 0.25s ease-in-out, transform 0.25s ease-in-out';
        phoneFormContainer.style.opacity = '0';
        phoneFormContainer.style.transform = 'translateY(5px)';
        phoneFormContainer.style.pointerEvents = 'none';
        
        setTimeout(() => {
          phoneFormContainer.style.display = 'none';
          
          const retryContainer = document.createElement('div');
          retryContainer.id = 'retryStateContainer';
          retryContainer.style.cssText = `
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            min-height: 48px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            opacity: 0;
            transform: translateY(5px);
            transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out;
            z-index: 10;
            box-sizing: border-box;
            padding: 12px;
            gap: 8px;
          `;
          
          retryContainer.innerHTML = `
            <div style="
              font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
              font-size: 13px;
              font-weight: 500;
              color: #ef4444;
              text-align: center;
              line-height: 1.3;
            ">
              Network error - couldn't reach our system
            </div>
            <button id="retryCallButton" style="
              background: #ef4444;
              color: white;
              border: none;
              padding: 6px 16px;
              border-radius: 6px;
              font-size: 12px;
              font-weight: 600;
              cursor: pointer;
              transition: background 0.2s ease;
              font-family: 'General Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            " onmouseover="this.style.background='#dc2626'" onmouseout="this.style.background='#ef4444'">
              Try Again
            </button>
          `;
          
          phoneFormContainer.parentNode.insertBefore(retryContainer, phoneFormContainer);
          
          // Add retry functionality
          const retryButton = retryContainer.querySelector('#retryCallButton');
          retryButton.addEventListener('click', () => {
            console.log('ðŸ”„ RETRY: User clicked try again');
            retryContainer.remove();
            phoneFormContainer.style.display = 'block';
            phoneFormContainer.style.opacity = '1';
            phoneFormContainer.style.transform = 'translateY(0)';
            phoneFormContainer.style.pointerEvents = 'auto';
            
            // Retry the webhook call
            sendWebhookToN8N(phoneValue, formattedPhone, 'retry_call_button')
              .then(result => {
                if (result.success || result.reason === 'duplicate_blocked') {
                  showSuccessCallState(phoneFormContainer);
                } else {
                  showRetryCallState(phoneFormContainer, phoneValue, formattedPhone);
                }
              })
              .catch(error => {
                console.error('âŒ RETRY: Second attempt failed:', error);
                showRetryCallState(phoneFormContainer, phoneValue, formattedPhone);
              });
          });
          
          setTimeout(() => {
            retryContainer.style.opacity = '1';
            retryContainer.style.transform = 'translateY(0)';
          }, 100);
          
          console.log('âœ… RETRY: Retry state displayed with try again button');
        }, 250);
      } else if (statusMessage) {
        statusMessage.textContent = 'Network error - please try again';
        statusMessage.style.color = '#ef4444';
        statusMessage.style.fontSize = '14px';
        statusMessage.style.fontWeight = '500';
      }
    }

    // PHASE 2: CLEAN CALL BUTTON HANDLER - Single event system
    function addDirectEventListeners() {
      console.log('ðŸŽ¯ Adding direct event listeners (focusing on CTA button)...');
      
      const callButton = document.getElementById('callButton');
      const phoneInput = document.getElementById('phoneInput');
      const statusMessage = document.getElementById('statusMessage');
      
      // Always set up call button handler (validation happens inside handler)
      if (callButton) {
        console.log('ðŸ”² Setting up clean single event handler for Call button...');
        
        // Remove any existing listeners first
        callButton.onclick = null;
        
        // PROFESSIONAL CALL HANDLER - Clean and simple
        let isProcessing = false;
        const handleCallRequest = function(eventType) {
          // Prevent duplicate calls within 1000ms
          if (isProcessing) {
            console.log(`ðŸš« BLOCKED DUPLICATE (${eventType}): Already processing, ignoring`);
            return;
          }
          
          isProcessing = true;
          console.log(`ðŸš¨ CLEAN HANDLER (${eventType}): Call Me button activated!`);
          
          // Reset the processing flag after 1 second
          setTimeout(() => {
            isProcessing = false;
            console.log('ðŸ”„ Ready for next call request');
          }, 1000);
          
          // Visual feedback - flash border
          callButton.style.border = '2px solid #22c55e';
          setTimeout(() => {
            callButton.style.border = '';
          }, 200);
          
          if (phoneInput) {
            const phoneValue = phoneInput.value.replace(/\D/g, '');
            console.log('ðŸ“± CLEAN: Phone value:', phoneValue, 'Length:', phoneValue.length);
            
            if (phoneValue.length !== 10) {
              if (statusMessage) {
                statusMessage.textContent = 'Please enter a valid 10-digit phone number';
                statusMessage.style.color = '#ef4444';
              }
              console.log('âŒ CLEAN: Invalid phone number length:', phoneValue.length);
              return;
            }
            
            // PROFESSIONAL: Use central webhook function
            console.log('ðŸŽ CLEAN HANDLER: Using central webhook system');
            
            // PROFESSIONAL: Enhanced error handling with user feedback
            console.log('ðŸš€ CLEAN: Starting webhook call...', { phoneValue, requestSource: 'direct_call_button' });
            
            sendWebhookToN8N(phoneValue, phoneInput.value, 'direct_call_button')
              .then(result => {
                console.log('ðŸ“¡ CLEAN: Webhook response received:', result);
                
                if (result.success) {
                  console.log(`âœ… CLEAN: Webhook sent successfully (${result.requestId})`);
                  console.log('ðŸŽ¯ CLEAN: Calling showSuccessCallState...');
                  showSuccessCallState(phoneFormContainer);
                } else if (result.reason === 'duplicate_blocked') {
                  console.log('ðŸš« CLEAN: Duplicate request blocked - showing success anyway');
                  showSuccessCallState(phoneFormContainer);
                } else {
                  console.warn('âš ï¸ CLEAN: Webhook failed - showing success for UX:', result.error);
                  // Show success state anyway for better UX - user doesn't need to know about backend issues
                  showSuccessCallState(phoneFormContainer);
                }
              })
              .catch(error => {
                console.error('âŒ CLEAN: Webhook error - showing success for UX:', error);
                // Show success state anyway - user experience is more important than backend status
                showSuccessCallState(phoneFormContainer);
              });
          } else {
            console.log('âŒ DIRECT: Phone input not found during call request');
          }
        };
        
        // PRIMARY METHOD: Standard click (handles most cases)
        callButton.addEventListener('click', function(e) {
          console.log('ðŸ–±ï¸ PRIMARY: Click detected');
          e.preventDefault();
          e.stopPropagation();
          handleCallRequest('CLICK');
        });
        
        // MOBILE FALLBACK: Touch events (only if click doesn't work)
        let touchHandled = false;
        callButton.addEventListener('touchend', function(e) {
          if (!touchHandled) {
            console.log('ðŸ“± MOBILE FALLBACK: Touch end detected');
            touchHandled = true;
            e.preventDefault();
            e.stopPropagation();
            // Delay to allow click event to fire first, prevent if it does
            setTimeout(() => {
              if (!isProcessing) {
                handleCallRequest('TOUCH');
              }
              touchHandled = false;
            }, 10);
          }
        });
        
        // Add hover effects with debugging
        callButton.addEventListener('mouseenter', function() {
          console.log('ðŸ‘† DIRECT: Mouse enter Call button');
          this.style.background = '#1e40af';
          this.style.transform = 'scale(1.02)';
        });
        
        callButton.addEventListener('mouseleave', function() {
          console.log('ðŸ‘‹ DIRECT: Mouse leave Call button');
          if (this.textContent === 'Call Me') {
            this.style.background = '#0f0f0f'; // Use site's primary black
            this.style.transform = 'scale(1)';
          }
        });
        
        console.log('âœ… Optimized event handlers added to Call button (click + mobile fallback)');
        console.log('ðŸš« Duplicate event protection: 1-second cooldown prevents multiple calls');
      } else {
        console.log('âŒ Call button not found for direct listeners');
      }
      
      if (phoneInput) {
        // REMOVED: Complex cursor management - using CSS-only approach
        console.log('âœ… Phone input ready - cursor handled by CSS');
      }
      
      // PROFESSIONAL: CTA Button Handler - "Get AI Strategy Call in 60 Seconds"
      const ctaButton = document.getElementById('ctaButton');
      if (ctaButton) {
        console.log('ðŸ”² Setting up CTA button handler for Get AI Strategy Call...');
        
        ctaButton.addEventListener('click', function(e) {
          console.log('ðŸŽ¯ CTA: Get AI Strategy Call button clicked!');
          e.preventDefault();
          e.stopPropagation();
          
          // Find transition containers
          const buttonContainer = document.getElementById('buttonContainer');
          const phoneFormContainer = document.getElementById('phoneFormContainer');
          const phoneInput = document.getElementById('phoneInput');
          
          if (buttonContainer && phoneFormContainer) {
            console.log('ðŸ”„ CTA: Starting button â†’ phone form transition');
            
            // ðŸ§ˆ BUTTERY SMOOTH LUXURY TRANSITION: Premium 400ms timing
            buttonContainer.style.transition = 'opacity 0.4s cubic-bezier(0.23, 1, 0.32, 1), transform 0.4s cubic-bezier(0.23, 1, 0.32, 1)';
            buttonContainer.style.transformOrigin = 'center';
            buttonContainer.style.opacity = '0';
            buttonContainer.style.transform = 'scale(0.98)'; // Even more subtle for luxury feel
            buttonContainer.style.pointerEvents = 'none';
            buttonContainer.style.zIndex = '1';
            
            // LUXURY FORM ACTIVATION: Buttery smooth coordination
            phoneFormContainer.style.display = 'block';
            phoneFormContainer.style.transition = 'opacity 0.4s cubic-bezier(0.23, 1, 0.32, 1), transform 0.4s cubic-bezier(0.23, 1, 0.32, 1)';
            phoneFormContainer.style.transformOrigin = 'center';
            
            // CRITICAL FIX: Enable parent container pointer events IMMEDIATELY
            const phoneContainer = document.getElementById('phoneComponentContainer');
            if (phoneContainer) {
              phoneContainer.style.setProperty('pointer-events', 'auto', 'important');
              phoneContainer.classList.add('form-active');
              phoneContainer.classList.add('animating'); // ðŸ§ˆ ANTI-CUTOFF: Prevent animation clipping
              console.log('ðŸ”“ FIXED: Parent container pointer events enabled immediately');
            }
            
            // Start form animation with slight delay for perfect timing  
            setTimeout(() => {
              phoneFormContainer.style.setProperty('opacity', '1', 'important');
              phoneFormContainer.style.setProperty('transform', 'translateY(0)', 'important');
              phoneFormContainer.style.setProperty('pointer-events', 'auto', 'important');
              phoneFormContainer.style.setProperty('z-index', '110', 'important');
              console.log('ðŸ”“ FIXED: Form container pointer events enabled');
            }, 50); // Minimal delay for smooth overlap
            
            // Hide button completely after transition
            setTimeout(() => {
              buttonContainer.style.display = 'none';
              
              // ðŸ§ˆ CLEANUP: Remove animating class after buttonâ†’form transition complete
              const phoneContainer = document.getElementById('phoneComponentContainer');
              if (phoneContainer) {
                phoneContainer.classList.remove('animating');
              }
              
              // REMOVED: Duplicate pointer events code (now handled immediately above)
              phoneFormContainer.style.setProperty('cursor', 'default', 'important');
              
              // Focus phone input after form animation completes
              setTimeout(() => {
                const phoneInput = document.getElementById('phoneInput');
                if (phoneInput) {
                  phoneInput.focus();
                  console.log('âœ… Apple-style transition complete - phone input focused');
                } else {
                  console.log('âŒ Phone input not found');
                }
              }, 150); // Apple-fast focus for premium UX
              
              console.log('âœ… CTA: Apple-style transition complete - phone form active');
            }, 250); // Match 250ms Apple transition duration
            
          } else {
            console.log('âŒ CTA: Missing transition containers');
          }
        });
        
        // Add hover effects for better UX
        ctaButton.addEventListener('mouseenter', function() {
          console.log('ðŸ‘† CTA: Mouse enter');
        });
        
        ctaButton.addEventListener('mouseleave', function() {
          console.log('ðŸ‘‹ CTA: Mouse leave');
        });
        
        console.log('âœ… CTA button handler added successfully');
      } else {
        console.log('âŒ CTA button not found for direct listener');
      }
      
      console.log('ðŸŽ¯ Clean direct event listeners setup complete (including CTA)');
    }

    // REMOVED: Event delegation system - replaced with clean direct handlers
    console.log('ðŸ›¡ï¸ Event delegation removed - using clean direct handlers only');
    
    // Original simple event handling system (removed complex event delegation)
    
    // REMOVED: Phone formatting and enter key handling moved to direct handlers
    
    // Complex debugging code removed - restored original functionality
    
    // ===============================================
    // DUPLICATE FUNCTION REMOVED - Using Professional Version
    // ===============================================
    // The professional createConfirmationPage function is defined earlier
    // at line 5972 as window.createConfirmationPage = function(e)
    
    // On page load, restore confirmation if it exists
    document.addEventListener('DOMContentLoaded', function() {
      const confirmationViewed = localStorage.getItem('confirmationViewed');
      const bookingConfirmed = localStorage.getItem('bookingConfirmed');
      
      // If user has completed booking and reloads page, show confirmation
      // FIXED: Use the professional version instead of simple version
      if (confirmationViewed === 'true' && bookingConfirmed === 'true') {
        const savedData = JSON.parse(localStorage.getItem('latestBookingData') || '{}');
        console.log('ðŸ”„ Restoring confirmation page from localStorage using PROFESSIONAL version');
        window.createConfirmationPage({detail: {data: savedData, source: 'localStorage_reload'}});
      }
    });
    
    console.log('âœ… Professional confirmation system ready');
    
    
  </script>
  
  <!-- Cookie Consent Script -->
  <script src="js/cookie-consent.js" type="text/javascript"></script>
</body>
</html>
